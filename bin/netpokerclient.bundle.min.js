!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.NetPokerClient=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(b,c,d){(function(b){!function(e){function f(a){throw RangeError(I[a])}function g(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function h(a,b){var c=a.split("@"),d="";c.length>1&&(d=c[0]+"@",a=c[1]),a=a.replace(H,".");var e=a.split("."),f=g(e,b).join(".");return d+f}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:x}function l(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;q>e;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=t>=i?y:i>=t+z?z:i-t,!(n>l);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;q>h;++h)p=a[h],128>p&&u.push(L(p));for(d=e=u.length,e&&u.push(E);q>d;){for(j=w,h=0;q>h;++h)p=a[h],p>=b&&j>p&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;q>h;++h)if(p=a[h],b>p&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=g>=n?y:n>=g+z?z:n-g,!(o>k);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d&&!d.nodeType&&d,s="object"==typeof c&&c&&!c.nodeType&&c,t="object"==typeof b&&b;(t.global===t||t.window===t||t.self===t)&&(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^\x20-\x7E]/,H=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.3.2",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof a&&"object"==typeof a.amd&&a.amd)a("punycode",function(){return u});else if(r&&s)if(c.exports==r)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=function(a,b,c,f){b=b||"&",c=c||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(c);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),d(g,n)?e(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],4:[function(a,b,c){"use strict";function d(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}var e=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,c,h){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?d(g(a),function(g){var h=encodeURIComponent(e(g))+c;return f(a[g])?d(a[g],function(a){return h+encodeURIComponent(e(a))}).join(b):h+encodeURIComponent(e(a[g]))}).join(b):h?encodeURIComponent(e(h))+c+encodeURIComponent(e(a)):""};var f=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},g=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],5:[function(a,b,c){"use strict";c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":3,"./encode":4}],6:[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","	"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||h>k)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||h>k)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;B>j;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;F>E;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;B>j;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:2,querystring:5}],7:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],8:[function(b,c,d){(function(){var b=this,e=e||{};e.WEBGL_RENDERER=0,e.CANVAS_RENDERER=1,e.VERSION="v1.6.1",e.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},e.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},e._UID=0,"undefined"!=typeof Float32Array?(e.Float32Array=Float32Array,e.Uint16Array=Uint16Array):(e.Float32Array=Array,e.Uint16Array=Array),e.INTERACTION_FREQUENCY=30,e.AUTO_PREVENT_DEFAULT=!0,e.RAD_TO_DEG=180/Math.PI,e.DEG_TO_RAD=Math.PI/180,e.dontSayHello=!1,e.sayHello=function(a){if(!e.dontSayHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var b=["%c %c %c Pixi.js "+e.VERSION+" - "+a+"  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,b)}else window.console&&console.log("Pixi.js "+e.VERSION+" - http://www.pixijs.com/");e.dontSayHello=!0}},e.Point=function(a,b){this.x=a||0,this.y=b||0},e.Point.prototype.clone=function(){return new e.Point(this.x,this.y)},e.Point.prototype.set=function(a,b){this.x=a||0,this.y=b||(0!==b?this.x:0)},e.Point.prototype.constructor=e.Point,e.Rectangle=function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},e.Rectangle.prototype.clone=function(){return new e.Rectangle(this.x,this.y,this.width,this.height)},e.Rectangle.prototype.contains=function(a,b){if(this.width<=0||this.height<=0)return!1;var c=this.x;if(a>=c&&a<=c+this.width){var d=this.y;if(b>=d&&b<=d+this.height)return!0}return!1},e.Rectangle.prototype.constructor=e.Rectangle,e.EmptyRectangle=new e.Rectangle(0,0,0,0),e.Polygon=function(a){if(a instanceof Array||(a=Array.prototype.slice.call(arguments)),"number"==typeof a[0]){for(var b=[],c=0,d=a.length;d>c;c+=2)b.push(new e.Point(a[c],a[c+1]));a=b}this.points=a},e.Polygon.prototype.clone=function(){for(var a=[],b=0;b<this.points.length;b++)a.push(this.points[b].clone());return new e.Polygon(a)},e.Polygon.prototype.contains=function(a,b){for(var c=!1,d=0,e=this.points.length-1;d<this.points.length;e=d++){var f=this.points[d].x,g=this.points[d].y,h=this.points[e].x,i=this.points[e].y,j=g>b!=i>b&&(h-f)*(b-g)/(i-g)+f>a;j&&(c=!c)}return c},e.Polygon.prototype.constructor=e.Polygon,e.Circle=function(a,b,c){this.x=a||0,this.y=b||0,this.radius=c||0},e.Circle.prototype.clone=function(){return new e.Circle(this.x,this.y,this.radius)},e.Circle.prototype.contains=function(a,b){if(this.radius<=0)return!1;var c=this.x-a,d=this.y-b,e=this.radius*this.radius;return c*=c,d*=d,e>=c+d},e.Circle.prototype.getBounds=function(){return new e.Rectangle(this.x-this.radius,this.y-this.radius,this.width,this.height)},e.Circle.prototype.constructor=e.Circle,e.Ellipse=function(a,b,c,d){this.x=a||0,this.y=b||0,this.width=c||0,this.height=d||0},e.Ellipse.prototype.clone=function(){return new e.Ellipse(this.x,this.y,this.width,this.height)},e.Ellipse.prototype.contains=function(a,b){if(this.width<=0||this.height<=0)return!1;var c=(a-this.x)/this.width,d=(b-this.y)/this.height;return c*=c,d*=d,1>=c+d},e.Ellipse.prototype.getBounds=function(){return new e.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},e.Ellipse.prototype.constructor=e.Ellipse,e.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},e.Matrix.prototype.fromArray=function(a){this.a=a[0],this.b=a[1],this.c=a[3],this.d=a[4],this.tx=a[2],this.ty=a[5]},e.Matrix.prototype.toArray=function(a){this.array||(this.array=new Float32Array(9));var b=this.array;return a?(b[0]=this.a,b[1]=this.c,b[2]=0,b[3]=this.b,b[4]=this.d,b[5]=0,b[6]=this.tx,b[7]=this.ty,b[8]=1):(b[0]=this.a,b[1]=this.b,b[2]=this.tx,b[3]=this.c,b[4]=this.d,b[5]=this.ty,b[6]=0,b[7]=0,b[8]=1),b},e.identityMatrix=new e.Matrix,e.determineMatrixArrayType=function(){return"undefined"!=typeof Float32Array?Float32Array:Array},e.Matrix2=e.determineMatrixArrayType(),e.DisplayObject=function(){this.position=new e.Point,this.scale=new e.Point(1,1),this.pivot=new e.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new e.Matrix,this.color=[],this.dynamic=!0,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new e.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},e.DisplayObject.prototype.constructor=e.DisplayObject,e.DisplayObject.prototype.setInteractive=function(a){this.interactive=a},Object.defineProperty(e.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(a){this._interactive=a,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"worldVisible",{get:function(){var a=this;do{if(!a.visible)return!1;a=a.parent}while(a);return!0}}),Object.defineProperty(e.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(a){this._mask&&(this._mask.isMask=!1),this._mask=a,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(e.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(a){if(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].passes,e=0;e<d.length;e++)b.push(d[e]);this._filterBlock={target:this,filterPasses:b}}this._filters=a}}),Object.defineProperty(e.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap!==a&&(a?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=a)}}),e.DisplayObject.prototype.updateTransform=function(){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var a=this.parent.worldTransform,b=this.worldTransform,c=this.pivot.x,d=this.pivot.y,e=this._cr*this.scale.x,f=-this._sr*this.scale.y,g=this._sr*this.scale.x,h=this._cr*this.scale.y,i=this.position.x-e*c-d*f,j=this.position.y-h*d-c*g,k=a.a,l=a.b,m=a.c,n=a.d;b.a=k*e+l*g,b.b=k*f+l*h,b.tx=k*i+l*j+a.tx,b.c=m*e+n*g,b.d=m*f+n*h,b.ty=m*i+n*j+a.ty,this.worldAlpha=this.alpha*this.parent.worldAlpha},e.DisplayObject.prototype.getBounds=function(a){return a=a,e.EmptyRectangle},e.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(e.identityMatrix)},e.DisplayObject.prototype.setStageReference=function(a){this.stage=a,this._interactive&&(this.stage.dirty=!0)},e.DisplayObject.prototype.generateTexture=function(a){var b=this.getLocalBounds(),c=new e.RenderTexture(0|b.width,0|b.height,a);return c.render(this,new e.Point(-b.x,-b.y)),c},e.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},e.DisplayObject.prototype._renderCachedSprite=function(a){this._cachedSprite.worldAlpha=this.worldAlpha,a.gl?e.Sprite.prototype._renderWebGL.call(this._cachedSprite,a):e.Sprite.prototype._renderCanvas.call(this._cachedSprite,a)},e.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var a=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|a.width,0|a.height);else{var b=new e.RenderTexture(0|a.width,0|a.height);this._cachedSprite=new e.Sprite(b),this._cachedSprite.worldTransform=this.worldTransform}var c=this._filters;this._filters=null,this._cachedSprite.filters=c,this._cachedSprite.texture.render(this,new e.Point(-a.x,-a.y)),this._cachedSprite.anchor.x=-(a.x/a.width),this._cachedSprite.anchor.y=-(a.y/a.height),this._filters=c,this._cacheAsBitmap=!0},e.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},e.DisplayObject.prototype._renderWebGL=function(a){a=a},e.DisplayObject.prototype._renderCanvas=function(a){a=a},Object.defineProperty(e.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(a){this.position.x=a}}),Object.defineProperty(e.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(a){this.position.y=a}}),e.DisplayObjectContainer=function(){e.DisplayObject.call(this),this.children=[]},e.DisplayObjectContainer.prototype=Object.create(e.DisplayObject.prototype),e.DisplayObjectContainer.prototype.constructor=e.DisplayObjectContainer,Object.defineProperty(e.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(a){var b=this.getLocalBounds().width;0!==b?this.scale.x=a/(b/this.scale.x):this.scale.x=1,this._width=a}}),Object.defineProperty(e.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(a){var b=this.getLocalBounds().height;0!==b?this.scale.y=a/(b/this.scale.y):this.scale.y=1,this._height=a}}),e.DisplayObjectContainer.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)},e.DisplayObjectContainer.prototype.addChildAt=function(a,b){if(b>=0&&b<=this.children.length)return a.parent&&a.parent.removeChild(a),a.parent=this,this.children.splice(b,0,a),this.stage&&a.setStageReference(this.stage),a;throw new Error(a+" The index "+b+" supplied is out of bounds "+this.children.length)},e.DisplayObjectContainer.prototype.swapChildren=function(a,b){if(a!==b){var c=this.children.indexOf(a),d=this.children.indexOf(b);if(0>c||0>d)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[c]=b,this.children[d]=a}},e.DisplayObjectContainer.prototype.getChildAt=function(a){if(a>=0&&a<this.children.length)return this.children[a];throw new Error("Supplied index does not exist in the child list, or the supplied DisplayObject must be a child of the caller")},e.DisplayObjectContainer.prototype.removeChild=function(a){return this.removeChildAt(this.children.indexOf(a))},e.DisplayObjectContainer.prototype.removeChildAt=function(a){var b=this.getChildAt(a);return this.stage&&b.removeStageReference(),b.parent=void 0,this.children.splice(a,1),b},e.DisplayObjectContainer.prototype.removeChildren=function(a,b){var c=a||0,d="number"==typeof b?b:this.children.length,e=d-c;if(e>0&&d>=e){for(var f=this.children.splice(c,e),g=0;g<f.length;g++){var h=f[g];this.stage&&h.removeStageReference(),h.parent=void 0}return f}throw new Error("Range Error, numeric values are outside the acceptable range")},e.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(e.DisplayObject.prototype.updateTransform.call(this),!this._cacheAsBitmap))for(var a=0,b=this.children.length;b>a;a++)this.children[a].updateTransform()},e.DisplayObjectContainer.prototype.getBounds=function(a){if(0===this.children.length)return e.EmptyRectangle;if(a){var b=this.worldTransform;this.worldTransform=a,this.updateTransform(),this.worldTransform=b}for(var c,d,f,g=1/0,h=1/0,i=-(1/0),j=-(1/0),k=!1,l=0,m=this.children.length;m>l;l++){var n=this.children[l];n.visible&&(k=!0,c=this.children[l].getBounds(a),g=g<c.x?g:c.x,h=h<c.y?h:c.y,d=c.width+c.x,f=c.height+c.y,i=i>d?i:d,j=j>f?j:f)}if(!k)return e.EmptyRectangle;var o=this._bounds;return o.x=g,o.y=h,o.width=i-g,o.height=j-h,o},e.DisplayObjectContainer.prototype.getLocalBounds=function(){var a=this.worldTransform;this.worldTransform=e.identityMatrix;for(var b=0,c=this.children.length;c>b;b++)this.children[b].updateTransform();var d=this.getBounds();return this.worldTransform=a,d},e.DisplayObjectContainer.prototype.setStageReference=function(a){this.stage=a,this._interactive&&(this.stage.dirty=!0);for(var b=0,c=this.children.length;c>b;b++){var d=this.children[b];d.setStageReference(a)}},e.DisplayObjectContainer.prototype.removeStageReference=function(){for(var a=0,b=this.children.length;b>a;a++){var c=this.children[a];c.removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},e.DisplayObjectContainer.prototype._renderWebGL=function(a){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(a);var b,c;if(this._mask||this._filters){for(this._filters&&(a.spriteBatch.flush(),a.filterManager.pushFilter(this._filterBlock)),this._mask&&(a.spriteBatch.stop(),a.maskManager.pushMask(this.mask,a),a.spriteBatch.start()),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a);a.spriteBatch.stop(),this._mask&&a.maskManager.popMask(this._mask,a),this._filters&&a.filterManager.popFilter(),a.spriteBatch.start()}else for(b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a)}},e.DisplayObjectContainer.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(a);this._mask&&a.maskManager.pushMask(this._mask,a.context);for(var b=0,c=this.children.length;c>b;b++){var d=this.children[b];d._renderCanvas(a)}this._mask&&a.maskManager.popMask(a.context)}},e.Sprite=function(a){e.DisplayObjectContainer.call(this),this.anchor=new e.Point,this.texture=a,this._width=0,this._height=0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL,a.baseTexture.hasLoaded?this.onTextureUpdate():(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},e.Sprite.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Sprite.prototype.constructor=e.Sprite,Object.defineProperty(e.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=a/this.texture.frame.width,this._width=a}}),Object.defineProperty(e.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height,this._height=a}}),e.Sprite.prototype.setTexture=function(a){this.texture=a,this.cachedTint=16777215},e.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},e.Sprite.prototype.getBounds=function(a){var b=this.texture.frame.width,c=this.texture.frame.height,d=b*(1-this.anchor.x),e=b*-this.anchor.x,f=c*(1-this.anchor.y),g=c*-this.anchor.y,h=a||this.worldTransform,i=h.a,j=h.c,k=h.b,l=h.d,m=h.tx,n=h.ty,o=i*e+k*g+m,p=l*g+j*e+n,q=i*d+k*g+m,r=l*g+j*d+n,s=i*d+k*f+m,t=l*f+j*d+n,u=i*e+k*f+m,v=l*f+j*e+n,w=-(1/0),x=-(1/0),y=1/0,z=1/0;y=y>o?o:y,y=y>q?q:y,y=y>s?s:y,y=y>u?u:y,z=z>p?p:z,z=z>r?r:z,z=z>t?t:z,z=z>v?v:z,w=o>w?o:w,w=q>w?q:w,w=s>w?s:w,w=u>w?u:w,x=p>x?p:x,x=r>x?r:x,x=t>x?t:x,x=v>x?v:x;var A=this._bounds;return A.x=y,A.width=w-y,A.y=z,A.height=x-z,this._currentBounds=A,A},e.Sprite.prototype._renderWebGL=function(a){if(this.visible&&!(this.alpha<=0)){var b,c;if(this._mask||this._filters){var d=a.spriteBatch;for(this._filters&&(d.flush(),a.filterManager.pushFilter(this._filterBlock)),this._mask&&(d.stop(),a.maskManager.pushMask(this.mask,a),d.start()),d.render(this),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a);d.stop(),this._mask&&a.maskManager.popMask(this._mask,a),this._filters&&a.filterManager.popFilter(),d.start()}else for(a.spriteBatch.render(this),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a)}},e.Sprite.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha){if(this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,a.context.globalCompositeOperation=e.blendModesCanvas[a.currentBlendMode]),this._mask&&a.maskManager.pushMask(this._mask,a.context),this.texture.valid){a.context.globalAlpha=this.worldAlpha,a.roundPixels?a.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,0|this.worldTransform.tx,0|this.worldTransform.ty):a.context.setTransform(this.worldTransform.a,this.worldTransform.c,this.worldTransform.b,this.worldTransform.d,this.worldTransform.tx,this.worldTransform.ty),a.smoothProperty&&a.scaleMode!==this.texture.baseTexture.scaleMode&&(a.scaleMode=this.texture.baseTexture.scaleMode,a.context[a.smoothProperty]=a.scaleMode===e.scaleModes.LINEAR);var b=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,c=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=e.CanvasTinter.getTintedTexture(this,this.tint)),a.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,b,c,this.texture.crop.width,this.texture.crop.height)):a.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,b,c,this.texture.crop.width,this.texture.crop.height)}for(var d=0,f=this.children.length;f>d;d++)this.children[d]._renderCanvas(a);this._mask&&a.maskManager.popMask(a.context)}},e.Sprite.fromFrame=function(a){var b=e.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache'+this);return new e.Sprite(b)},e.Sprite.fromImage=function(a,b,c){var d=e.Texture.fromImage(a,b,c);return new e.Sprite(d)},e.SpriteBatch=function(a){e.DisplayObjectContainer.call(this),this.textureThing=a,this.ready=!1},e.SpriteBatch.prototype=Object.create(e.DisplayObjectContainer.prototype),e.SpriteBatch.constructor=e.SpriteBatch,e.SpriteBatch.prototype.initWebGL=function(a){this.fastSpriteBatch=new e.WebGLFastSpriteBatch(a),this.ready=!0},e.SpriteBatch.prototype.updateTransform=function(){e.DisplayObject.prototype.updateTransform.call(this)},e.SpriteBatch.prototype._renderWebGL=function(a){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(a.gl),a.spriteBatch.stop(),a.shaderManager.setShader(a.shaderManager.fastShader),this.fastSpriteBatch.begin(this,a),this.fastSpriteBatch.render(this),a.spriteBatch.start())},e.SpriteBatch.prototype._renderCanvas=function(a){var b=a.context;b.globalAlpha=this.worldAlpha,e.DisplayObject.prototype.updateTransform.call(this);for(var c=this.worldTransform,d=!0,f=0;f<this.children.length;f++){var g=this.children[f];if(g.visible){var h=g.texture,i=h.frame;
if(b.globalAlpha=this.worldAlpha*g.alpha,g.rotation%(2*Math.PI)===0)d&&(b.setTransform(c.a,c.c,c.b,c.d,c.tx,c.ty),d=!1),b.drawImage(h.baseTexture.source,i.x,i.y,i.width,i.height,g.anchor.x*-i.width*g.scale.x+g.position.x+.5|0,g.anchor.y*-i.height*g.scale.y+g.position.y+.5|0,i.width*g.scale.x,i.height*g.scale.y);else{d||(d=!0),e.DisplayObject.prototype.updateTransform.call(g);var j=g.worldTransform;a.roundPixels?b.setTransform(j.a,j.c,j.b,j.d,0|j.tx,0|j.ty):b.setTransform(j.a,j.c,j.b,j.d,j.tx,j.ty),b.drawImage(h.baseTexture.source,i.x,i.y,i.width,i.height,g.anchor.x*-i.width+.5|0,g.anchor.y*-i.height+.5|0,i.width,i.height)}}}},e.MovieClip=function(a){e.Sprite.call(this,a[0]),this.textures=a,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},e.MovieClip.prototype=Object.create(e.Sprite.prototype),e.MovieClip.prototype.constructor=e.MovieClip,Object.defineProperty(e.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),e.MovieClip.prototype.stop=function(){this.playing=!1},e.MovieClip.prototype.play=function(){this.playing=!0},e.MovieClip.prototype.gotoAndStop=function(a){this.playing=!1,this.currentFrame=a;var b=this.currentFrame+.5|0;this.setTexture(this.textures[b%this.textures.length])},e.MovieClip.prototype.gotoAndPlay=function(a){this.currentFrame=a,this.playing=!0},e.MovieClip.prototype.updateTransform=function(){if(e.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var a=this.currentFrame+.5|0;this.currentFrame=this.currentFrame%this.textures.length,this.loop||a<this.textures.length?this.setTexture(this.textures[a%this.textures.length]):a>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},e.MovieClip.fromFrames=function(a){for(var b=[],c=0;c<a.length;c++)b.push(new e.Texture.fromFrame(a[c]));return new e.MovieClip(b)},e.MovieClip.fromImages=function(a){for(var b=[],c=0;c<a.length;c++)b.push(new e.Texture.fromImage(a[c]));return new e.MovieClip(b)},e.FilterBlock=function(){this.visible=!0,this.renderable=!0},e.Text=function(a,b){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),e.Sprite.call(this,e.Texture.fromCanvas(this.canvas)),this.setText(a),this.setStyle(b)},e.Text.prototype=Object.create(e.Sprite.prototype),e.Text.prototype.constructor=e.Text,Object.defineProperty(e.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=a/this.texture.frame.width,this._width=a}}),Object.defineProperty(e.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height,this._height=a}}),e.Text.prototype.setStyle=function(a){a=a||{},a.font=a.font||"bold 20pt Arial",a.fill=a.fill||"black",a.align=a.align||"left",a.stroke=a.stroke||"black",a.strokeThickness=a.strokeThickness||0,a.wordWrap=a.wordWrap||!1,a.wordWrapWidth=a.wordWrapWidth||100,a.wordWrapWidth=a.wordWrapWidth||100,a.dropShadow=a.dropShadow||!1,a.dropShadowAngle=a.dropShadowAngle||Math.PI/6,a.dropShadowDistance=a.dropShadowDistance||4,a.dropShadowColor=a.dropShadowColor||"black",this.style=a,this.dirty=!0},e.Text.prototype.setText=function(a){this.text=a.toString()||" ",this.dirty=!0},e.Text.prototype.updateText=function(){this.context.font=this.style.font;var a=this.text;this.style.wordWrap&&(a=this.wordWrap(this.text));for(var b=a.split(/(?:\r\n|\r|\n)/),c=[],d=0,e=0;e<b.length;e++){var f=this.context.measureText(b[e]).width;c[e]=f,d=Math.max(d,f)}var g=d+this.style.strokeThickness;this.style.dropShadow&&(g+=this.style.dropShadowDistance),this.canvas.width=g+this.context.lineWidth;var h=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness,i=h*b.length;this.style.dropShadow&&(i+=this.style.dropShadowDistance),this.canvas.height=i,navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top";var j,k;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var l=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,m=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(e=0;e<b.length;e++)j=this.style.strokeThickness/2,k=this.style.strokeThickness/2+e*h,"right"===this.style.align?j+=d-c[e]:"center"===this.style.align&&(j+=(d-c[e])/2),this.style.fill&&this.context.fillText(b[e],j+l,k+m)}for(this.context.fillStyle=this.style.fill,e=0;e<b.length;e++)j=this.style.strokeThickness/2,k=this.style.strokeThickness/2+e*h,"right"===this.style.align?j+=d-c[e]:"center"===this.style.align&&(j+=(d-c[e])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(b[e],j,k),this.style.fill&&this.context.fillText(b[e],j,k);this.updateTexture()},e.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.crop.width=this.texture.frame.width=this.canvas.width,this.texture.crop.height=this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.requiresUpdate=!0},e.Text.prototype._renderWebGL=function(a){this.requiresUpdate&&(this.requiresUpdate=!1,e.updateWebGLTexture(this.texture.baseTexture,a.gl)),e.Sprite.prototype._renderWebGL.call(this,a)},e.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.Sprite.prototype.updateTransform.call(this)},e.Text.prototype.determineFontHeight=function(a){var b=e.Text.heightCache[a];if(!b){var c=document.getElementsByTagName("body")[0],d=document.createElement("div"),f=document.createTextNode("M");d.appendChild(f),d.setAttribute("style",a+";position:absolute;top:0;left:0"),c.appendChild(d),b=d.offsetHeight,e.Text.heightCache[a]=b,c.removeChild(d)}return b},e.Text.prototype.wordWrap=function(a){for(var b="",c=a.split("\n"),d=0;d<c.length;d++){for(var e=this.style.wordWrapWidth,f=c[d].split(" "),g=0;g<f.length;g++){var h=this.context.measureText(f[g]).width,i=h+this.context.measureText(" ").width;0===g||i>e?(g>0&&(b+="\n"),b+=f[g],e=this.style.wordWrapWidth-h):(e-=i,b+=" "+f[g])}d<c.length-1&&(b+="\n")}return b},e.Text.prototype.destroy=function(a){this.context=null,this.canvas=null,this.texture.destroy(void 0===a?!0:a)},e.Text.heightCache={},e.BitmapText=function(a,b){e.DisplayObjectContainer.call(this),this._pool=[],this.setText(a),this.setStyle(b),this.updateText(),this.dirty=!1},e.BitmapText.prototype=Object.create(e.DisplayObjectContainer.prototype),e.BitmapText.prototype.constructor=e.BitmapText,e.BitmapText.prototype.setText=function(a){this.text=a||" ",this.dirty=!0},e.BitmapText.prototype.setStyle=function(a){a=a||{},a.align=a.align||"left",this.style=a;var b=a.font.split(" ");this.fontName=b[b.length-1],this.fontSize=b.length>=2?parseInt(b[b.length-2],10):e.BitmapText.fonts[this.fontName].size,this.dirty=!0,this.tint=a.tint},e.BitmapText.prototype.updateText=function(){for(var a=e.BitmapText.fonts[this.fontName],b=new e.Point,c=null,d=[],f=0,g=[],h=0,i=this.fontSize/a.size,j=0;j<this.text.length;j++){var k=this.text.charCodeAt(j);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(j)))g.push(b.x),f=Math.max(f,b.x),h++,b.x=0,b.y+=a.lineHeight,c=null;else{var l=a.chars[k];l&&(c&&l[c]&&(b.x+=l.kerning[c]),d.push({texture:l.texture,line:h,charCode:k,position:new e.Point(b.x+l.xOffset,b.y+l.yOffset)}),b.x+=l.xAdvance,c=k)}}g.push(b.x),f=Math.max(f,b.x);var m=[];for(j=0;h>=j;j++){var n=0;"right"===this.style.align?n=f-g[j]:"center"===this.style.align&&(n=(f-g[j])/2),m.push(n)}var o=this.children.length,p=d.length,q=this.tint||16777215;for(j=0;p>j;j++){var r=o>j?this.children[j]:this._pool.pop();r?r.setTexture(d[j].texture):r=new e.Sprite(d[j].texture),r.position.x=(d[j].position.x+m[d[j].line])*i,r.position.y=d[j].position.y*i,r.scale.x=r.scale.y=i,r.tint=q,r.parent||this.addChild(r)}for(;this.children.length>p;){var s=this.getChildAt(this.children.length-1);this._pool.push(s),this.removeChild(s)}this.textWidth=f*i,this.textHeight=(b.y+a.lineHeight)*i},e.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.BitmapText.fonts={},e.InteractionData=function(){this.global=new e.Point,this.target=null,this.originalEvent=null},e.InteractionData.prototype.getLocalPosition=function(a){var b=a.worldTransform,c=this.global,d=b.a,f=b.b,g=b.tx,h=b.c,i=b.d,j=b.ty,k=1/(d*i+f*-h);return new e.Point(i*k*c.x+-f*k*c.y+(j*f-g*i)*k,d*k*c.y+-h*k*c.x+(-j*d+g*h)*k)},e.InteractionData.prototype.constructor=e.InteractionData,e.InteractionManager=function(a){this.stage=a,this.mouse=new e.InteractionData,this.touchs={},this.tempPoint=new e.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.mouseOut=!1},e.InteractionManager.prototype.constructor=e.InteractionManager,e.InteractionManager.prototype.collectInteractiveSprite=function(a,b){for(var c=a.children,d=c.length,e=d-1;e>=0;e--){var f=c[e];f._interactive?(b.interactiveChildren=!0,this.interactiveItems.push(f),f.children.length>0&&this.collectInteractiveSprite(f,f)):(f.__iParent=null,f.children.length>0&&this.collectInteractiveSprite(f,b))}},e.InteractionManager.prototype.setTarget=function(a){this.target=a,null===this.interactionDOMElement&&this.setTargetDomElement(a.view)},e.InteractionManager.prototype.setTargetDomElement=function(a){this.removeEvents(),window.navigator.msPointerEnabled&&(a.style["-ms-content-zooming"]="none",a.style["-ms-touch-action"]="none"),this.interactionDOMElement=a,a.addEventListener("mousemove",this.onMouseMove,!0),a.addEventListener("mousedown",this.onMouseDown,!0),a.addEventListener("mouseout",this.onMouseOut,!0),a.addEventListener("touchstart",this.onTouchStart,!0),a.addEventListener("touchend",this.onTouchEnd,!0),a.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0)},e.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0))},e.InteractionManager.prototype.update=function(){if(this.target){var a=Date.now(),b=a-this.last;if(b=b*e.INTERACTION_FREQUENCY/1e3,!(1>b)){this.last=a;var c=0;this.dirty&&this.rebuildInteractiveGraph();var d=this.interactiveItems.length,f="inherit",g=!1;for(c=0;d>c;c++){var h=this.interactiveItems[c];h.__hit=this.hitTest(h,this.mouse),this.mouse.target=h,h.__hit&&!g?(h.buttonMode&&(f=h.defaultCursor),h.interactiveChildren||(g=!0),h.__isOver||(h.mouseover&&h.mouseover(this.mouse),h.__isOver=!0)):h.__isOver&&(h.mouseout&&h.mouseout(this.mouse),h.__isOver=!1)}this.currentCursorStyle!==f&&(this.currentCursorStyle=f,this.interactionDOMElement.style.cursor=f)}}},e.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=!1;for(var a=this.interactiveItems.length,b=0;a>b;b++)this.interactiveItems[b].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)},e.InteractionManager.prototype.onMouseMove=function(a){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=a||window.event;var b=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(a.clientX-b.left)*(this.target.width/b.width),this.mouse.global.y=(a.clientY-b.top)*(this.target.height/b.height);for(var c=this.interactiveItems.length,d=0;c>d;d++){var e=this.interactiveItems[d];e.mousemove&&e.mousemove(this.mouse)}},e.InteractionManager.prototype.onMouseDown=function(a){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=a||window.event,e.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var b=this.interactiveItems.length,c=0;b>c;c++){var d=this.interactiveItems[c];if((d.mousedown||d.click)&&(d.__mouseIsDown=!0,d.__hit=this.hitTest(d,this.mouse),d.__hit&&(d.mousedown&&d.mousedown(this.mouse),d.__isDown=!0,!d.interactiveChildren)))break}},e.InteractionManager.prototype.onMouseOut=function(){this.dirty&&this.rebuildInteractiveGraph();var a=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var b=0;a>b;b++){var c=this.interactiveItems[b];c.__isOver&&(this.mouse.target=c,c.mouseout&&c.mouseout(this.mouse),c.__isOver=!1)}this.mouseOut=!0,this.mouse.global.x=-1e4,this.mouse.global.y=-1e4},e.InteractionManager.prototype.onMouseUp=function(a){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=a||window.event;for(var b=this.interactiveItems.length,c=!1,d=0;b>d;d++){var e=this.interactiveItems[d];e.__hit=this.hitTest(e,this.mouse),e.__hit&&!c?(e.mouseup&&e.mouseup(this.mouse),e.__isDown&&e.click&&e.click(this.mouse),e.interactiveChildren||(c=!0)):e.__isDown&&e.mouseupoutside&&e.mouseupoutside(this.mouse),e.__isDown=!1}},e.InteractionManager.prototype.hitTest=function(a,b){var c=b.global;if(!a.worldVisible)return!1;var d=a instanceof e.Sprite,f=a.worldTransform,g=f.a,h=f.b,i=f.tx,j=f.c,k=f.d,l=f.ty,m=1/(g*k+h*-j),n=k*m*c.x+-h*m*c.y+(l*h-i*k)*m,o=g*m*c.y+-j*m*c.x+(-l*g+i*j)*m;if(b.target=a,a.hitArea&&a.hitArea.contains)return a.hitArea.contains(n,o)?(b.target=a,!0):!1;if(d){var p,q=a.texture.frame.width,r=a.texture.frame.height,s=-q*a.anchor.x;if(n>s&&s+q>n&&(p=-r*a.anchor.y,o>p&&p+r>o))return b.target=a,!0}for(var t=a.children.length,u=0;t>u;u++){var v=a.children[u],w=this.hitTest(v,b);if(w)return b.target=a,!0}return!1},e.InteractionManager.prototype.onTouchMove=function(a){this.dirty&&this.rebuildInteractiveGraph();var b,c=this.interactionDOMElement.getBoundingClientRect(),d=a.changedTouches,e=0;for(e=0;e<d.length;e++){var f=d[e];b=this.touchs[f.identifier],b.originalEvent=a||window.event,b.global.x=(f.clientX-c.left)*(this.target.width/c.width),b.global.y=(f.clientY-c.top)*(this.target.height/c.height),navigator.isCocoonJS&&(b.global.x=f.clientX,b.global.y=f.clientY);for(var g=0;g<this.interactiveItems.length;g++){var h=this.interactiveItems[g];h.touchmove&&h.__touchData&&h.__touchData[f.identifier]&&h.touchmove(b)}}},e.InteractionManager.prototype.onTouchStart=function(a){this.dirty&&this.rebuildInteractiveGraph();var b=this.interactionDOMElement.getBoundingClientRect();e.AUTO_PREVENT_DEFAULT&&a.preventDefault();for(var c=a.changedTouches,d=0;d<c.length;d++){var f=c[d],g=this.pool.pop();g||(g=new e.InteractionData),g.originalEvent=a||window.event,this.touchs[f.identifier]=g,g.global.x=(f.clientX-b.left)*(this.target.width/b.width),g.global.y=(f.clientY-b.top)*(this.target.height/b.height),navigator.isCocoonJS&&(g.global.x=f.clientX,g.global.y=f.clientY);for(var h=this.interactiveItems.length,i=0;h>i;i++){var j=this.interactiveItems[i];if((j.touchstart||j.tap)&&(j.__hit=this.hitTest(j,g),j.__hit&&(j.touchstart&&j.touchstart(g),j.__isDown=!0,j.__touchData=j.__touchData||{},j.__touchData[f.identifier]=g,!j.interactiveChildren)))break}}},e.InteractionManager.prototype.onTouchEnd=function(a){this.dirty&&this.rebuildInteractiveGraph();for(var b=this.interactionDOMElement.getBoundingClientRect(),c=a.changedTouches,d=0;d<c.length;d++){var e=c[d],f=this.touchs[e.identifier],g=!1;f.global.x=(e.clientX-b.left)*(this.target.width/b.width),f.global.y=(e.clientY-b.top)*(this.target.height/b.height),navigator.isCocoonJS&&(f.global.x=e.clientX,f.global.y=e.clientY);for(var h=this.interactiveItems.length,i=0;h>i;i++){var j=this.interactiveItems[i];j.__touchData&&j.__touchData[e.identifier]&&(j.__hit=this.hitTest(j,j.__touchData[e.identifier]),f.originalEvent=a||window.event,(j.touchend||j.tap)&&(j.__hit&&!g?(j.touchend&&j.touchend(f),j.__isDown&&j.tap&&j.tap(f),j.interactiveChildren||(g=!0)):j.__isDown&&j.touchendoutside&&j.touchendoutside(f),j.__isDown=!1),j.__touchData[e.identifier]=null)}this.pool.push(f),this.touchs[e.identifier]=null}},e.Stage=function(a){e.DisplayObjectContainer.call(this),this.worldTransform=new e.Matrix,this.interactive=!0,this.interactionManager=new e.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new e.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(a)},e.Stage.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Stage.prototype.constructor=e.Stage,e.Stage.prototype.setInteractionDelegate=function(a){this.interactionManager.setTargetDomElement(a)},e.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var a=0,b=this.children.length;b>a;a++)this.children[a].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},e.Stage.prototype.setBackgroundColor=function(a){this.backgroundColor=a||0,this.backgroundColorSplit=e.hex2rgb(this.backgroundColor);var b=this.backgroundColor.toString(16);b="000000".substr(0,6-b.length)+b,this.backgroundColorString="#"+b},e.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global};for(var f=0,g=["ms","moz","webkit","o"],h=0;h<g.length&&!window.requestAnimationFrame;++h)window.requestAnimationFrame=window[g[h]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[g[h]+"CancelAnimationFrame"]||window[g[h]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=(new Date).getTime(),c=Math.max(0,16-(b-f)),d=window.setTimeout(function(){a(b+c)},c);return f=b+c,d}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)}),window.requestAnimFrame=window.requestAnimationFrame,e.hex2rgb=function(a){return[(a>>16&255)/255,(a>>8&255)/255,(255&a)/255]},e.rgb2hex=function(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var a=Array.prototype.slice;return function(b){function c(){var f=e.concat(a.call(arguments));d.apply(this instanceof c?this:b,f)}var d=this,e=a.call(arguments,1);if("function"!=typeof d)throw new TypeError;return c.prototype=function f(a){return a&&(f.prototype=a),this instanceof f?void 0:new f}(d.prototype),c}}()),e.AjaxRequest=function(){var a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var b=0;b<a.length;b++)try{return new window.ActiveXObject(a[b])}catch(c){}},e.canUseNewCanvasBlendModes=function(){var a=document.createElement("canvas");a.width=1,a.height=1;var b=a.getContext("2d");return b.fillStyle="#000",b.fillRect(0,0,1,1),b.globalCompositeOperation="multiply",b.fillStyle="#fff",b.fillRect(0,0,1,1),0===b.getImageData(0,0,1,1).data[0]},e.getNextPowerOfTwo=function(a){if(a>0&&0===(a&a-1))return a;for(var b=1;a>b;)b<<=1;return b},e.EventTarget=function(){var a={};this.addEventListener=this.on=function(b,c){void 0===a[b]&&(a[b]=[]),-1===a[b].indexOf(c)&&a[b].unshift(c)},this.dispatchEvent=this.emit=function(b){if(a[b.type]&&a[b.type].length)for(var c=a[b.type].length-1;c>=0;c--)a[b.type][c](b)},this.removeEventListener=this.off=function(b,c){if(void 0!==a[b]){var d=a[b].indexOf(c);-1!==d&&a[b].splice(d,1)}},this.removeAllEventListeners=function(b){var c=a[b];c&&(c.length=0)}},e.autoDetectRenderer=function(a,b,c,d,f){a||(a=800),b||(b=600);var g=function(){try{var a=document.createElement("canvas");return!!window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))}catch(b){return!1}}();return g?new e.WebGLRenderer(a,b,c,d,f):new e.CanvasRenderer(a,b,c,d)},e.autoDetectRecommendedRenderer=function(a,b,c,d,f){a||(a=800),b||(b=600);var g=function(){try{var a=document.createElement("canvas");return!!window.WebGLRenderingContext&&(a.getContext("webgl")||a.getContext("experimental-webgl"))}catch(b){return!1}}(),h=/Android/i.test(navigator.userAgent);return g&&!h?new e.WebGLRenderer(a,b,c,d,f):new e.CanvasRenderer(a,b,c,d)},e.PolyK={},e.PolyK.Triangulate=function(a){var b=!0,c=a.length>>1;if(3>c)return[];for(var d=[],f=[],g=0;c>g;g++)f.push(g);g=0;for(var h=c;h>3;){var i=f[(g+0)%h],j=f[(g+1)%h],k=f[(g+2)%h],l=a[2*i],m=a[2*i+1],n=a[2*j],o=a[2*j+1],p=a[2*k],q=a[2*k+1],r=!1;if(e.PolyK._convex(l,m,n,o,p,q,b)){r=!0;for(var s=0;h>s;s++){var t=f[s];if(t!==i&&t!==j&&t!==k&&e.PolyK._PointInTriangle(a[2*t],a[2*t+1],l,m,n,o,p,q)){r=!1;break}}}if(r)d.push(i,j,k),f.splice((g+1)%h,1),h--,g=0;else if(g++>3*h){if(!b)return window.console.log("PIXI Warning: shape too complex to fill"),[];for(d=[],f=[],g=0;c>g;g++)f.push(g);g=0,h=c,b=!1}}return d.push(f[0],f[1],f[2]),d},e.PolyK._PointInTriangle=function(a,b,c,d,e,f,g,h){var i=g-c,j=h-d,k=e-c,l=f-d,m=a-c,n=b-d,o=i*i+j*j,p=i*k+j*l,q=i*m+j*n,r=k*k+l*l,s=k*m+l*n,t=1/(o*r-p*p),u=(r*q-p*s)*t,v=(o*s-p*q)*t;return u>=0&&v>=0&&1>u+v},e.PolyK._convex=function(a,b,c,d,e,f,g){return(b-d)*(e-c)+(c-a)*(f-d)>=0===g},e.initDefaultShaders=function(){},e.CompileVertexShader=function(a,b){return e._CompileShader(a,b,a.VERTEX_SHADER)},e.CompileFragmentShader=function(a,b){return e._CompileShader(a,b,a.FRAGMENT_SHADER)},e._CompileShader=function(a,b,c){var d=b.join("\n"),e=a.createShader(c);return a.shaderSource(e,d),a.compileShader(e),a.getShaderParameter(e,a.COMPILE_STATUS)?e:(window.console.log(a.getShaderInfoLog(e)),null)},e.compileProgram=function(a,b,c){var d=e.CompileFragmentShader(a,c),f=e.CompileVertexShader(a,b),g=a.createProgram();return a.attachShader(g,f),a.attachShader(g,d),a.linkProgram(g),a.getProgramParameter(g,a.LINK_STATUS)||window.console.log("Could not initialise shaders"),g},e.PixiShader=function(a){this._UID=e._UID++,this.gl=a,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.attributes=[],this.init()},e.PixiShader.prototype.init=function(){var a=this.gl,b=e.compileProgram(a,this.vertexSrc||e.PixiShader.defaultVertexSrc,this.fragmentSrc);a.useProgram(b),this.uSampler=a.getUniformLocation(b,"uSampler"),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.dimensions=a.getUniformLocation(b,"dimensions"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord"),this.colorAttribute=a.getAttribLocation(b,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var c in this.uniforms)this.uniforms[c].uniformLocation=a.getUniformLocation(b,c);this.initUniforms(),this.program=b},e.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var a,b=this.gl;for(var c in this.uniforms){a=this.uniforms[c];var d=a.type;"sampler2D"===d?(a._init=!1,null!==a.value&&this.initSampler2D(a)):"mat2"===d||"mat3"===d||"mat4"===d?(a.glMatrix=!0,a.glValueLength=1,"mat2"===d?a.glFunc=b.uniformMatrix2fv:"mat3"===d?a.glFunc=b.uniformMatrix3fv:"mat4"===d&&(a.glFunc=b.uniformMatrix4fv)):(a.glFunc=b["uniform"+d],"2f"===d||"2i"===d?a.glValueLength=2:"3f"===d||"3i"===d?a.glValueLength=3:"4f"===d||"4i"===d?a.glValueLength=4:a.glValueLength=1)}},e.PixiShader.prototype.initSampler2D=function(a){if(a.value&&a.value.baseTexture&&a.value.baseTexture.hasLoaded){var b=this.gl;if(b.activeTexture(b["TEXTURE"+this.textureCount]),b.bindTexture(b.TEXTURE_2D,a.value.baseTexture._glTextures[b.id]),a.textureData){var c=a.textureData,d=c.magFilter?c.magFilter:b.LINEAR,e=c.minFilter?c.minFilter:b.LINEAR,f=c.wrapS?c.wrapS:b.CLAMP_TO_EDGE,g=c.wrapT?c.wrapT:b.CLAMP_TO_EDGE,h=c.luminance?b.LUMINANCE:b.RGBA;if(c.repeat&&(f=b.REPEAT,g=b.REPEAT),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!!c.flipY),c.width){var i=c.width?c.width:512,j=c.height?c.height:2,k=c.border?c.border:0;b.texImage2D(b.TEXTURE_2D,0,h,i,j,k,h,b.UNSIGNED_BYTE,null)}else b.texImage2D(b.TEXTURE_2D,0,h,b.RGBA,b.UNSIGNED_BYTE,a.value.baseTexture.source);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,d),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,e),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,f),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,g)}b.uniform1i(a.uniformLocation,this.textureCount),a._init=!0,this.textureCount++}},e.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var a,b=this.gl;for(var c in this.uniforms)a=this.uniforms[c],1===a.glValueLength?a.glMatrix===!0?a.glFunc.call(b,a.uniformLocation,a.transpose,a.value):a.glFunc.call(b,a.uniformLocation,a.value):2===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y):3===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y,a.value.z):4===a.glValueLength?a.glFunc.call(b,a.uniformLocation,a.value.x,a.value.y,a.value.z,a.value.w):"sampler2D"===a.type&&(a._init?(b.activeTexture(b["TEXTURE"+this.textureCount]),b.bindTexture(b.TEXTURE_2D,a.value.baseTexture._glTextures[b.id]||e.createWebGLTexture(a.value.baseTexture,b)),b.uniform1i(a.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(a))},e.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec2 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vec3 color = mod(vec3(aColor.y/65536.0, aColor.y/256.0, aColor.y), 256.0) / 256.0;","   vColor = vec4(color * aColor.x, aColor.x);","}"],e.PixiFastShader=function(a){this._UID=e._UID++,this.gl=a,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},e.PixiFastShader.prototype.init=function(){var a=this.gl,b=e.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.uSampler=a.getUniformLocation(b,"uSampler"),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.dimensions=a.getUniformLocation(b,"dimensions"),this.uMatrix=a.getUniformLocation(b,"uMatrix"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.aPositionCoord=a.getAttribLocation(b,"aPositionCoord"),this.aScale=a.getAttribLocation(b,"aScale"),this.aRotation=a.getAttribLocation(b,"aRotation"),this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord"),this.colorAttribute=a.getAttribLocation(b,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=b},e.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},e.StripShader=function(a){this._UID=e._UID++,this.gl=a,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},e.StripShader.prototype.init=function(){var a=this.gl,b=e.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.uSampler=a.getUniformLocation(b,"uSampler"),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.colorAttribute=a.getAttribLocation(b,"aColor"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.aTextureCoord=a.getAttribLocation(b,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=a.getUniformLocation(b,"translationMatrix"),this.alpha=a.getUniformLocation(b,"alpha"),this.program=b},e.PrimitiveShader=function(a){this._UID=e._UID++,this.gl=a,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},e.PrimitiveShader.prototype.init=function(){var a=this.gl,b=e.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.tintColor=a.getUniformLocation(b,"tint"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.colorAttribute=a.getAttribLocation(b,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=a.getUniformLocation(b,"translationMatrix"),this.alpha=a.getUniformLocation(b,"alpha"),this.program=b},e.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},e.ComplexPrimitiveShader=function(a){this._UID=e._UID++,this.gl=a,
this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},e.ComplexPrimitiveShader.prototype.init=function(){var a=this.gl,b=e.compileProgram(a,this.vertexSrc,this.fragmentSrc);a.useProgram(b),this.projectionVector=a.getUniformLocation(b,"projectionVector"),this.offsetVector=a.getUniformLocation(b,"offsetVector"),this.tintColor=a.getUniformLocation(b,"tint"),this.color=a.getUniformLocation(b,"color"),this.aVertexPosition=a.getAttribLocation(b,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=a.getUniformLocation(b,"translationMatrix"),this.alpha=a.getUniformLocation(b,"alpha"),this.program=b},e.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},e.WebGLGraphics=function(){},e.WebGLGraphics.renderGraphics=function(a,b){var c,d=b.gl,f=b.projection,g=b.offset,h=b.shaderManager.primitiveShader;a.dirty&&e.WebGLGraphics.updateGraphics(a,d);for(var i=a._webGL[d.id],j=0;j<i.data.length;j++)1===i.data[j].mode?(c=i.data[j],b.stencilManager.pushStencil(a,c,b),d.drawElements(d.TRIANGLE_FAN,4,d.UNSIGNED_SHORT,2*(c.indices.length-4)),b.stencilManager.popStencil(a,c,b),this.last=c.mode):(c=i.data[j],b.shaderManager.setShader(h),h=b.shaderManager.primitiveShader,d.uniformMatrix3fv(h.translationMatrix,!1,a.worldTransform.toArray(!0)),d.uniform2f(h.projectionVector,f.x,-f.y),d.uniform2f(h.offsetVector,-g.x,-g.y),d.uniform3fv(h.tintColor,e.hex2rgb(a.tint)),d.uniform1f(h.alpha,a.worldAlpha),d.bindBuffer(d.ARRAY_BUFFER,c.buffer),d.vertexAttribPointer(h.aVertexPosition,2,d.FLOAT,!1,24,0),d.vertexAttribPointer(h.colorAttribute,4,d.FLOAT,!1,24,8),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,c.indexBuffer),d.drawElements(d.TRIANGLE_STRIP,c.indices.length,d.UNSIGNED_SHORT,0))},e.WebGLGraphics.updateGraphics=function(a,b){var c=a._webGL[b.id];c||(c=a._webGL[b.id]={lastIndex:0,data:[],gl:b}),a.dirty=!1;var d;if(a.clearDirty){for(a.clearDirty=!1,d=0;d<c.data.length;d++){var f=c.data[d];f.reset(),e.WebGLGraphics.graphicsDataPool.push(f)}c.data=[],c.lastIndex=0}var g;for(d=c.lastIndex;d<a.graphicsData.length;d++){var h=a.graphicsData[d];h.type===e.Graphics.POLY?(h.fill&&h.points.length>6&&(h.points.length>10?(g=e.WebGLGraphics.switchMode(c,1),e.WebGLGraphics.buildComplexPoly(h,g)):(g=e.WebGLGraphics.switchMode(c,0),e.WebGLGraphics.buildPoly(h,g))),h.lineWidth>0&&(g=e.WebGLGraphics.switchMode(c,0),e.WebGLGraphics.buildLine(h,g))):(g=e.WebGLGraphics.switchMode(c,0),h.type===e.Graphics.RECT?e.WebGLGraphics.buildRectangle(h,g):h.type===e.Graphics.CIRC||h.type===e.Graphics.ELIP?e.WebGLGraphics.buildCircle(h,g):h.type===e.Graphics.RREC&&e.WebGLGraphics.buildRoundedRectangle(h,g)),c.lastIndex++}for(d=0;d<c.data.length;d++)g=c.data[d],g.dirty&&g.upload()},e.WebGLGraphics.switchMode=function(a,b){var c;return a.data.length?(c=a.data[a.data.length-1],(c.mode!==b||1===b)&&(c=e.WebGLGraphics.graphicsDataPool.pop()||new e.WebGLGraphicsData(a.gl),c.mode=b,a.data.push(c))):(c=e.WebGLGraphics.graphicsDataPool.pop()||new e.WebGLGraphicsData(a.gl),c.mode=b,a.data.push(c)),c.dirty=!0,c},e.WebGLGraphics.buildRectangle=function(a,b){var c=a.points,d=c[0],f=c[1],g=c[2],h=c[3];if(a.fill){var i=e.hex2rgb(a.fillColor),j=a.fillAlpha,k=i[0]*j,l=i[1]*j,m=i[2]*j,n=b.points,o=b.indices,p=n.length/6;n.push(d,f),n.push(k,l,m,j),n.push(d+g,f),n.push(k,l,m,j),n.push(d,f+h),n.push(k,l,m,j),n.push(d+g,f+h),n.push(k,l,m,j),o.push(p,p,p+1,p+2,p+3,p+3)}if(a.lineWidth){var q=a.points;a.points=[d,f,d+g,f,d+g,f+h,d,f+h,d,f],e.WebGLGraphics.buildLine(a,b),a.points=q}},e.WebGLGraphics.buildRoundedRectangle=function(a,b){var c=a.points,d=c[0],f=c[1],g=c[2],h=c[3],i=c[4],j=[];if(j.push(d,f+i),j=j.concat(e.WebGLGraphics.quadraticBezierCurve(d,f+h-i,d,f+h,d+i,f+h)),j=j.concat(e.WebGLGraphics.quadraticBezierCurve(d+g-i,f+h,d+g,f+h,d+g,f+h-i)),j=j.concat(e.WebGLGraphics.quadraticBezierCurve(d+g,f+i,d+g,f,d+g-i,f)),j=j.concat(e.WebGLGraphics.quadraticBezierCurve(d+i,f,d,f,d,f+i)),a.fill){var k=e.hex2rgb(a.fillColor),l=a.fillAlpha,m=k[0]*l,n=k[1]*l,o=k[2]*l,p=b.points,q=b.indices,r=p.length/6,s=e.PolyK.Triangulate(j),t=0;for(t=0;t<s.length;t+=3)q.push(s[t]+r),q.push(s[t]+r),q.push(s[t+1]+r),q.push(s[t+2]+r),q.push(s[t+2]+r);for(t=0;t<j.length;t++)p.push(j[t],j[++t],m,n,o,l)}if(a.lineWidth){var u=a.points;a.points=j,e.WebGLGraphics.buildLine(a,b),a.points=u}},e.WebGLGraphics.quadraticBezierCurve=function(a,b,c,d,e,f){function g(a,b,c){var d=b-a;return a+d*c}for(var h,i,j,k,l,m,n=20,o=[],p=0,q=0;n>=q;q++)p=q/n,h=g(a,c,p),i=g(b,d,p),j=g(c,e,p),k=g(d,f,p),l=g(h,j,p),m=g(i,k,p),o.push(l,m);return o},e.WebGLGraphics.buildCircle=function(a,b){var c=a.points,d=c[0],f=c[1],g=c[2],h=c[3],i=40,j=2*Math.PI/i,k=0;if(a.fill){var l=e.hex2rgb(a.fillColor),m=a.fillAlpha,n=l[0]*m,o=l[1]*m,p=l[2]*m,q=b.points,r=b.indices,s=q.length/6;for(r.push(s),k=0;i+1>k;k++)q.push(d,f,n,o,p,m),q.push(d+Math.sin(j*k)*g,f+Math.cos(j*k)*h,n,o,p,m),r.push(s++,s++);r.push(s-1)}if(a.lineWidth){var t=a.points;for(a.points=[],k=0;i+1>k;k++)a.points.push(d+Math.sin(j*k)*g,f+Math.cos(j*k)*h);e.WebGLGraphics.buildLine(a,b),a.points=t}},e.WebGLGraphics.buildLine=function(a,b){var c=0,d=a.points;if(0!==d.length){if(a.lineWidth%2)for(c=0;c<d.length;c++)d[c]+=.5;var f=new e.Point(d[0],d[1]),g=new e.Point(d[d.length-2],d[d.length-1]);if(f.x===g.x&&f.y===g.y){d=d.slice(),d.pop(),d.pop(),g=new e.Point(d[d.length-2],d[d.length-1]);var h=g.x+.5*(f.x-g.x),i=g.y+.5*(f.y-g.y);d.unshift(h,i),d.push(h,i)}var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G=b.points,H=b.indices,I=d.length/2,J=d.length,K=G.length/6,L=a.lineWidth/2,M=e.hex2rgb(a.lineColor),N=a.lineAlpha,O=M[0]*N,P=M[1]*N,Q=M[2]*N;for(l=d[0],m=d[1],n=d[2],o=d[3],r=-(m-o),s=l-n,F=Math.sqrt(r*r+s*s),r/=F,s/=F,r*=L,s*=L,G.push(l-r,m-s,O,P,Q,N),G.push(l+r,m+s,O,P,Q,N),c=1;I-1>c;c++)l=d[2*(c-1)],m=d[2*(c-1)+1],n=d[2*c],o=d[2*c+1],p=d[2*(c+1)],q=d[2*(c+1)+1],r=-(m-o),s=l-n,F=Math.sqrt(r*r+s*s),r/=F,s/=F,r*=L,s*=L,t=-(o-q),u=n-p,F=Math.sqrt(t*t+u*u),t/=F,u/=F,t*=L,u*=L,x=-s+m-(-s+o),y=-r+n-(-r+l),z=(-r+l)*(-s+o)-(-r+n)*(-s+m),A=-u+q-(-u+o),B=-t+n-(-t+p),C=(-t+p)*(-u+o)-(-t+n)*(-u+q),D=x*B-A*y,Math.abs(D)<.1?(D+=10.1,G.push(n-r,o-s,O,P,Q,N),G.push(n+r,o+s,O,P,Q,N)):(j=(y*C-B*z)/D,k=(A*z-x*C)/D,E=(j-n)*(j-n)+(k-o)+(k-o),E>19600?(v=r-t,w=s-u,F=Math.sqrt(v*v+w*w),v/=F,w/=F,v*=L,w*=L,G.push(n-v,o-w),G.push(O,P,Q,N),G.push(n+v,o+w),G.push(O,P,Q,N),G.push(n-v,o-w),G.push(O,P,Q,N),J++):(G.push(j,k),G.push(O,P,Q,N),G.push(n-(j-n),o-(k-o)),G.push(O,P,Q,N)));for(l=d[2*(I-2)],m=d[2*(I-2)+1],n=d[2*(I-1)],o=d[2*(I-1)+1],r=-(m-o),s=l-n,F=Math.sqrt(r*r+s*s),r/=F,s/=F,r*=L,s*=L,G.push(n-r,o-s),G.push(O,P,Q,N),G.push(n+r,o+s),G.push(O,P,Q,N),H.push(K),c=0;J>c;c++)H.push(K++);H.push(K-1)}},e.WebGLGraphics.buildComplexPoly=function(a,b){var c=a.points.slice();if(!(c.length<6)){var d=b.indices;b.points=c,b.alpha=a.fillAlpha,b.color=e.hex2rgb(a.fillColor);for(var f,g,h=1/0,i=-(1/0),j=1/0,k=-(1/0),l=0;l<c.length;l+=2)f=c[l],g=c[l+1],h=h>f?f:h,i=f>i?f:i,j=j>g?g:j,k=g>k?g:k;c.push(h,j,i,j,i,k,h,k);var m=c.length/2;for(l=0;m>l;l++)d.push(l)}},e.WebGLGraphics.buildPoly=function(a,b){var c=a.points;if(!(c.length<6)){var d=b.points,f=b.indices,g=c.length/2,h=e.hex2rgb(a.fillColor),i=a.fillAlpha,j=h[0]*i,k=h[1]*i,l=h[2]*i,m=e.PolyK.Triangulate(c),n=d.length/6,o=0;for(o=0;o<m.length;o+=3)f.push(m[o]+n),f.push(m[o]+n),f.push(m[o+1]+n),f.push(m[o+2]+n),f.push(m[o+2]+n);for(o=0;g>o;o++)d.push(c[2*o],c[2*o+1],j,k,l,i)}},e.WebGLGraphics.graphicsDataPool=[],e.WebGLGraphicsData=function(a){this.gl=a,this.color=[0,0,0],this.points=[],this.indices=[],this.lastIndex=0,this.buffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},e.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[],this.lastIndex=0},e.WebGLGraphicsData.prototype.upload=function(){var a=this.gl;this.glPoints=new Float32Array(this.points),a.bindBuffer(a.ARRAY_BUFFER,this.buffer),a.bufferData(a.ARRAY_BUFFER,this.glPoints,a.STATIC_DRAW),this.glIndicies=new Uint16Array(this.indices),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.glIndicies,a.STATIC_DRAW),this.dirty=!1},e.glContexts=[],e.WebGLRenderer=function(a,b,c,d,f,g){e.defaultRenderer||(e.sayHello("webGL"),e.defaultRenderer=this),this.type=e.WEBGL_RENDERER,this.transparent=!!d,this.preserveDrawingBuffer=g,this.width=a||800,this.height=b||600,this.view=c||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.contextLost=this.handleContextLost.bind(this),this.contextRestoredLost=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.contextLost,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredLost,!1),this.options={alpha:this.transparent,antialias:!!f,premultipliedAlpha:!!d,stencil:!0,preserveDrawingBuffer:g};var h=null;if(["experimental-webgl","webgl"].forEach(function(a){try{h=h||this.view.getContext(a,this.options)}catch(b){}},this),!h)throw new Error("This browser does not support webGL. Try using the canvas renderer"+this);this.gl=h,this.glContextId=h.id=e.WebGLRenderer.glContextId++,e.glContexts[this.glContextId]=h,e.blendModesWebGL||(e.blendModesWebGL=[],e.blendModesWebGL[e.blendModes.NORMAL]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.ADD]=[h.SRC_ALPHA,h.DST_ALPHA],e.blendModesWebGL[e.blendModes.MULTIPLY]=[h.DST_COLOR,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SCREEN]=[h.SRC_ALPHA,h.ONE],e.blendModesWebGL[e.blendModes.OVERLAY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DARKEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LIGHTEN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_DODGE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR_BURN]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HARD_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SOFT_LIGHT]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.DIFFERENCE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.EXCLUSION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.HUE]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.SATURATION]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.COLOR]=[h.ONE,h.ONE_MINUS_SRC_ALPHA],e.blendModesWebGL[e.blendModes.LUMINOSITY]=[h.ONE,h.ONE_MINUS_SRC_ALPHA]),this.projection=new e.Point,this.projection.x=this.width/2,this.projection.y=-this.height/2,this.offset=new e.Point(0,0),this.resize(this.width,this.height),this.contextLost=!1,this.shaderManager=new e.WebGLShaderManager(h),this.spriteBatch=new e.WebGLSpriteBatch(h),this.maskManager=new e.WebGLMaskManager(h),this.filterManager=new e.WebGLFilterManager(h,this.transparent),this.stencilManager=new e.WebGLStencilManager(h),this.blendModeManager=new e.WebGLBlendModeManager(h),this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,this.renderSession.renderer=this,h.useProgram(this.shaderManager.defaultShader.program),h.disable(h.DEPTH_TEST),h.disable(h.CULL_FACE),h.enable(h.BLEND),h.colorMask(!0,!0,!0,this.transparent)},e.WebGLRenderer.prototype.constructor=e.WebGLRenderer,e.WebGLRenderer.prototype.render=function(a){if(!this.contextLost){this.__stage!==a&&(a.interactive&&a.interactionManager.removeEvents(),this.__stage=a),e.WebGLRenderer.updateTextures(),a.updateTransform(),a._interactive&&(a._interactiveEventsAdded||(a._interactiveEventsAdded=!0,a.interactionManager.setTarget(this)));var b=this.gl;b.viewport(0,0,this.width,this.height),b.bindFramebuffer(b.FRAMEBUFFER,null),this.transparent?b.clearColor(0,0,0,0):b.clearColor(a.backgroundColorSplit[0],a.backgroundColorSplit[1],a.backgroundColorSplit[2],1),b.clear(b.COLOR_BUFFER_BIT),this.renderDisplayObject(a,this.projection),a.interactive?a._interactiveEventsAdded||(a._interactiveEventsAdded=!0,a.interactionManager.setTarget(this)):a._interactiveEventsAdded&&(a._interactiveEventsAdded=!1,a.interactionManager.setTarget(this))}},e.WebGLRenderer.prototype.renderDisplayObject=function(a,b,c){this.renderSession.blendModeManager.setBlendMode(e.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.currentBlendMode=9999,this.renderSession.projection=b,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,c),a._renderWebGL(this.renderSession),this.spriteBatch.end()},e.WebGLRenderer.updateTextures=function(){var a=0;for(a=0;a<e.Texture.frameUpdates.length;a++)e.WebGLRenderer.updateTextureFrame(e.Texture.frameUpdates[a]);for(a=0;a<e.texturesToDestroy.length;a++)e.WebGLRenderer.destroyTexture(e.texturesToDestroy[a]);e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,e.Texture.frameUpdates.length=0},e.WebGLRenderer.destroyTexture=function(a){for(var b=a._glTextures.length-1;b>=0;b--){var c=a._glTextures[b],d=e.glContexts[b];d&&c&&d.deleteTexture(c)}a._glTextures.length=0},e.WebGLRenderer.updateTextureFrame=function(a){a._updateWebGLuvs()},e.WebGLRenderer.prototype.resize=function(a,b){this.width=a,this.height=b,this.view.width=a,this.view.height=b,this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2,this.projection.y=-this.height/2},e.createWebGLTexture=function(a,b){return a.hasLoaded&&(a._glTextures[b.id]=b.createTexture(),b.bindTexture(b.TEXTURE_2D,a._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultipliedAlpha),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a.scaleMode===e.scaleModes.LINEAR?b.LINEAR:b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===e.scaleModes.LINEAR?b.LINEAR:b.NEAREST),a._powerOf2?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),b.bindTexture(b.TEXTURE_2D,null),a._dirty[b.id]=!1),a._glTextures[b.id]},e.updateWebGLTexture=function(a,b){a._glTextures[b.id]&&(b.bindTexture(b.TEXTURE_2D,a._glTextures[b.id]),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultipliedAlpha),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a.source),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,a.scaleMode===e.scaleModes.LINEAR?b.LINEAR:b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,a.scaleMode===e.scaleModes.LINEAR?b.LINEAR:b.NEAREST),a._powerOf2?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT)):(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE)),a._dirty[b.id]=!1)},e.WebGLRenderer.prototype.handleContextLost=function(a){a.preventDefault(),this.contextLost=!0},e.WebGLRenderer.prototype.handleContextRestored=function(){try{this.gl=this.view.getContext("experimental-webgl",this.options)}catch(a){try{this.gl=this.view.getContext("webgl",this.options)}catch(b){throw new Error(" This browser does not support webGL. Try using the canvas renderer"+this)}}var c=this.gl;c.id=e.WebGLRenderer.glContextId++,this.shaderManager.setContext(c),this.spriteBatch.setContext(c),this.primitiveBatch.setContext(c),this.maskManager.setContext(c),this.filterManager.setContext(c),this.renderSession.gl=this.gl,c.disable(c.DEPTH_TEST),c.disable(c.CULL_FACE),c.enable(c.BLEND),c.colorMask(!0,!0,!0,this.transparent),this.gl.viewport(0,0,this.width,this.height);for(var d in e.TextureCache){var f=e.TextureCache[d].baseTexture;f._glTextures=[]}this.contextLost=!1},e.WebGLRenderer.prototype.destroy=function(){this.view.removeEventListener("webglcontextlost",this.contextLost),this.view.removeEventListener("webglcontextrestored",this.contextRestoredLost),e.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.primitiveBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null},e.WebGLRenderer.glContextId=0,e.WebGLBlendModeManager=function(a){this.gl=a,this.currentBlendMode=99999},e.WebGLBlendModeManager.prototype.setBlendMode=function(a){if(this.currentBlendMode===a)return!1;this.currentBlendMode=a;var b=e.blendModesWebGL[this.currentBlendMode];return this.gl.blendFunc(b[0],b[1]),!0},e.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},e.WebGLMaskManager=function(a){this.maskStack=[],this.maskPosition=0,this.setContext(a),this.reverse=!1,this.count=0},e.WebGLMaskManager.prototype.setContext=function(a){this.gl=a},e.WebGLMaskManager.prototype.pushMask=function(a,b){var c=b.gl;a.dirty&&e.WebGLGraphics.updateGraphics(a,c),a._webGL[c.id].data.length&&b.stencilManager.pushStencil(a,a._webGL[c.id].data[0],b)},e.WebGLMaskManager.prototype.popMask=function(a,b){var c=this.gl;b.stencilManager.popStencil(a,a._webGL[c.id].data[0],b)},e.WebGLMaskManager.prototype.destroy=function(){this.maskStack=null,this.gl=null},e.WebGLStencilManager=function(a){this.stencilStack=[],this.setContext(a),this.reverse=!0,this.count=0},e.WebGLStencilManager.prototype.setContext=function(a){this.gl=a},e.WebGLStencilManager.prototype.pushStencil=function(a,b,c){var d=this.gl;this.bindGraphics(a,b,c),0===this.stencilStack.length&&(d.enable(d.STENCIL_TEST),d.clear(d.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(b);var e=this.count;d.colorMask(!1,!1,!1,!1),d.stencilFunc(d.ALWAYS,0,255),d.stencilOp(d.KEEP,d.KEEP,d.INVERT),1===b.mode?(d.drawElements(d.TRIANGLE_FAN,b.indices.length-4,d.UNSIGNED_SHORT,0),this.reverse?(d.stencilFunc(d.EQUAL,255-e,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)):(d.stencilFunc(d.EQUAL,e,255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)),d.drawElements(d.TRIANGLE_FAN,4,d.UNSIGNED_SHORT,2*(b.indices.length-4)),this.reverse?d.stencilFunc(d.EQUAL,255-(e+1),255):d.stencilFunc(d.EQUAL,e+1,255),this.reverse=!this.reverse):(this.reverse?(d.stencilFunc(d.EQUAL,e,255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)):(d.stencilFunc(d.EQUAL,255-e,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)),d.drawElements(d.TRIANGLE_STRIP,b.indices.length,d.UNSIGNED_SHORT,0),this.reverse?d.stencilFunc(d.EQUAL,e+1,255):d.stencilFunc(d.EQUAL,255-(e+1),255)),d.colorMask(!0,!0,!0,!0),d.stencilOp(d.KEEP,d.KEEP,d.KEEP),this.count++},e.WebGLStencilManager.prototype.bindGraphics=function(a,b,c){this._currentGraphics=a;var d,f=this.gl,g=c.projection,h=c.offset;1===b.mode?(d=c.shaderManager.complexPrimativeShader,c.shaderManager.setShader(d),f.uniformMatrix3fv(d.translationMatrix,!1,a.worldTransform.toArray(!0)),f.uniform2f(d.projectionVector,g.x,-g.y),f.uniform2f(d.offsetVector,-h.x,-h.y),f.uniform3fv(d.tintColor,e.hex2rgb(a.tint)),f.uniform3fv(d.color,b.color),f.uniform1f(d.alpha,a.worldAlpha*b.alpha),f.bindBuffer(f.ARRAY_BUFFER,b.buffer),f.vertexAttribPointer(d.aVertexPosition,2,f.FLOAT,!1,8,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,b.indexBuffer)):(d=c.shaderManager.primitiveShader,c.shaderManager.setShader(d),f.uniformMatrix3fv(d.translationMatrix,!1,a.worldTransform.toArray(!0)),f.uniform2f(d.projectionVector,g.x,-g.y),f.uniform2f(d.offsetVector,-h.x,-h.y),f.uniform3fv(d.tintColor,e.hex2rgb(a.tint)),f.uniform1f(d.alpha,a.worldAlpha),f.bindBuffer(f.ARRAY_BUFFER,b.buffer),f.vertexAttribPointer(d.aVertexPosition,2,f.FLOAT,!1,24,0),f.vertexAttribPointer(d.colorAttribute,4,f.FLOAT,!1,24,8),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,b.indexBuffer))},e.WebGLStencilManager.prototype.popStencil=function(a,b,c){var d=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)d.disable(d.STENCIL_TEST);else{var e=this.count;this.bindGraphics(a,b,c),d.colorMask(!1,!1,!1,!1),1===b.mode?(this.reverse=!this.reverse,this.reverse?(d.stencilFunc(d.EQUAL,255-(e+1),255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)):(d.stencilFunc(d.EQUAL,e+1,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)),d.drawElements(d.TRIANGLE_FAN,4,d.UNSIGNED_SHORT,2*(b.indices.length-4)),d.stencilFunc(d.ALWAYS,0,255),d.stencilOp(d.KEEP,d.KEEP,d.INVERT),d.drawElements(d.TRIANGLE_FAN,b.indices.length-4,d.UNSIGNED_SHORT,0),this.reverse?d.stencilFunc(d.EQUAL,e,255):d.stencilFunc(d.EQUAL,255-e,255)):(this.reverse?(d.stencilFunc(d.EQUAL,e+1,255),d.stencilOp(d.KEEP,d.KEEP,d.DECR)):(d.stencilFunc(d.EQUAL,255-(e+1),255),d.stencilOp(d.KEEP,d.KEEP,d.INCR)),d.drawElements(d.TRIANGLE_STRIP,b.indices.length,d.UNSIGNED_SHORT,0),this.reverse?d.stencilFunc(d.EQUAL,e,255):d.stencilFunc(d.EQUAL,255-e,255)),d.colorMask(!0,!0,!0,!0),d.stencilOp(d.KEEP,d.KEEP,d.KEEP)}},e.WebGLStencilManager.prototype.destroy=function(){this.maskStack=null,this.gl=null},e.WebGLShaderManager=function(a){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[],this.shaderMap=[];for(var b=0;b<this.maxAttibs;b++)this.attribState[b]=!1;this.setContext(a)},e.WebGLShaderManager.prototype.setContext=function(a){this.gl=a,this.primitiveShader=new e.PrimitiveShader(a),this.complexPrimativeShader=new e.ComplexPrimitiveShader(a),this.defaultShader=new e.PixiShader(a),this.fastShader=new e.PixiFastShader(a),this.stripShader=new e.StripShader(a),this.setShader(this.defaultShader)},e.WebGLShaderManager.prototype.setAttribs=function(a){var b;for(b=0;b<this.tempAttribState.length;b++)this.tempAttribState[b]=!1;for(b=0;b<a.length;b++){var c=a[b];this.tempAttribState[c]=!0}var d=this.gl;for(b=0;b<this.attribState.length;b++)this.attribState[b]!==this.tempAttribState[b]&&(this.attribState[b]=this.tempAttribState[b],this.tempAttribState[b]?d.enableVertexAttribArray(b):d.disableVertexAttribArray(b))},e.WebGLShaderManager.prototype.setShader=function(a){return this._currentId===a._UID?!1:(this._currentId=a._UID,this.currentShader=a,this.gl.useProgram(a.program),this.setAttribs(a.attributes),!0)},e.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},e.WebGLSpriteBatch=function(a){this.vertSize=6,this.size=2e3;var b=4*this.size*this.vertSize,c=6*this.size;this.vertices=new Float32Array(b),this.indices=new Uint16Array(c),this.lastIndexCount=0;for(var d=0,e=0;c>d;d+=6,e+=4)this.indices[d+0]=e+0,this.indices[d+1]=e+1,this.indices[d+2]=e+2,this.indices[d+3]=e+0,this.indices[d+4]=e+2,this.indices[d+5]=e+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.setContext(a),this.dirty=!0,this.textures=[],this.blendModes=[]},e.WebGLSpriteBatch.prototype.setContext=function(a){this.gl=a,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW),this.currentBlendMode=99999},e.WebGLSpriteBatch.prototype.begin=function(a){this.renderSession=a,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},e.WebGLSpriteBatch.prototype.end=function(){this.flush()},e.WebGLSpriteBatch.prototype.render=function(a){var b=a.texture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=b.baseTexture);var c=b._uvs;if(c){var d,e,f,g,h=a.worldAlpha,i=a.tint,j=this.vertices,k=a.anchor.x,l=a.anchor.y;if(b.trim){var m=b.trim;e=m.x-k*m.width,d=e+b.crop.width,g=m.y-l*m.height,f=g+b.crop.height}else d=b.frame.width*(1-k),e=b.frame.width*-k,f=b.frame.height*(1-l),g=b.frame.height*-l;var n=4*this.currentBatchSize*this.vertSize,o=a.worldTransform,p=o.a,q=o.c,r=o.b,s=o.d,t=o.tx,u=o.ty;j[n++]=p*e+r*g+t,j[n++]=s*g+q*e+u,j[n++]=c.x0,j[n++]=c.y0,j[n++]=h,j[n++]=i,j[n++]=p*d+r*g+t,j[n++]=s*g+q*d+u,j[n++]=c.x1,j[n++]=c.y1,j[n++]=h,j[n++]=i,j[n++]=p*d+r*f+t,j[n++]=s*f+q*d+u,j[n++]=c.x2,j[n++]=c.y2,j[n++]=h,j[n++]=i,j[n++]=p*e+r*f+t,j[n++]=s*f+q*e+u,j[n++]=c.x3,j[n++]=c.y3,j[n++]=h,j[n++]=i,this.textures[this.currentBatchSize]=a.texture.baseTexture,this.blendModes[this.currentBatchSize]=a.blendMode,this.currentBatchSize++}},e.WebGLSpriteBatch.prototype.renderTilingSprite=function(a){var b=a.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=b.baseTexture),a._uvs||(a._uvs=new e.TextureUvs);var c=a._uvs;a.tilePosition.x%=b.baseTexture.width*a.tileScaleOffset.x,a.tilePosition.y%=b.baseTexture.height*a.tileScaleOffset.y;var d=a.tilePosition.x/(b.baseTexture.width*a.tileScaleOffset.x),f=a.tilePosition.y/(b.baseTexture.height*a.tileScaleOffset.y),g=a.width/b.baseTexture.width/(a.tileScale.x*a.tileScaleOffset.x),h=a.height/b.baseTexture.height/(a.tileScale.y*a.tileScaleOffset.y);c.x0=0-d,c.y0=0-f,c.x1=1*g-d,c.y1=0-f,c.x2=1*g-d,c.y2=1*h-f,c.x3=0-d,c.y3=1*h-f;var i=a.worldAlpha,j=a.tint,k=this.vertices,l=a.width,m=a.height,n=a.anchor.x,o=a.anchor.y,p=l*(1-n),q=l*-n,r=m*(1-o),s=m*-o,t=4*this.currentBatchSize*this.vertSize,u=a.worldTransform,v=u.a,w=u.c,x=u.b,y=u.d,z=u.tx,A=u.ty;k[t++]=v*q+x*s+z,k[t++]=y*s+w*q+A,k[t++]=c.x0,k[t++]=c.y0,k[t++]=i,k[t++]=j,k[t++]=v*p+x*s+z,k[t++]=y*s+w*p+A,k[t++]=c.x1,k[t++]=c.y1,k[t++]=i,k[t++]=j,k[t++]=v*p+x*r+z,k[t++]=y*r+w*p+A,k[t++]=c.x2,k[t++]=c.y2,k[t++]=i,k[t++]=j,k[t++]=v*q+x*r+z,k[t++]=y*r+w*q+A,k[t++]=c.x3,k[t++]=c.y3,k[t++]=i,k[t++]=j,this.textures[this.currentBatchSize]=b.baseTexture,this.blendModes[this.currentBatchSize]=a.blendMode,this.currentBatchSize++},e.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var a=this.gl;if(this.renderSession.shaderManager.setShader(this.renderSession.shaderManager.defaultShader),this.dirty){this.dirty=!1,a.activeTexture(a.TEXTURE0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.renderSession.projection;a.uniform2f(this.shader.projectionVector,b.x,b.y);var c=4*this.vertSize;a.vertexAttribPointer(this.shader.aVertexPosition,2,a.FLOAT,!1,c,0),a.vertexAttribPointer(this.shader.aTextureCoord,2,a.FLOAT,!1,c,8),a.vertexAttribPointer(this.shader.colorAttribute,2,a.FLOAT,!1,c,16)}if(this.currentBatchSize>.5*this.size)a.bufferSubData(a.ARRAY_BUFFER,0,this.vertices);else{var d=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);a.bufferSubData(a.ARRAY_BUFFER,0,d)}for(var e,f,g=0,h=0,i=null,j=this.renderSession.blendModeManager.currentBlendMode,k=0,l=this.currentBatchSize;l>k;k++)e=this.textures[k],f=this.blendModes[k],(i!==e||j!==f)&&(this.renderBatch(i,g,h),h=k,g=0,i=e,j=f,this.renderSession.blendModeManager.setBlendMode(j)),g++;this.renderBatch(i,g,h),this.currentBatchSize=0}},e.WebGLSpriteBatch.prototype.renderBatch=function(a,b,c){if(0!==b){var d=this.gl;d.bindTexture(d.TEXTURE_2D,a._glTextures[d.id]||e.createWebGLTexture(a,d)),a._dirty[d.id]&&e.updateWebGLTexture(this.currentBaseTexture,d),d.drawElements(d.TRIANGLES,6*b,d.UNSIGNED_SHORT,6*c*2),this.renderSession.drawCount++}},e.WebGLSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},e.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},e.WebGLFastSpriteBatch=function(a){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var b=4*this.size*this.vertSize,c=6*this.maxSize;this.vertices=new Float32Array(b),this.indices=new Uint16Array(c),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var d=0,e=0;c>d;d+=6,e+=4)this.indices[d+0]=e+0,this.indices[d+1]=e+1,this.indices[d+2]=e+2,this.indices[d+3]=e+0,this.indices[d+4]=e+2,this.indices[d+5]=e+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(a)},e.WebGLFastSpriteBatch.prototype.setContext=function(a){this.gl=a,this.vertexBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.DYNAMIC_DRAW)},e.WebGLFastSpriteBatch.prototype.begin=function(a,b){this.renderSession=b,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=a.worldTransform.toArray(!0),this.start()},e.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.render=function(a){var b=a.children,c=b[0];if(c.texture._uvs){this.currentBaseTexture=c.texture.baseTexture,c.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(c.blendMode));for(var d=0,e=b.length;e>d;d++)this.renderSprite(b[d]);this.flush()}},e.WebGLFastSpriteBatch.prototype.renderSprite=function(a){if(a.visible&&(a.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=a.texture.baseTexture,a.texture._uvs))){var b,c,d,e,f,g,h,i,j=this.vertices;if(b=a.texture._uvs,c=a.texture.frame.width,d=a.texture.frame.height,a.texture.trim){var k=a.texture.trim;f=k.x-a.anchor.x*k.width,e=f+a.texture.crop.width,h=k.y-a.anchor.y*k.height,g=h+a.texture.crop.height}else e=a.texture.frame.width*(1-a.anchor.x),f=a.texture.frame.width*-a.anchor.x,g=a.texture.frame.height*(1-a.anchor.y),h=a.texture.frame.height*-a.anchor.y;i=4*this.currentBatchSize*this.vertSize,j[i++]=f,j[i++]=h,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b.x0,j[i++]=b.y1,j[i++]=a.alpha,j[i++]=e,j[i++]=h,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b.x1,j[i++]=b.y1,j[i++]=a.alpha,j[i++]=e,j[i++]=g,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b.x2,j[i++]=b.y2,j[i++]=a.alpha,j[i++]=f,j[i++]=g,j[i++]=a.position.x,j[i++]=a.position.y,j[i++]=a.scale.x,j[i++]=a.scale.y,j[i++]=a.rotation,j[i++]=b.x3,j[i++]=b.y3,j[i++]=a.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},e.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var a=this.gl;if(this.currentBaseTexture._glTextures[a.id]||e.createWebGLTexture(this.currentBaseTexture,a),a.bindTexture(a.TEXTURE_2D,this.currentBaseTexture._glTextures[a.id]),this.currentBatchSize>.5*this.size)a.bufferSubData(a.ARRAY_BUFFER,0,this.vertices);else{var b=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);a.bufferSubData(a.ARRAY_BUFFER,0,b)}a.drawElements(a.TRIANGLES,6*this.currentBatchSize,a.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},e.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},e.WebGLFastSpriteBatch.prototype.start=function(){var a=this.gl;a.activeTexture(a.TEXTURE0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var b=this.renderSession.projection;
a.uniform2f(this.shader.projectionVector,b.x,b.y),a.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var c=4*this.vertSize;a.vertexAttribPointer(this.shader.aVertexPosition,2,a.FLOAT,!1,c,0),a.vertexAttribPointer(this.shader.aPositionCoord,2,a.FLOAT,!1,c,8),a.vertexAttribPointer(this.shader.aScale,2,a.FLOAT,!1,c,16),a.vertexAttribPointer(this.shader.aRotation,1,a.FLOAT,!1,c,24),a.vertexAttribPointer(this.shader.aTextureCoord,2,a.FLOAT,!1,c,28),a.vertexAttribPointer(this.shader.colorAttribute,1,a.FLOAT,!1,c,36)},e.WebGLFilterManager=function(a,b){this.transparent=b,this.filterStack=[],this.offsetX=0,this.offsetY=0,this.setContext(a)},e.WebGLFilterManager.prototype.setContext=function(a){this.gl=a,this.texturePool=[],this.initShaderBuffers()},e.WebGLFilterManager.prototype.begin=function(a,b){this.renderSession=a,this.defaultShader=a.shaderManager.defaultShader;var c=this.renderSession.projection;this.width=2*c.x,this.height=2*-c.y,this.buffer=b},e.WebGLFilterManager.prototype.pushFilter=function(a){var b=this.gl,c=this.renderSession.projection,d=this.renderSession.offset;a._filterArea=a.target.filterArea||a.target.getBounds(),this.filterStack.push(a);var f=a.filterPasses[0];this.offsetX+=a._filterArea.x,this.offsetY+=a._filterArea.y;var g=this.texturePool.pop();g?g.resize(this.width,this.height):g=new e.FilterTexture(this.gl,this.width,this.height),b.bindTexture(b.TEXTURE_2D,g.texture);var h=a._filterArea,i=f.padding;h.x-=i,h.y-=i,h.width+=2*i,h.height+=2*i,h.x<0&&(h.x=0),h.width>this.width&&(h.width=this.width),h.y<0&&(h.y=0),h.height>this.height&&(h.height=this.height),b.bindFramebuffer(b.FRAMEBUFFER,g.frameBuffer),b.viewport(0,0,h.width,h.height),c.x=h.width/2,c.y=-h.height/2,d.x=-h.x,d.y=-h.y,this.renderSession.shaderManager.setShader(this.defaultShader),b.uniform2f(this.defaultShader.projectionVector,h.width/2,-h.height/2),b.uniform2f(this.defaultShader.offsetVector,-h.x,-h.y),b.colorMask(!0,!0,!0,!0),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),a._glFilterTexture=g},e.WebGLFilterManager.prototype.popFilter=function(){var a=this.gl,b=this.filterStack.pop(),c=b._filterArea,d=b._glFilterTexture,f=this.renderSession.projection,g=this.renderSession.offset;if(b.filterPasses.length>1){a.viewport(0,0,c.width,c.height),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=c.height,this.vertexArray[2]=c.width,this.vertexArray[3]=c.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=c.width,this.vertexArray[7]=0,a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexArray),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=c.width/this.width,this.uvArray[5]=c.height/this.height,this.uvArray[6]=c.width/this.width,this.uvArray[7]=c.height/this.height,a.bufferSubData(a.ARRAY_BUFFER,0,this.uvArray);var h=d,i=this.texturePool.pop();i||(i=new e.FilterTexture(this.gl,this.width,this.height)),i.resize(this.width,this.height),a.bindFramebuffer(a.FRAMEBUFFER,i.frameBuffer),a.clear(a.COLOR_BUFFER_BIT),a.disable(a.BLEND);for(var j=0;j<b.filterPasses.length-1;j++){var k=b.filterPasses[j];a.bindFramebuffer(a.FRAMEBUFFER,i.frameBuffer),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,h.texture),this.applyFilterPass(k,c,c.width,c.height);var l=h;h=i,i=l}a.enable(a.BLEND),d=h,this.texturePool.push(i)}var m=b.filterPasses[b.filterPasses.length-1];this.offsetX-=c.x,this.offsetY-=c.y;var n=this.width,o=this.height,p=0,q=0,r=this.buffer;if(0===this.filterStack.length)a.colorMask(!0,!0,!0,!0);else{var s=this.filterStack[this.filterStack.length-1];c=s._filterArea,n=c.width,o=c.height,p=c.x,q=c.y,r=s._glFilterTexture.frameBuffer}f.x=n/2,f.y=-o/2,g.x=p,g.y=q,c=b._filterArea;var t=c.x-p,u=c.y-q;a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=t,this.vertexArray[1]=u+c.height,this.vertexArray[2]=t+c.width,this.vertexArray[3]=u+c.height,this.vertexArray[4]=t,this.vertexArray[5]=u,this.vertexArray[6]=t+c.width,this.vertexArray[7]=u,a.bufferSubData(a.ARRAY_BUFFER,0,this.vertexArray),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=c.width/this.width,this.uvArray[5]=c.height/this.height,this.uvArray[6]=c.width/this.width,this.uvArray[7]=c.height/this.height,a.bufferSubData(a.ARRAY_BUFFER,0,this.uvArray),a.viewport(0,0,n,o),a.bindFramebuffer(a.FRAMEBUFFER,r),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,d.texture),this.applyFilterPass(m,c,n,o),this.renderSession.shaderManager.setShader(this.defaultShader),a.uniform2f(this.defaultShader.projectionVector,n/2,-o/2),a.uniform2f(this.defaultShader.offsetVector,-p,-q),this.texturePool.push(d),b._glFilterTexture=null},e.WebGLFilterManager.prototype.applyFilterPass=function(a,b,c,d){var f=this.gl,g=a.shaders[f.id];g||(g=new e.PixiShader(f),g.fragmentSrc=a.fragmentSrc,g.uniforms=a.uniforms,g.init(),a.shaders[f.id]=g),this.renderSession.shaderManager.setShader(g),f.uniform2f(g.projectionVector,c/2,-d/2),f.uniform2f(g.offsetVector,0,0),a.uniforms.dimensions&&(a.uniforms.dimensions.value[0]=this.width,a.uniforms.dimensions.value[1]=this.height,a.uniforms.dimensions.value[2]=this.vertexArray[0],a.uniforms.dimensions.value[3]=this.vertexArray[5]),g.syncUniforms(),f.bindBuffer(f.ARRAY_BUFFER,this.vertexBuffer),f.vertexAttribPointer(g.aVertexPosition,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.uvBuffer),f.vertexAttribPointer(g.aTextureCoord,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ARRAY_BUFFER,this.colorBuffer),f.vertexAttribPointer(g.colorAttribute,2,f.FLOAT,!1,0,0),f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.indexBuffer),f.drawElements(f.TRIANGLES,6,f.UNSIGNED_SHORT,0),this.renderSession.drawCount++},e.WebGLFilterManager.prototype.initShaderBuffers=function(){var a=this.gl;this.vertexBuffer=a.createBuffer(),this.uvBuffer=a.createBuffer(),this.colorBuffer=a.createBuffer(),this.indexBuffer=a.createBuffer(),this.vertexArray=new Float32Array([0,0,1,0,0,1,1,1]),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,this.vertexArray,a.STATIC_DRAW),this.uvArray=new Float32Array([0,0,1,0,0,1,1,1]),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),a.bufferData(a.ARRAY_BUFFER,this.uvArray,a.STATIC_DRAW),this.colorArray=new Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),a.bindBuffer(a.ARRAY_BUFFER,this.colorBuffer),a.bufferData(a.ARRAY_BUFFER,this.colorArray,a.STATIC_DRAW),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),a.STATIC_DRAW)},e.WebGLFilterManager.prototype.destroy=function(){var a=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var b=0;b<this.texturePool.length;b++)this.texturePool[b].destroy();this.texturePool=null,a.deleteBuffer(this.vertexBuffer),a.deleteBuffer(this.uvBuffer),a.deleteBuffer(this.colorBuffer),a.deleteBuffer(this.indexBuffer)},e.FilterTexture=function(a,b,c,d){this.gl=a,this.frameBuffer=a.createFramebuffer(),this.texture=a.createTexture(),d=d||e.scaleModes.DEFAULT,a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,d===e.scaleModes.LINEAR?a.LINEAR:a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,d===e.scaleModes.LINEAR?a.LINEAR:a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer),a.bindFramebuffer(a.FRAMEBUFFER,this.frameBuffer),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture,0),this.renderBuffer=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,this.renderBuffer),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this.renderBuffer),this.resize(b,c)},e.FilterTexture.prototype.clear=function(){var a=this.gl;a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)},e.FilterTexture.prototype.resize=function(a,b){if(this.width!==a||this.height!==b){this.width=a,this.height=b;var c=this.gl;c.bindTexture(c.TEXTURE_2D,this.texture),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,a,b,0,c.RGBA,c.UNSIGNED_BYTE,null),c.bindRenderbuffer(c.RENDERBUFFER,this.renderBuffer),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,a,b)}},e.FilterTexture.prototype.destroy=function(){var a=this.gl;a.deleteFramebuffer(this.frameBuffer),a.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},e.CanvasMaskManager=function(){},e.CanvasMaskManager.prototype.pushMask=function(a,b){b.save();var c=a.alpha,d=a.worldTransform;b.setTransform(d.a,d.c,d.b,d.d,d.tx,d.ty),e.CanvasGraphics.renderGraphicsMask(a,b),b.clip(),a.worldAlpha=c},e.CanvasMaskManager.prototype.popMask=function(a){a.restore()},e.CanvasTinter=function(){},e.CanvasTinter.getTintedTexture=function(a,b){var c=a.texture;b=e.CanvasTinter.roundColor(b);var d="#"+("00000"+(0|b).toString(16)).substr(-6);if(c.tintCache=c.tintCache||{},c.tintCache[d])return c.tintCache[d];var f=e.CanvasTinter.canvas||document.createElement("canvas");if(e.CanvasTinter.tintMethod(c,b,f),e.CanvasTinter.convertTintToImage){var g=new Image;g.src=f.toDataURL(),c.tintCache[d]=g}else c.tintCache[d]=f,e.CanvasTinter.canvas=null;return f},e.CanvasTinter.tintWithMultiply=function(a,b,c){var d=c.getContext("2d"),e=a.frame;c.width=e.width,c.height=e.height,d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,e.width,e.height),d.globalCompositeOperation="multiply",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height),d.globalCompositeOperation="destination-atop",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.CanvasTinter.tintWithOverlay=function(a,b,c){var d=c.getContext("2d"),e=a.frame;c.width=e.width,c.height=e.height,d.globalCompositeOperation="copy",d.fillStyle="#"+("00000"+(0|b).toString(16)).substr(-6),d.fillRect(0,0,e.width,e.height),d.globalCompositeOperation="destination-atop",d.drawImage(a.baseTexture.source,e.x,e.y,e.width,e.height,0,0,e.width,e.height)},e.CanvasTinter.tintWithPerPixel=function(a,b,c){var d=c.getContext("2d"),f=a.frame;c.width=f.width,c.height=f.height,d.globalCompositeOperation="copy",d.drawImage(a.baseTexture.source,f.x,f.y,f.width,f.height,0,0,f.width,f.height);for(var g=e.hex2rgb(b),h=g[0],i=g[1],j=g[2],k=d.getImageData(0,0,f.width,f.height),l=k.data,m=0;m<l.length;m+=4)l[m+0]*=h,l[m+1]*=i,l[m+2]*=j;d.putImageData(k,0,0)},e.CanvasTinter.roundColor=function(a){var b=e.CanvasTinter.cacheStepsPerColorChannel,c=e.hex2rgb(a);return c[0]=Math.min(255,c[0]/b*b),c[1]=Math.min(255,c[1]/b*b),c[2]=Math.min(255,c[2]/b*b),e.rgb2hex(c)},e.CanvasTinter.cacheStepsPerColorChannel=8,e.CanvasTinter.convertTintToImage=!1,e.CanvasTinter.canUseMultiply=e.canUseNewCanvasBlendModes(),e.CanvasTinter.tintMethod=e.CanvasTinter.canUseMultiply?e.CanvasTinter.tintWithMultiply:e.CanvasTinter.tintWithPerPixel,e.CanvasRenderer=function(a,b,c,d){e.defaultRenderer||(e.sayHello("Canvas"),e.defaultRenderer=this),this.type=e.CANVAS_RENDERER,this.clearBeforeRender=!0,this.transparent=!!d,e.blendModesCanvas||(e.blendModesCanvas=[],e.canUseNewCanvasBlendModes()?(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="multiply",e.blendModesCanvas[e.blendModes.SCREEN]="screen",e.blendModesCanvas[e.blendModes.OVERLAY]="overlay",e.blendModesCanvas[e.blendModes.DARKEN]="darken",e.blendModesCanvas[e.blendModes.LIGHTEN]="lighten",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="color-dodge",e.blendModesCanvas[e.blendModes.COLOR_BURN]="color-burn",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="hard-light",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="soft-light",e.blendModesCanvas[e.blendModes.DIFFERENCE]="difference",e.blendModesCanvas[e.blendModes.EXCLUSION]="exclusion",e.blendModesCanvas[e.blendModes.HUE]="hue",e.blendModesCanvas[e.blendModes.SATURATION]="saturation",e.blendModesCanvas[e.blendModes.COLOR]="color",e.blendModesCanvas[e.blendModes.LUMINOSITY]="luminosity"):(e.blendModesCanvas[e.blendModes.NORMAL]="source-over",e.blendModesCanvas[e.blendModes.ADD]="lighter",e.blendModesCanvas[e.blendModes.MULTIPLY]="source-over",e.blendModesCanvas[e.blendModes.SCREEN]="source-over",e.blendModesCanvas[e.blendModes.OVERLAY]="source-over",e.blendModesCanvas[e.blendModes.DARKEN]="source-over",e.blendModesCanvas[e.blendModes.LIGHTEN]="source-over",e.blendModesCanvas[e.blendModes.COLOR_DODGE]="source-over",e.blendModesCanvas[e.blendModes.COLOR_BURN]="source-over",e.blendModesCanvas[e.blendModes.HARD_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.SOFT_LIGHT]="source-over",e.blendModesCanvas[e.blendModes.DIFFERENCE]="source-over",e.blendModesCanvas[e.blendModes.EXCLUSION]="source-over",e.blendModesCanvas[e.blendModes.HUE]="source-over",e.blendModesCanvas[e.blendModes.SATURATION]="source-over",e.blendModesCanvas[e.blendModes.COLOR]="source-over",e.blendModesCanvas[e.blendModes.LUMINOSITY]="source-over")),this.width=a||800,this.height=b||600,this.view=c||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width,this.view.height=this.height,this.count=0,this.maskManager=new e.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1},"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="oImageSmoothingEnabled")},e.CanvasRenderer.prototype.constructor=e.CanvasRenderer,e.CanvasRenderer.prototype.render=function(a){e.texturesToUpdate.length=0,e.texturesToDestroy.length=0,a.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),!this.transparent&&this.clearBeforeRender?(this.context.fillStyle=a.backgroundColorString,this.context.fillRect(0,0,this.width,this.height)):this.transparent&&this.clearBeforeRender&&this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(a),a.interactive&&(a._interactiveEventsAdded||(a._interactiveEventsAdded=!0,a.interactionManager.setTarget(this))),e.Texture.frameUpdates.length>0&&(e.Texture.frameUpdates.length=0)},e.CanvasRenderer.prototype.resize=function(a,b){this.width=a,this.height=b,this.view.width=a,this.view.height=b},e.CanvasRenderer.prototype.renderDisplayObject=function(a,b){this.renderSession.context=b||this.context,a._renderCanvas(this.renderSession)},e.CanvasRenderer.prototype.renderStripFlat=function(a){var b=this.context,c=a.verticies,d=c.length/2;this.count++,b.beginPath();for(var e=1;d-2>e;e++){var f=2*e,g=c[f],h=c[f+2],i=c[f+4],j=c[f+1],k=c[f+3],l=c[f+5];b.moveTo(g,j),b.lineTo(h,k),b.lineTo(i,l)}b.fillStyle="#FF0000",b.fill(),b.closePath()},e.CanvasRenderer.prototype.renderStrip=function(a){var b=this.context,c=a.verticies,d=a.uvs,e=c.length/2;this.count++;for(var f=1;e-2>f;f++){var g=2*f,h=c[g],i=c[g+2],j=c[g+4],k=c[g+1],l=c[g+3],m=c[g+5],n=d[g]*a.texture.width,o=d[g+2]*a.texture.width,p=d[g+4]*a.texture.width,q=d[g+1]*a.texture.height,r=d[g+3]*a.texture.height,s=d[g+5]*a.texture.height;b.save(),b.beginPath(),b.moveTo(h,k),b.lineTo(i,l),b.lineTo(j,m),b.closePath(),b.clip();var t=n*r+q*p+o*s-r*p-q*o-n*s,u=h*r+q*j+i*s-r*j-q*i-h*s,v=n*i+h*p+o*j-i*p-h*o-n*j,w=n*r*j+q*i*p+h*o*s-h*r*p-q*o*j-n*i*s,x=k*r+q*m+l*s-r*m-q*l-k*s,y=n*l+k*p+o*m-l*p-k*o-n*m,z=n*r*m+q*l*p+k*o*s-k*r*p-q*o*m-n*l*s;b.transform(u/t,x/t,v/t,y/t,w/t,z/t),b.drawImage(a.texture.baseTexture.source,0,0),b.restore()}},e.CanvasBuffer=function(a,b){this.width=a,this.height=b,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=a,this.canvas.height=b},e.CanvasBuffer.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.CanvasBuffer.prototype.resize=function(a,b){this.width=this.canvas.width=a,this.height=this.canvas.height=b},e.CanvasGraphics=function(){},e.CanvasGraphics.renderGraphics=function(a,b){for(var c=a.worldAlpha,d="",f=0;f<a.graphicsData.length;f++){var g=a.graphicsData[f],h=g.points;if(b.strokeStyle=d="#"+("00000"+(0|g.lineColor).toString(16)).substr(-6),b.lineWidth=g.lineWidth,g.type===e.Graphics.POLY){b.beginPath(),b.moveTo(h[0],h[1]);for(var i=1;i<h.length/2;i++)b.lineTo(h[2*i],h[2*i+1]);h[0]===h[h.length-2]&&h[1]===h[h.length-1]&&b.closePath(),g.fill&&(b.globalAlpha=g.fillAlpha*c,b.fillStyle=d="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill()),g.lineWidth&&(b.globalAlpha=g.lineAlpha*c,b.stroke())}else if(g.type===e.Graphics.RECT)(g.fillColor||0===g.fillColor)&&(b.globalAlpha=g.fillAlpha*c,b.fillStyle=d="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fillRect(h[0],h[1],h[2],h[3])),g.lineWidth&&(b.globalAlpha=g.lineAlpha*c,b.strokeRect(h[0],h[1],h[2],h[3]));else if(g.type===e.Graphics.CIRC)b.beginPath(),b.arc(h[0],h[1],h[2],0,2*Math.PI),b.closePath(),g.fill&&(b.globalAlpha=g.fillAlpha*c,b.fillStyle=d="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill()),g.lineWidth&&(b.globalAlpha=g.lineAlpha*c,b.stroke());else if(g.type===e.Graphics.ELIP){var j=g.points,k=2*j[2],l=2*j[3],m=j[0]-k/2,n=j[1]-l/2;b.beginPath();var o=.5522848,p=k/2*o,q=l/2*o,r=m+k,s=n+l,t=m+k/2,u=n+l/2;b.moveTo(m,u),b.bezierCurveTo(m,u-q,t-p,n,t,n),b.bezierCurveTo(t+p,n,r,u-q,r,u),b.bezierCurveTo(r,u+q,t+p,s,t,s),b.bezierCurveTo(t-p,s,m,u+q,m,u),b.closePath(),g.fill&&(b.globalAlpha=g.fillAlpha*c,b.fillStyle=d="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill()),g.lineWidth&&(b.globalAlpha=g.lineAlpha*c,b.stroke())}else if(g.type===e.Graphics.RREC){var v=h[0],w=h[1],x=h[2],y=h[3],z=h[4],A=Math.min(x,y)/2|0;z=z>A?A:z,b.beginPath(),b.moveTo(v,w+z),b.lineTo(v,w+y-z),b.quadraticCurveTo(v,w+y,v+z,w+y),b.lineTo(v+x-z,w+y),b.quadraticCurveTo(v+x,w+y,v+x,w+y-z),b.lineTo(v+x,w+z),b.quadraticCurveTo(v+x,w,v+x-z,w),b.lineTo(v+z,w),b.quadraticCurveTo(v,w,v,w+z),b.closePath(),(g.fillColor||0===g.fillColor)&&(b.globalAlpha=g.fillAlpha*c,b.fillStyle=d="#"+("00000"+(0|g.fillColor).toString(16)).substr(-6),b.fill()),g.lineWidth&&(b.globalAlpha=g.lineAlpha*c,b.stroke())}}},e.CanvasGraphics.renderGraphicsMask=function(a,b){var c=a.graphicsData.length;if(0!==c){c>1&&(c=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var d=0;1>d;d++){var f=a.graphicsData[d],g=f.points;if(f.type===e.Graphics.POLY){b.beginPath(),b.moveTo(g[0],g[1]);for(var h=1;h<g.length/2;h++)b.lineTo(g[2*h],g[2*h+1]);g[0]===g[g.length-2]&&g[1]===g[g.length-1]&&b.closePath()}else if(f.type===e.Graphics.RECT)b.beginPath(),b.rect(g[0],g[1],g[2],g[3]),b.closePath();else if(f.type===e.Graphics.CIRC)b.beginPath(),b.arc(g[0],g[1],g[2],0,2*Math.PI),b.closePath();else if(f.type===e.Graphics.ELIP){var i=f.points,j=2*i[2],k=2*i[3],l=i[0]-j/2,m=i[1]-k/2;b.beginPath();var n=.5522848,o=j/2*n,p=k/2*n,q=l+j,r=m+k,s=l+j/2,t=m+k/2;b.moveTo(l,t),b.bezierCurveTo(l,t-p,s-o,m,s,m),b.bezierCurveTo(s+o,m,q,t-p,q,t),b.bezierCurveTo(q,t+p,s+o,r,s,r),b.bezierCurveTo(s-o,r,l,t+p,l,t),b.closePath()}else if(f.type===e.Graphics.RREC){var u=g[0],v=g[1],w=g[2],x=g[3],y=g[4],z=Math.min(w,x)/2|0;y=y>z?z:y,b.beginPath(),b.moveTo(u,v+y),b.lineTo(u,v+x-y),b.quadraticCurveTo(u,v+x,u+y,v+x),b.lineTo(u+w-y,v+x),b.quadraticCurveTo(u+w,v+x,u+w,v+x-y),b.lineTo(u+w,v+y),b.quadraticCurveTo(u+w,v,u+w-y,v),b.lineTo(u+y,v),b.quadraticCurveTo(u,v,u,v+y),b.closePath()}}}},e.Graphics=function(){e.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor="black",this.graphicsData=[],this.tint=16777215,this.blendMode=e.blendModes.NORMAL,this.currentPath={points:[]},this._webGL=[],this.isMask=!1,this.bounds=null,this.boundsPadding=10,this.dirty=!0},e.Graphics.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Graphics.prototype.constructor=e.Graphics,Object.defineProperty(e.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(a){this._cacheAsBitmap=a,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),e.Graphics.prototype.lineStyle=function(a,b,c){return this.currentPath.points.length||this.graphicsData.pop(),this.lineWidth=a||0,this.lineColor=b||0,this.lineAlpha=arguments.length<3?1:c,this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.moveTo=function(a,b){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.currentPath.points.push(a,b),this.graphicsData.push(this.currentPath),this},e.Graphics.prototype.lineTo=function(a,b){return this.currentPath.points.push(a,b),this.dirty=!0,this},e.Graphics.prototype.quadraticCurveTo=function(a,b,c,d){0===this.currentPath.points.length&&this.moveTo(0,0);var e,f,g=20,h=this.currentPath.points;0===h.length&&this.moveTo(0,0);for(var i=h[h.length-2],j=h[h.length-1],k=0,l=1;g>=l;l++)k=l/g,e=i+(a-i)*k,f=j+(b-j)*k,h.push(e+(a+(c-a)*k-e)*k,f+(b+(d-b)*k-f)*k);return this.dirty=!0,this},e.Graphics.prototype.bezierCurveTo=function(a,b,c,d,e,f){0===this.currentPath.points.length&&this.moveTo(0,0);for(var g,h,i,j,k,l=20,m=this.currentPath.points,n=m[m.length-2],o=m[m.length-1],p=0,q=1;l>q;q++)p=q/l,g=1-p,h=g*g,i=h*g,j=p*p,k=j*p,m.push(i*n+3*h*p*a+3*g*j*c+k*e,i*o+3*h*p*b+3*g*j*d+k*f);return this.dirty=!0,this},e.Graphics.prototype.arcTo=function(a,b,c,d,e){0===this.currentPath.points.length&&this.moveTo(a,b);var f=this.currentPath.points,g=f[f.length-2],h=f[f.length-1],i=h-b,j=g-a,k=d-b,l=c-a,m=Math.abs(i*l-j*k);if(1e-8>m||0===e)f.push(a,b);else{var n=i*i+j*j,o=k*k+l*l,p=i*k+j*l,q=e*Math.sqrt(n)/m,r=e*Math.sqrt(o)/m,s=q*p/n,t=r*p/o,u=q*l+r*j,v=q*k+r*i,w=j*(r+s),x=i*(r+s),y=l*(q+t),z=k*(q+t),A=Math.atan2(x-v,w-u),B=Math.atan2(z-v,y-u);this.arc(u+a,v+b,e,A,B,j*k>l*i)}return this.dirty=!0,this},e.Graphics.prototype.arc=function(a,b,c,d,e,f){var g=a+Math.cos(d)*c,h=b+Math.sin(d)*c,i=this.currentPath.points;if((0!==i.length&&i[i.length-2]!==g||i[i.length-1]!==h)&&(this.moveTo(g,h),i=this.currentPath.points),d===e)return this;!f&&d>=e?e+=2*Math.PI:f&&e>=d&&(d+=2*Math.PI);var j=f?-1*(d-e):e-d,k=Math.abs(j)/(2*Math.PI)*40;if(0===j)return this;for(var l=j/(2*k),m=2*l,n=Math.cos(l),o=Math.sin(l),p=k-1,q=p%1/p,r=0;p>=r;r++){var s=r+q*r,t=l+d+m*s,u=Math.cos(t),v=-Math.sin(t);i.push((n*u+o*v)*c+a,(n*-v+o*u)*c+b)}return this.dirty=!0,this},e.Graphics.prototype.drawPath=function(a){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath=this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[],type:e.Graphics.POLY},this.graphicsData.push(this.currentPath),this.currentPath.points=this.currentPath.points.concat(a),this.dirty=!0,this},e.Graphics.prototype.beginFill=function(a,b){return this.filling=!0,this.fillColor=a||0,this.fillAlpha=arguments.length<2?1:b,this},e.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},e.Graphics.prototype.drawRect=function(a,b,c,d){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[a,b,c,d],type:e.Graphics.RECT},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawRoundedRect=function(a,b,c,d,f){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[a,b,c,d,f],type:e.Graphics.RREC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawCircle=function(a,b,c){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[a,b,c,c],type:e.Graphics.CIRC},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.drawEllipse=function(a,b,c,d){return this.currentPath.points.length||this.graphicsData.pop(),this.currentPath={lineWidth:this.lineWidth,lineColor:this.lineColor,lineAlpha:this.lineAlpha,fillColor:this.fillColor,fillAlpha:this.fillAlpha,fill:this.filling,points:[a,b,c,d],type:e.Graphics.ELIP},this.graphicsData.push(this.currentPath),this.dirty=!0,this},e.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this.bounds=null,this},e.Graphics.prototype.generateTexture=function(){var a=this.getBounds(),b=new e.CanvasBuffer(a.width,a.height),c=e.Texture.fromCanvas(b.canvas);return b.context.translate(-a.x,-a.y),e.CanvasGraphics.renderGraphics(this,b.context),c},e.Graphics.prototype._renderWebGL=function(a){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return this.dirty&&(this._generateCachedSprite(),e.updateWebGLTexture(this._cachedSprite.texture.baseTexture,a.gl),this.dirty=!1),this._cachedSprite.alpha=this.alpha,void e.Sprite.prototype._renderWebGL.call(this._cachedSprite,a);if(a.spriteBatch.stop(),a.blendModeManager.setBlendMode(this.blendMode),this._mask&&a.maskManager.pushMask(this._mask,a),this._filters&&a.filterManager.pushFilter(this._filterBlock),this.blendMode!==a.spriteBatch.currentBlendMode){a.spriteBatch.currentBlendMode=this.blendMode;var b=e.blendModesWebGL[a.spriteBatch.currentBlendMode];a.spriteBatch.gl.blendFunc(b[0],b[1])}if(e.WebGLGraphics.renderGraphics(this,a),this.children.length){a.spriteBatch.start();for(var c=0,d=this.children.length;d>c;c++)this.children[c]._renderWebGL(a);a.spriteBatch.stop()}this._filters&&a.filterManager.popFilter(),this._mask&&a.maskManager.popMask(this.mask,a),a.drawCount++,a.spriteBatch.start()}},e.Graphics.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){var b=a.context,c=this.worldTransform;this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,b.globalCompositeOperation=e.blendModesCanvas[a.currentBlendMode]),this._mask&&a.maskManager.pushMask(this._mask,a.context),b.setTransform(c.a,c.c,c.b,c.d,c.tx,c.ty),e.CanvasGraphics.renderGraphics(this,b);for(var d=0,f=this.children.length;f>d;d++)this.children[d]._renderCanvas(a);this._mask&&a.maskManager.popMask(a.context)}},e.Graphics.prototype.getBounds=function(a){this.bounds||this.updateBounds();var b=this.bounds.x,c=this.bounds.width+this.bounds.x,d=this.bounds.y,e=this.bounds.height+this.bounds.y,f=a||this.worldTransform,g=f.a,h=f.c,i=f.b,j=f.d,k=f.tx,l=f.ty,m=g*c+i*e+k,n=j*e+h*c+l,o=g*b+i*e+k,p=j*e+h*b+l,q=g*b+i*d+k,r=j*d+h*b+l,s=g*c+i*d+k,t=j*d+h*c+l,u=m,v=n,w=m,x=n;w=w>o?o:w,w=w>q?q:w,w=w>s?s:w,x=x>p?p:x,x=x>r?r:x,x=x>t?t:x,u=o>u?o:u,u=q>u?q:u,u=s>u?s:u,v=p>v?p:v,v=r>v?r:v,v=t>v?t:v;var y=this._bounds;return y.x=w,y.width=u-w,y.y=x,y.height=v-x,y},e.Graphics.prototype.updateBounds=function(){for(var a,b,c,d,f,g=1/0,h=-(1/0),i=1/0,j=-(1/0),k=0;k<this.graphicsData.length;k++){var l=this.graphicsData[k],m=l.type,n=l.lineWidth;if(a=l.points,m===e.Graphics.RECT)b=a[0]-n/2,c=a[1]-n/2,d=a[2]+n,f=a[3]+n,g=g>b?b:g,h=b+d>h?b+d:h,i=i>c?b:i,j=c+f>j?c+f:j;else if(m===e.Graphics.CIRC||m===e.Graphics.ELIP)b=a[0],c=a[1],d=a[2]+n/2,f=a[3]+n/2,g=g>b-d?b-d:g,h=b+d>h?b+d:h,i=i>c-f?c-f:i,j=c+f>j?c+f:j;else for(var o=0;o<a.length;o+=2)b=a[o],c=a[o+1],g=g>b-n?b-n:g,h=b+n>h?b+n:h,i=i>c-n?c-n:i,j=c+n>j?c+n:j}var p=this.boundsPadding;this.bounds=new e.Rectangle(g-p,i-p,h-g+2*p,j-i+2*p)},e.Graphics.prototype._generateCachedSprite=function(){var a=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(a.width,a.height);else{var b=new e.CanvasBuffer(a.width,a.height),c=e.Texture.fromCanvas(b.canvas);this._cachedSprite=new e.Sprite(c),this._cachedSprite.buffer=b,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(a.x/a.width),this._cachedSprite.anchor.y=-(a.y/a.height),this._cachedSprite.buffer.context.translate(-a.x,-a.y),e.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},e.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},e.Graphics.POLY=0,e.Graphics.RECT=1,e.Graphics.CIRC=2,e.Graphics.ELIP=3,e.Graphics.RREC=4,e.Strip=function(a){e.DisplayObjectContainer.call(this),this.texture=a,this.uvs=new e.Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new e.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new e.Float32Array([1,1,1,1]),this.indices=new e.Uint16Array([0,1,2,3]),this.dirty=!0},e.Strip.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Strip.prototype.constructor=e.Strip,e.Strip.prototype._renderWebGL=function(a){!this.visible||this.alpha<=0||(a.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(a),a.shaderManager.setShader(a.shaderManager.stripShader),this._renderStrip(a),a.spriteBatch.start())},e.Strip.prototype._initWebGL=function(a){var b=a.gl;this._vertexBuffer=b.createBuffer(),this._indexBuffer=b.createBuffer(),this._uvBuffer=b.createBuffer(),this._colorBuffer=b.createBuffer(),b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,this.verticies,b.DYNAMIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.bufferData(b.ARRAY_BUFFER,this.uvs,b.STATIC_DRAW),b.bindBuffer(b.ARRAY_BUFFER,this._colorBuffer),b.bufferData(b.ARRAY_BUFFER,this.colors,b.STATIC_DRAW),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW)},e.Strip.prototype._renderStrip=function(a){var b=a.gl,c=a.projection,d=a.offset,f=a.shaderManager.stripShader;b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.uniformMatrix3fv(f.translationMatrix,!1,this.worldTransform.toArray(!0)),b.uniform2f(f.projectionVector,c.x,-c.y),b.uniform2f(f.offsetVector,-d.x,-d.y),b.uniform1f(f.alpha,1),this.dirty?(this.dirty=!1,b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferData(b.ARRAY_BUFFER,this.verticies,b.STATIC_DRAW),b.vertexAttribPointer(f.aVertexPosition,2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.bufferData(b.ARRAY_BUFFER,this.uvs,b.STATIC_DRAW),b.vertexAttribPointer(f.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTextures[b.id]||e.createWebGLTexture(this.texture.baseTexture,b)),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW)):(b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer),b.bufferSubData(b.ARRAY_BUFFER,0,this.verticies),b.vertexAttribPointer(f.aVertexPosition,2,b.FLOAT,!1,0,0),b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer),b.vertexAttribPointer(f.aTextureCoord,2,b.FLOAT,!1,0,0),b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,this.texture.baseTexture._glTextures[b.id]||e.createWebGLTexture(this.texture.baseTexture,b)),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),b.drawElements(b.TRIANGLE_STRIP,this.indices.length,b.UNSIGNED_SHORT,0)},e.Strip.prototype._renderCanvas=function(a){var b=a.context,c=this.worldTransform;a.roundPixels?b.setTransform(c.a,c.c,c.b,c.d,0|c.tx,0|c.ty):b.setTransform(c.a,c.c,c.b,c.d,c.tx,c.ty);var d=this,e=d.verticies,f=d.uvs,g=e.length/2;this.count++;
for(var h=0;g-2>h;h++){var i=2*h,j=e[i],k=e[i+2],l=e[i+4],m=e[i+1],n=e[i+3],o=e[i+5],p=(j+k+l)/3,q=(m+n+o)/3,r=j-p,s=m-q,t=Math.sqrt(r*r+s*s);j=p+r/t*(t+3),m=q+s/t*(t+3),r=k-p,s=n-q,t=Math.sqrt(r*r+s*s),k=p+r/t*(t+3),n=q+s/t*(t+3),r=l-p,s=o-q,t=Math.sqrt(r*r+s*s),l=p+r/t*(t+3),o=q+s/t*(t+3);var u=f[i]*d.texture.width,v=f[i+2]*d.texture.width,w=f[i+4]*d.texture.width,x=f[i+1]*d.texture.height,y=f[i+3]*d.texture.height,z=f[i+5]*d.texture.height;b.save(),b.beginPath(),b.moveTo(j,m),b.lineTo(k,n),b.lineTo(l,o),b.closePath(),b.clip();var A=u*y+x*w+v*z-y*w-x*v-u*z,B=j*y+x*l+k*z-y*l-x*k-j*z,C=u*k+j*w+v*l-k*w-j*v-u*l,D=u*y*l+x*k*w+j*v*z-j*y*w-x*v*l-u*k*z,E=m*y+x*o+n*z-y*o-x*n-m*z,F=u*n+m*w+v*o-n*w-m*v-u*o,G=u*y*o+x*n*w+m*v*z-m*y*w-x*v*o-u*n*z;b.transform(B/A,E/A,C/A,F/A,D/A,G/A),b.drawImage(d.texture.baseTexture.source,0,0),b.restore()}},e.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},e.Rope=function(a,b){e.Strip.call(this,a),this.points=b,this.verticies=new e.Float32Array(4*b.length),this.uvs=new e.Float32Array(4*b.length),this.colors=new e.Float32Array(2*b.length),this.indices=new e.Uint16Array(2*b.length),this.refresh()},e.Rope.prototype=Object.create(e.Strip.prototype),e.Rope.prototype.constructor=e.Rope,e.Rope.prototype.refresh=function(){var a=this.points;if(!(a.length<1)){var b=this.uvs,c=a[0],d=this.indices,e=this.colors;this.count-=.2,b[0]=0,b[1]=0,b[2]=0,b[3]=1,e[0]=1,e[1]=1,d[0]=0,d[1]=1;for(var f,g,h,i=a.length,j=1;i>j;j++)f=a[j],g=4*j,h=j/(i-1),j%2?(b[g]=h,b[g+1]=0,b[g+2]=h,b[g+3]=1):(b[g]=h,b[g+1]=0,b[g+2]=h,b[g+3]=1),g=2*j,e[g]=1,e[g+1]=1,g=2*j,d[g]=g,d[g+1]=g+1,c=f}},e.Rope.prototype.updateTransform=function(){var a=this.points;if(!(a.length<1)){var b,c=a[0],d={x:0,y:0};this.count-=.2;for(var f,g,h,i,j,k=this.verticies,l=a.length,m=0;l>m;m++)f=a[m],g=4*m,b=m<a.length-1?a[m+1]:f,d.y=-(b.x-c.x),d.x=b.y-c.y,h=10*(1-m/(l-1)),h>1&&(h=1),i=Math.sqrt(d.x*d.x+d.y*d.y),j=this.texture.height/2,d.x/=i,d.y/=i,d.x*=j,d.y*=j,k[g]=f.x+d.x,k[g+1]=f.y+d.y,k[g+2]=f.x-d.x,k[g+3]=f.y-d.y,c=f;e.DisplayObjectContainer.prototype.updateTransform.call(this)}},e.Rope.prototype.setTexture=function(a){this.texture=a},e.TilingSprite=function(a,b,c){e.Sprite.call(this,a),this._width=b||100,this._height=c||100,this.tileScale=new e.Point(1,1),this.tileScaleOffset=new e.Point(1,1),this.tilePosition=new e.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=e.blendModes.NORMAL},e.TilingSprite.prototype=Object.create(e.Sprite.prototype),e.TilingSprite.prototype.constructor=e.TilingSprite,Object.defineProperty(e.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(a){this._width=a}}),Object.defineProperty(e.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(a){this._height=a}}),e.TilingSprite.prototype.setTexture=function(a){this.texture!==a&&(this.texture=a,this.refreshTexture=!0,this.cachedTint=16777215)},e.TilingSprite.prototype._renderWebGL=function(a){if(this.visible!==!1&&0!==this.alpha){var b,c;for(this._mask&&(a.spriteBatch.stop(),a.maskManager.pushMask(this.mask,a),a.spriteBatch.start()),this._filters&&(a.spriteBatch.flush(),a.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(e.updateWebGLTexture(this.tilingTexture.baseTexture,a.gl),this.tilingTexture.needsUpdate=!1)):a.spriteBatch.renderTilingSprite(this),b=0,c=this.children.length;c>b;b++)this.children[b]._renderWebGL(a);a.spriteBatch.stop(),this._filters&&a.filterManager.popFilter(),this._mask&&a.maskManager.popMask(a),a.spriteBatch.start()}},e.TilingSprite.prototype._renderCanvas=function(a){if(this.visible!==!1&&0!==this.alpha){var b=a.context;this._mask&&a.maskManager.pushMask(this._mask,b),b.globalAlpha=this.worldAlpha;var c,d,f=this.worldTransform;if(b.setTransform(f.a,f.c,f.b,f.d,f.tx,f.ty),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=b.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,b.globalCompositeOperation=e.blendModesCanvas[a.currentBlendMode]);var g=this.tilePosition,h=this.tileScale;for(g.x%=this.tilingTexture.baseTexture.width,g.y%=this.tilingTexture.baseTexture.height,b.scale(h.x,h.y),b.translate(g.x,g.y),b.fillStyle=this.__tilePattern,b.fillRect(-g.x+this.anchor.x*-this._width,-g.y+this.anchor.y*-this._height,this._width/h.x,this._height/h.y),b.scale(1/h.x,1/h.y),b.translate(-g.x,-g.y),this._mask&&a.maskManager.popMask(a.context),c=0,d=this.children.length;d>c;c++)this.children[c]._renderCanvas(a)}},e.TilingSprite.prototype.getBounds=function(){var a=this._width,b=this._height,c=a*(1-this.anchor.x),d=a*-this.anchor.x,e=b*(1-this.anchor.y),f=b*-this.anchor.y,g=this.worldTransform,h=g.a,i=g.c,j=g.b,k=g.d,l=g.tx,m=g.ty,n=h*d+j*f+l,o=k*f+i*d+m,p=h*c+j*f+l,q=k*f+i*c+m,r=h*c+j*e+l,s=k*e+i*c+m,t=h*d+j*e+l,u=k*e+i*d+m,v=-(1/0),w=-(1/0),x=1/0,y=1/0;x=x>n?n:x,x=x>p?p:x,x=x>r?r:x,x=x>t?t:x,y=y>o?o:y,y=y>q?q:y,y=y>s?s:y,y=y>u?u:y,v=n>v?n:v,v=p>v?p:v,v=r>v?r:v,v=t>v?t:v,w=o>w?o:w,w=q>w?q:w,w=s>w?s:w,w=u>w?u:w;var z=this._bounds;return z.x=x,z.width=v-x,z.y=y,z.height=w-y,this._currentBounds=z,z},e.TilingSprite.prototype.onTextureUpdate=function(){},e.TilingSprite.prototype.generateTilingTexture=function(a){if(this.texture.baseTexture.hasLoaded){var b,c,d=this.texture,f=d.frame,g=f.width!==d.baseTexture.width||f.height!==d.baseTexture.height,h=!1;if(a?(b=e.getNextPowerOfTwo(f.width),c=e.getNextPowerOfTwo(f.height),(f.width!==b||f.height!==c)&&(h=!0)):g&&(b=f.width,c=f.height,h=!0),h){var i;this.tilingTexture&&this.tilingTexture.isTiling?(i=this.tilingTexture.canvasBuffer,i.resize(b,c),this.tilingTexture.baseTexture.width=b,this.tilingTexture.baseTexture.height=c,this.tilingTexture.needsUpdate=!0):(i=new e.CanvasBuffer(b,c),this.tilingTexture=e.Texture.fromCanvas(i.canvas),this.tilingTexture.canvasBuffer=i,this.tilingTexture.isTiling=!0),i.context.drawImage(d.baseTexture.source,d.crop.x,d.crop.y,d.crop.width,d.crop.height,0,0,b,c),this.tileScaleOffset.x=f.width/b,this.tileScaleOffset.y=f.height/c}else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=d;this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0}};var i={};i.BoneData=function(a,b){this.name=a,this.parent=b},i.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1},i.SlotData=function(a,b){this.name=a,this.boneData=b},i.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null},i.Bone=function(a,b){this.data=a,this.parent=b,this.setToSetupPose()},i.Bone.yDown=!1,i.Bone.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,updateWorldTransform:function(a,b){var c=this.parent;null!=c?(this.worldX=this.x*c.m00+this.y*c.m01+c.worldX,this.worldY=this.x*c.m10+this.y*c.m11+c.worldY,this.worldScaleX=c.worldScaleX*this.scaleX,this.worldScaleY=c.worldScaleY*this.scaleY,this.worldRotation=c.worldRotation+this.rotation):(this.worldX=this.x,this.worldY=this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotation);var d=this.worldRotation*Math.PI/180,e=Math.cos(d),f=Math.sin(d);this.m00=e*this.worldScaleX,this.m10=f*this.worldScaleX,this.m01=-f*this.worldScaleY,this.m11=e*this.worldScaleY,a&&(this.m00=-this.m00,this.m01=-this.m01),b&&(this.m10=-this.m10,this.m11=-this.m11),i.Bone.yDown&&(this.m10=-this.m10,this.m11=-this.m11)},setToSetupPose:function(){var a=this.data;this.x=a.x,this.y=a.y,this.rotation=a.rotation,this.scaleX=a.scaleX,this.scaleY=a.scaleY}},i.Slot=function(a,b,c){this.data=a,this.skeleton=b,this.bone=c,this.setToSetupPose()},i.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,setAttachment:function(a){this.attachment=a,this._attachmentTime=this.skeleton.time},setAttachmentTime:function(a){this._attachmentTime=this.skeleton.time-a},getAttachmentTime:function(){return this.skeleton.time-this._attachmentTime},setToSetupPose:function(){var a=this.data;this.r=a.r,this.g=a.g,this.b=a.b,this.a=a.a;for(var b=this.skeleton.data.slots,c=0,d=b.length;d>c;c++)if(b[c]==a){this.setAttachment(a.attachmentName?this.skeleton.getAttachmentBySlotIndex(c,a.attachmentName):null);break}}},i.Skin=function(a){this.name=a,this.attachments={}},i.Skin.prototype={addAttachment:function(a,b,c){this.attachments[a+":"+b]=c},getAttachment:function(a,b){return this.attachments[a+":"+b]},_attachAll:function(a,b){for(var c in b.attachments){var d=c.indexOf(":"),e=parseInt(c.substring(0,d),10),f=c.substring(d+1),g=a.slots[e];if(g.attachment&&g.attachment.name==f){var h=this.getAttachment(e,f);h&&g.setAttachment(h)}}}},i.Animation=function(a,b,c){this.name=a,this.timelines=b,this.duration=c},i.Animation.prototype={apply:function(a,b,c){c&&this.duration&&(b%=this.duration);for(var d=this.timelines,e=0,f=d.length;f>e;e++)d[e].apply(a,b,1)},mix:function(a,b,c,d){c&&this.duration&&(b%=this.duration);for(var e=this.timelines,f=0,g=e.length;g>f;f++)e[f].apply(a,b,d)}},i.binarySearch=function(a,b,c){var d=0,e=Math.floor(a.length/c)-2;if(!e)return c;for(var f=e>>>1;;){if(a[(f+1)*c]<=b?d=f+1:e=f,d==e)return(d+1)*c;f=d+e>>>1}},i.linearSearch=function(a,b,c){for(var d=0,e=a.length-c;e>=d;d+=c)if(a[d]>b)return d;return-1},i.Curves=function(a){this.curves=[],this.curves.length=6*(a-1)},i.Curves.prototype={setLinear:function(a){this.curves[6*a]=0},setStepped:function(a){this.curves[6*a]=-1},setCurve:function(a,b,c,d,e){var f=.1,g=f*f,h=g*f,i=3*f,j=3*g,k=6*g,l=6*h,m=2*-b+d,n=2*-c+e,o=3*(b-d)+1,p=3*(c-e)+1,q=6*a,r=this.curves;r[q]=b*i+m*j+o*h,r[q+1]=c*i+n*j+p*h,r[q+2]=m*k+o*l,r[q+3]=n*k+p*l,r[q+4]=o*l,r[q+5]=p*l},getCurvePercent:function(a,b){b=0>b?0:b>1?1:b;var c=6*a,d=this.curves,e=d[c];if(!e)return b;if(-1==e)return 0;for(var f=d[c+1],g=d[c+2],h=d[c+3],i=d[c+4],j=d[c+5],k=e,l=f,m=8;;){if(k>=b){var n=k-e,o=l-f;return o+(l-o)*(b-n)/(k-n)}if(!m)break;m--,e+=g,f+=h,g+=i,h+=j,k+=e,l+=f}return l+(1-l)*(b-k)/(1-k)}},i.RotateTimeline=function(a){this.curves=new i.Curves(a),this.frames=[],this.frames.length=2*a},i.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(a,b,c){a*=2,this.frames[a]=b,this.frames[a+1]=c},apply:function(a,b,c){var d,e=this.frames;if(!(b<e[0])){var f=a.bones[this.boneIndex];if(b>=e[e.length-2]){for(d=f.data.rotation+e[e.length-1]-f.rotation;d>180;)d-=360;for(;-180>d;)d+=360;return void(f.rotation+=d*c)}var g=i.binarySearch(e,b,2),h=e[g-1],j=e[g],k=1-(b-j)/(e[g-2]-j);for(k=this.curves.getCurvePercent(g/2-1,k),d=e[g+1]-h;d>180;)d-=360;for(;-180>d;)d+=360;for(d=f.data.rotation+(h+d*k)-f.rotation;d>180;)d-=360;for(;-180>d;)d+=360;f.rotation+=d*c}}},i.TranslateTimeline=function(a){this.curves=new i.Curves(a),this.frames=[],this.frames.length=3*a},i.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.bones[this.boneIndex];if(b>=d[d.length-3])return e.x+=(e.data.x+d[d.length-2]-e.x)*c,void(e.y+=(e.data.y+d[d.length-1]-e.y)*c);var f=i.binarySearch(d,b,3),g=d[f-2],h=d[f-1],j=d[f],k=1-(b-j)/(d[f+-3]-j);k=this.curves.getCurvePercent(f/3-1,k),e.x+=(e.data.x+g+(d[f+1]-g)*k-e.x)*c,e.y+=(e.data.y+h+(d[f+2]-h)*k-e.y)*c}}},i.ScaleTimeline=function(a){this.curves=new i.Curves(a),this.frames=[],this.frames.length=3*a},i.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(a,b,c,d){a*=3,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.bones[this.boneIndex];if(b>=d[d.length-3])return e.scaleX+=(e.data.scaleX-1+d[d.length-2]-e.scaleX)*c,void(e.scaleY+=(e.data.scaleY-1+d[d.length-1]-e.scaleY)*c);var f=i.binarySearch(d,b,3),g=d[f-2],h=d[f-1],j=d[f],k=1-(b-j)/(d[f+-3]-j);k=this.curves.getCurvePercent(f/3-1,k),e.scaleX+=(e.data.scaleX-1+g+(d[f+1]-g)*k-e.scaleX)*c,e.scaleY+=(e.data.scaleY-1+h+(d[f+2]-h)*k-e.scaleY)*c}}},i.ColorTimeline=function(a){this.curves=new i.Curves(a),this.frames=[],this.frames.length=5*a},i.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(a,b,c,d,e,f){a*=5,this.frames[a]=b,this.frames[a+1]=c,this.frames[a+2]=d,this.frames[a+3]=e,this.frames[a+4]=f},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e=a.slots[this.slotIndex];if(b>=d[d.length-5]){var f=d.length-1;return e.r=d[f-3],e.g=d[f-2],e.b=d[f-1],void(e.a=d[f])}var g=i.binarySearch(d,b,5),h=d[g-4],j=d[g-3],k=d[g-2],l=d[g-1],m=d[g],n=1-(b-m)/(d[g-5]-m);n=this.curves.getCurvePercent(g/5-1,n);var o=h+(d[g+1]-h)*n,p=j+(d[g+2]-j)*n,q=k+(d[g+3]-k)*n,r=l+(d[g+4]-l)*n;1>c?(e.r+=(o-e.r)*c,e.g+=(p-e.g)*c,e.b+=(q-e.b)*c,e.a+=(r-e.a)*c):(e.r=o,e.g=p,e.b=q,e.a=r)}}},i.AttachmentTimeline=function(a){this.curves=new i.Curves(a),this.frames=[],this.frames.length=a,this.attachmentNames=[],this.attachmentNames.length=a},i.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(a,b,c){this.frames[a]=b,this.attachmentNames[a]=c},apply:function(a,b,c){var d=this.frames;if(!(b<d[0])){var e;e=b>=d[d.length-1]?d.length-1:i.binarySearch(d,b,1)-1;var f=this.attachmentNames[e];a.slots[this.slotIndex].setAttachment(f?a.getAttachmentBySlotIndex(this.slotIndex,f):null)}}},i.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.animations=[]},i.SkeletonData.prototype={defaultSkin:null,findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return slot[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].name==a)return c;return-1},findSkin:function(a){for(var b=this.skins,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},findAnimation:function(a){for(var b=this.animations,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null}},i.Skeleton=function(a){this.data=a,this.bones=[];for(var b=0,c=a.bones.length;c>b;b++){var d=a.bones[b],e=d.parent?this.bones[a.bones.indexOf(d.parent)]:null;this.bones.push(new i.Bone(d,e))}for(this.slots=[],this.drawOrder=[],b=0,c=a.slots.length;c>b;b++){var f=a.slots[b],g=this.bones[a.bones.indexOf(f.boneData)],h=new i.Slot(f,this,g);this.slots.push(h),this.drawOrder.push(h)}},i.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateWorldTransform:function(){for(var a=this.flipX,b=this.flipY,c=this.bones,d=0,e=c.length;e>d;d++)c[d].updateWorldTransform(a,b)},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var a=this.bones,b=0,c=a.length;c>b;b++)a[b].setToSetupPose()},setSlotsToSetupPose:function(){for(var a=this.slots,b=0,c=a.length;c>b;b++)a[b].setToSetupPose(b)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findBoneIndex:function(a){for(var b=this.bones,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},findSlot:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return b[c];return null},findSlotIndex:function(a){for(var b=this.slots,c=0,d=b.length;d>c;c++)if(b[c].data.name==a)return c;return-1},setSkinByName:function(a){var b=this.data.findSkin(a);if(!b)throw"Skin not found: "+a;this.setSkin(b)},setSkin:function(a){this.skin&&a&&a._attachAll(this,this.skin),this.skin=a},getAttachmentBySlotName:function(a,b){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(a),b)},getAttachmentBySlotIndex:function(a,b){if(this.skin){var c=this.skin.getAttachment(a,b);if(c)return c}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(a,b):null},setAttachment:function(a,b){for(var c=this.slots,d=0,e=c.size;e>d;d++){var f=c[d];if(f.data.name==a){var g=null;if(b&&(g=this.getAttachment(d,b),null==g))throw"Attachment not found: "+b+", for slot: "+a;return void f.setAttachment(g)}}throw"Slot not found: "+a},update:function(a){time+=a}},i.AttachmentType={region:0},i.RegionAttachment=function(){this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},i.RegionAttachment.prototype={x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(a,b,c,d,e){var f=this.uvs;e?(f[2]=a,f[3]=d,f[4]=a,f[5]=b,f[6]=c,f[7]=b,f[0]=c,f[1]=d):(f[0]=a,f[1]=d,f[2]=a,f[3]=b,f[4]=c,f[5]=b,f[6]=c,f[7]=d)},updateOffset:function(){var a=this.width/this.regionOriginalWidth*this.scaleX,b=this.height/this.regionOriginalHeight*this.scaleY,c=-this.width/2*this.scaleX+this.regionOffsetX*a,d=-this.height/2*this.scaleY+this.regionOffsetY*b,e=c+this.regionWidth*a,f=d+this.regionHeight*b,g=this.rotation*Math.PI/180,h=Math.cos(g),i=Math.sin(g),j=c*h+this.x,k=c*i,l=d*h+this.y,m=d*i,n=e*h+this.x,o=e*i,p=f*h+this.y,q=f*i,r=this.offset;r[0]=j-m,r[1]=l+k,r[2]=j-q,r[3]=p+k,r[4]=n-q,r[5]=p+o,r[6]=n-m,r[7]=l+o},computeVertices:function(a,b,c,d){a+=c.worldX,b+=c.worldY;var e=c.m00,f=c.m01,g=c.m10,h=c.m11,i=this.offset;d[0]=i[0]*e+i[1]*f+a,d[1]=i[0]*g+i[1]*h+b,d[2]=i[2]*e+i[3]*f+a,d[3]=i[2]*g+i[3]*h+b,d[4]=i[4]*e+i[5]*f+a,d[5]=i[4]*g+i[5]*h+b,d[6]=i[6]*e+i[7]*f+a,d[7]=i[6]*g+i[7]*h+b}},i.AnimationStateData=function(a){this.skeletonData=a,this.animationToMixTime={}},i.AnimationStateData.prototype={defaultMix:0,setMixByName:function(a,b,c){var d=this.skeletonData.findAnimation(a);if(!d)throw"Animation not found: "+a;var e=this.skeletonData.findAnimation(b);if(!e)throw"Animation not found: "+b;this.setMix(d,e,c)},setMix:function(a,b,c){this.animationToMixTime[a.name+":"+b.name]=c},getMix:function(a,b){var c=this.animationToMixTime[a.name+":"+b.name];return c?c:this.defaultMix}},i.AnimationState=function(a){this.data=a,this.queue=[]},i.AnimationState.prototype={animationSpeed:1,current:null,previous:null,currentTime:0,previousTime:0,currentLoop:!1,previousLoop:!1,mixTime:0,mixDuration:0,update:function(a){if(this.currentTime+=a*this.animationSpeed,this.previousTime+=a,this.mixTime+=a,this.queue.length>0){var b=this.queue[0];this.currentTime>=b.delay&&(this._setAnimation(b.animation,b.loop),this.queue.shift())}},apply:function(a){if(this.current)if(this.previous){this.previous.apply(a,this.previousTime,this.previousLoop);var b=this.mixTime/this.mixDuration;b>=1&&(b=1,this.previous=null),this.current.mix(a,this.currentTime,this.currentLoop,b)}else this.current.apply(a,this.currentTime,this.currentLoop)},clearAnimation:function(){this.previous=null,this.current=null,this.queue.length=0},_setAnimation:function(a,b){this.previous=null,a&&this.current&&(this.mixDuration=this.data.getMix(this.current,a),this.mixDuration>0&&(this.mixTime=0,this.previous=this.current,this.previousTime=this.currentTime,this.previousLoop=this.currentLoop)),this.current=a,this.currentLoop=b,this.currentTime=0},setAnimationByName:function(a,b){var c=this.data.skeletonData.findAnimation(a);if(!c)throw"Animation not found: "+a;this.setAnimation(c,b)},setAnimation:function(a,b){this.queue.length=0,this._setAnimation(a,b)},addAnimationByName:function(a,b,c){var d=this.data.skeletonData.findAnimation(a);if(!d)throw"Animation not found: "+a;this.addAnimation(d,b,c)},addAnimation:function(a,b,c){var d={};if(d.animation=a,d.loop=b,!c||0>=c){var e=this.queue.length?this.queue[this.queue.length-1].animation:this.current;c=null!=e?e.duration-this.data.getMix(e,a)+(c||0):0}d.delay=c,this.queue.push(d)},isComplete:function(){return!this.current||this.currentTime>=this.current.duration}},i.SkeletonJson=function(a){this.attachmentLoader=a},i.SkeletonJson.prototype={scale:1,readSkeletonData:function(a){for(var b,c=new i.SkeletonData,d=a.bones,e=0,f=d.length;f>e;e++){var g=d[e],h=null;if(g.parent&&(h=c.findBone(g.parent),!h))throw"Parent bone not found: "+g.parent;b=new i.BoneData(g.name,h),b.length=(g.length||0)*this.scale,b.x=(g.x||0)*this.scale,b.y=(g.y||0)*this.scale,b.rotation=g.rotation||0,b.scaleX=g.scaleX||1,b.scaleY=g.scaleY||1,c.bones.push(b)}var j=a.slots;for(e=0,f=j.length;f>e;e++){var k=j[e];if(b=c.findBone(k.bone),!b)throw"Slot bone not found: "+k.bone;var l=new i.SlotData(k.name,b),m=k.color;m&&(l.r=i.SkeletonJson.toColor(m,0),l.g=i.SkeletonJson.toColor(m,1),l.b=i.SkeletonJson.toColor(m,2),l.a=i.SkeletonJson.toColor(m,3)),l.attachmentName=k.attachment,c.slots.push(l)}var n=a.skins;for(var o in n)if(n.hasOwnProperty(o)){var p=n[o],q=new i.Skin(o);for(var r in p)if(p.hasOwnProperty(r)){var s=c.findSlotIndex(r),t=p[r];for(var u in t)if(t.hasOwnProperty(u)){var v=this.readAttachment(q,u,t[u]);null!=v&&q.addAttachment(s,u,v)}}c.skins.push(q),"default"==q.name&&(c.defaultSkin=q)}var w=a.animations;for(var x in w)w.hasOwnProperty(x)&&this.readAnimation(x,w[x],c);return c},readAttachment:function(a,b,c){b=c.name||b;var d=i.AttachmentType[c.type||"region"];if(d==i.AttachmentType.region){var e=new i.RegionAttachment;return e.x=(c.x||0)*this.scale,e.y=(c.y||0)*this.scale,e.scaleX=c.scaleX||1,e.scaleY=c.scaleY||1,e.rotation=c.rotation||0,e.width=(c.width||32)*this.scale,e.height=(c.height||32)*this.scale,e.updateOffset(),e.rendererObject={},e.rendererObject.name=b,e.rendererObject.scale={},e.rendererObject.scale.x=e.scaleX,e.rendererObject.scale.y=e.scaleY,e.rendererObject.rotation=-e.rotation*Math.PI/180,e}throw"Unknown attachment type: "+d},readAnimation:function(a,b,c){var d,e,f,g,h,j,k,l=[],m=0,n=b.bones;for(var o in n)if(n.hasOwnProperty(o)){var p=c.findBoneIndex(o);if(-1==p)throw"Bone not found: "+o;var q=n[o];for(f in q)if(q.hasOwnProperty(f))if(h=q[f],"rotate"==f){for(e=new i.RotateTimeline(h.length),e.boneIndex=p,d=0,j=0,k=h.length;k>j;j++)g=h[j],e.setFrame(d,g.time,g.angle),i.SkeletonJson.readCurve(e,d,g),d++;l.push(e),m=Math.max(m,e.frames[2*e.getFrameCount()-2])}else{if("translate"!=f&&"scale"!=f)throw"Invalid timeline type for a bone: "+f+" ("+o+")";var r=1;for("scale"==f?e=new i.ScaleTimeline(h.length):(e=new i.TranslateTimeline(h.length),r=this.scale),e.boneIndex=p,d=0,j=0,k=h.length;k>j;j++){g=h[j];var s=(g.x||0)*r,t=(g.y||0)*r;e.setFrame(d,g.time,s,t),i.SkeletonJson.readCurve(e,d,g),d++}l.push(e),m=Math.max(m,e.frames[3*e.getFrameCount()-3])}}var u=b.slots;for(var v in u)if(u.hasOwnProperty(v)){var w=u[v],x=c.findSlotIndex(v);for(f in w)if(w.hasOwnProperty(f))if(h=w[f],"color"==f){for(e=new i.ColorTimeline(h.length),e.slotIndex=x,d=0,j=0,k=h.length;k>j;j++){g=h[j];var y=g.color,z=i.SkeletonJson.toColor(y,0),A=i.SkeletonJson.toColor(y,1),B=i.SkeletonJson.toColor(y,2),C=i.SkeletonJson.toColor(y,3);e.setFrame(d,g.time,z,A,B,C),i.SkeletonJson.readCurve(e,d,g),d++}l.push(e),m=Math.max(m,e.frames[5*e.getFrameCount()-5])}else{if("attachment"!=f)throw"Invalid timeline type for a slot: "+f+" ("+v+")";for(e=new i.AttachmentTimeline(h.length),e.slotIndex=x,d=0,j=0,k=h.length;k>j;j++)g=h[j],e.setFrame(d++,g.time,g.name);l.push(e),m=Math.max(m,e.frames[e.getFrameCount()-1])}}c.animations.push(new i.Animation(a,l,m))}},i.SkeletonJson.readCurve=function(a,b,c){var d=c.curve;d&&("stepped"==d?a.curves.setStepped(b):d instanceof Array&&a.curves.setCurve(b,d[0],d[1],d[2],d[3]))},i.SkeletonJson.toColor=function(a,b){if(8!=a.length)throw"Color hexidecimal length must be 8, recieved: "+a;return parseInt(a.substr(2*b,2),16)/255},i.Atlas=function(a,b){this.textureLoader=b,this.pages=[],this.regions=[];var c=new i.AtlasReader(a),d=[];d.length=4;for(var e=null;;){var f=c.readLine();if(null==f)break;if(f=c.trim(f),f.length)if(e){var g=new i.AtlasRegion;g.name=f,g.page=e,g.rotate="true"==c.readValue(),c.readTuple(d);var h=parseInt(d[0],10),j=parseInt(d[1],10);c.readTuple(d);var k=parseInt(d[0],10),l=parseInt(d[1],10);g.u=h/e.width,g.v=j/e.height,g.rotate?(g.u2=(h+l)/e.width,g.v2=(j+k)/e.height):(g.u2=(h+k)/e.width,g.v2=(j+l)/e.height),g.x=h,g.y=j,g.width=Math.abs(k),g.height=Math.abs(l),4==c.readTuple(d)&&(g.splits=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10)],4==c.readTuple(d)&&(g.pads=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10)],c.readTuple(d))),g.originalWidth=parseInt(d[0],10),g.originalHeight=parseInt(d[1],10),c.readTuple(d),g.offsetX=parseInt(d[0],10),g.offsetY=parseInt(d[1],10),g.index=parseInt(c.readValue(),10),this.regions.push(g)}else{e=new i.AtlasPage,e.name=f,e.format=i.Atlas.Format[c.readValue()],c.readTuple(d),e.minFilter=i.Atlas.TextureFilter[d[0]],e.magFilter=i.Atlas.TextureFilter[d[1]];var m=c.readValue();e.uWrap=i.Atlas.TextureWrap.clampToEdge,e.vWrap=i.Atlas.TextureWrap.clampToEdge,"x"==m?e.uWrap=i.Atlas.TextureWrap.repeat:"y"==m?e.vWrap=i.Atlas.TextureWrap.repeat:"xy"==m&&(e.uWrap=e.vWrap=i.Atlas.TextureWrap.repeat),b.load(e,f),this.pages.push(e)}else e=null}},i.Atlas.prototype={findRegion:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++)if(b[c].name==a)return b[c];return null},dispose:function(){for(var a=this.pages,b=0,c=a.length;c>b;b++)this.textureLoader.unload(a[b].rendererObject)},updateUVs:function(a){for(var b=this.regions,c=0,d=b.length;d>c;c++){var e=b[c];e.page==a&&(e.u=e.x/a.width,e.v=e.y/a.height,e.rotate?(e.u2=(e.x+e.height)/a.width,e.v2=(e.y+e.width)/a.height):(e.u2=(e.x+e.width)/a.width,e.v2=(e.y+e.height)/a.height))}}},i.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},i.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},i.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},i.AtlasPage=function(){},i.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},i.AtlasRegion=function(){},i.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},i.AtlasReader=function(a){this.lines=a.split(/\r\n|\r|\n/)},i.AtlasReader.prototype={index:0,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var a=this.readLine(),b=a.indexOf(":");if(-1==b)throw"Invalid line: "+a;return this.trim(a.substring(b+1))},readTuple:function(a){var b=this.readLine(),c=b.indexOf(":");if(-1==c)throw"Invalid line: "+b;for(var d=0,e=c+1;3>d;d++){var f=b.indexOf(",",e);if(-1==f){if(!d)throw"Invalid line: "+b;break}a[d]=this.trim(b.substr(e,f-e)),e=f+1}return a[d]=this.trim(b.substring(e)),d+1}},i.AtlasAttachmentLoader=function(a){this.atlas=a},i.AtlasAttachmentLoader.prototype={newAttachment:function(a,b,c){switch(b){case i.AttachmentType.region:var d=this.atlas.findRegion(c);if(!d)throw"Region not found in atlas: "+c+" ("+b+")";var e=new i.RegionAttachment(c);return e.rendererObject=d,e.setUVs(d.u,d.v,d.u2,d.v2,d.rotate),e.regionOffsetX=d.offsetX,e.regionOffsetY=d.offsetY,e.regionWidth=d.width,e.regionHeight=d.height,e.regionOriginalWidth=d.originalWidth,e.regionOriginalHeight=d.originalHeight,e}throw"Unknown attachment type: "+b}},i.Bone.yDown=!0,e.AnimCache={},e.Spine=function(a){if(e.DisplayObjectContainer.call(this),this.spineData=e.AnimCache[a],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+a);this.skeleton=new i.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new i.AnimationStateData(this.spineData),this.state=new i.AnimationState(this.stateData),this.slotContainers=[];for(var b=0,c=this.skeleton.drawOrder.length;c>b;b++){var d=this.skeleton.drawOrder[b],f=d.attachment,g=new e.DisplayObjectContainer;if(this.slotContainers.push(g),this.addChild(g),f instanceof i.RegionAttachment){var h=f.rendererObject.name,j=this.createSprite(d,f.rendererObject);d.currentSprite=j,d.currentSpriteName=h,g.addChild(j)}}},e.Spine.prototype=Object.create(e.DisplayObjectContainer.prototype),e.Spine.prototype.constructor=e.Spine,e.Spine.prototype.updateTransform=function(){this.lastTime=this.lastTime||Date.now();var a=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.state.update(a),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var b=this.skeleton.drawOrder,c=0,d=b.length;d>c;c++){var f=b[c],g=f.attachment,h=this.slotContainers[c];if(g instanceof i.RegionAttachment){if(g.rendererObject&&(!f.currentSpriteName||f.currentSpriteName!=g.name)){var j=g.rendererObject.name;if(void 0!==f.currentSprite&&(f.currentSprite.visible=!1),f.sprites=f.sprites||{},void 0!==f.sprites[j])f.sprites[j].visible=!0;else{var k=this.createSprite(f,g.rendererObject);h.addChild(k)}f.currentSprite=f.sprites[j],f.currentSpriteName=j}h.visible=!0;var l=f.bone;h.position.x=l.worldX+g.x*l.m00+g.y*l.m01,h.position.y=l.worldY+g.x*l.m10+g.y*l.m11,h.scale.x=l.worldScaleX,h.scale.y=l.worldScaleY,h.rotation=-(f.bone.worldRotation*Math.PI/180),h.alpha=f.a,f.currentSprite.tint=e.rgb2hex([f.r,f.g,f.b])}else h.visible=!1}e.DisplayObjectContainer.prototype.updateTransform.call(this)},e.Spine.prototype.createSprite=function(a,b){var c=e.TextureCache[b.name]?b.name:b.name+".png",d=new e.Sprite(e.Texture.fromFrame(c));return d.scale=b.scale,d.rotation=b.rotation,d.anchor.x=d.anchor.y=.5,a.sprites=a.sprites||{},a.sprites[b.name]=d,d},e.BaseTextureCache={},e.texturesToUpdate=[],e.texturesToDestroy=[],e.BaseTextureCacheIdGenerator=0,e.BaseTexture=function(a,b){if(e.EventTarget.call(this),this.width=100,this.height=100,this.scaleMode=b||e.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=a,this.id=e.BaseTextureCacheIdGenerator++,this.premultipliedAlpha=!0,this._glTextures=[],this._dirty=[],a){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,e.texturesToUpdate.push(this);else{var c=this;this.source.onload=function(){c.hasLoaded=!0,c.width=c.source.width,c.height=c.source.height;for(var a=0;a<c._glTextures.length;a++)c._dirty[a]=!0;c.dispatchEvent({type:"loaded",content:c})},this.source.onerror=function(){c.dispatchEvent({type:"error",content:c})}}this.imageUrl=null,this._powerOf2=!1}},e.BaseTexture.prototype.constructor=e.BaseTexture,e.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete e.BaseTextureCache[this.imageUrl],delete e.TextureCache[this.imageUrl],this.imageUrl=null,this.source.src=null):this.source&&this.source._pixiId&&delete e.BaseTextureCache[this.source._pixiId],this.source=null,e.texturesToDestroy.push(this)},e.BaseTexture.prototype.updateSourceImage=function(a){this.hasLoaded=!1,this.source.src=null,this.source.src=a},e.BaseTexture.fromImage=function(a,b,c){var d=e.BaseTextureCache[a];if(void 0===b&&-1===a.indexOf("data:")&&(b=!0),!d){var f=new Image;b&&(f.crossOrigin=""),f.src=a,d=new e.BaseTexture(f,c),d.imageUrl=a,e.BaseTextureCache[a]=d}return d},e.BaseTexture.fromCanvas=function(a,b){a._pixiId||(a._pixiId="canvas_"+e.TextureCacheIdGenerator++);var c=e.BaseTextureCache[a._pixiId];return c||(c=new e.BaseTexture(a,b),e.BaseTextureCache[a._pixiId]=c),c},e.TextureCache={},e.FrameCache={},e.TextureCacheIdGenerator=0,e.Texture=function(a,b){if(e.EventTarget.call(this),this.noFrame=!1,b||(this.noFrame=!0,b=new e.Rectangle(0,0,1,1)),a instanceof e.Texture&&(a=a.baseTexture),this.baseTexture=a,this.frame=b,this.trim=null,this.valid=!1,this.scope=this,this._uvs=null,this.width=0,this.height=0,this.crop=new e.Rectangle(0,0,1,1),a.hasLoaded)this.noFrame&&(b=new e.Rectangle(0,0,a.width,a.height)),
this.setFrame(b);else{var c=this;a.addEventListener("loaded",function(){c.onBaseTextureLoaded()})}},e.Texture.prototype.constructor=e.Texture,e.Texture.prototype.onBaseTextureLoaded=function(){var a=this.baseTexture;a.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new e.Rectangle(0,0,a.width,a.height)),this.setFrame(this.frame),this.scope.dispatchEvent({type:"update",content:this})},e.Texture.prototype.destroy=function(a){a&&this.baseTexture.destroy(),this.valid=!1},e.Texture.prototype.setFrame=function(a){if(this.noFrame=!1,this.frame=a,this.width=a.width,this.height=a.height,this.crop.x=a.x,this.crop.y=a.y,this.crop.width=a.width,this.crop.height=a.height,!this.trim&&(a.x+a.width>this.baseTexture.width||a.y+a.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=a&&a.width&&a.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&e.Texture.frameUpdates.push(this)},e.Texture.prototype._updateWebGLuvs=function(){this._uvs||(this._uvs=new e.TextureUvs);var a=this.crop,b=this.baseTexture.width,c=this.baseTexture.height;this._uvs.x0=a.x/b,this._uvs.y0=a.y/c,this._uvs.x1=(a.x+a.width)/b,this._uvs.y1=a.y/c,this._uvs.x2=(a.x+a.width)/b,this._uvs.y2=(a.y+a.height)/c,this._uvs.x3=a.x/b,this._uvs.y3=(a.y+a.height)/c},e.Texture.fromImage=function(a,b,c){var d=e.TextureCache[a];return d||(d=new e.Texture(e.BaseTexture.fromImage(a,b,c)),e.TextureCache[a]=d),d},e.Texture.fromFrame=function(a){var b=e.TextureCache[a];if(!b)throw new Error('The frameId "'+a+'" does not exist in the texture cache ');return b},e.Texture.fromCanvas=function(a,b){var c=e.BaseTexture.fromCanvas(a,b);return new e.Texture(c)},e.Texture.addTextureToCache=function(a,b){e.TextureCache[b]=a},e.Texture.removeTextureFromCache=function(a){var b=e.TextureCache[a];return delete e.TextureCache[a],delete e.BaseTextureCache[a],b},e.Texture.frameUpdates=[],e.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},e.RenderTexture=function(a,b,c,d){if(e.EventTarget.call(this),this.width=a||100,this.height=b||100,this.frame=new e.Rectangle(0,0,this.width,this.height),this.crop=new e.Rectangle(0,0,this.width,this.height),this.baseTexture=new e.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTextures=[],this.baseTexture.scaleMode=d||e.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,this.renderer=c||e.defaultRenderer,this.renderer.type===e.WEBGL_RENDERER){var f=this.renderer.gl;this.textureBuffer=new e.FilterTexture(f,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[f.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new e.Point(this.width/2,-this.height/2)}else this.render=this.renderCanvas,this.textureBuffer=new e.CanvasBuffer(this.width,this.height),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,e.Texture.frameUpdates.push(this)},e.RenderTexture.prototype=Object.create(e.Texture.prototype),e.RenderTexture.prototype.constructor=e.RenderTexture,e.RenderTexture.prototype.resize=function(a,b,c){(a!==this.width||b!==this.height)&&(this.width=this.frame.width=this.crop.width=a,this.height=this.frame.height=this.crop.height=b,c&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.renderer.type===e.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.textureBuffer.resize(this.width,this.height))},e.RenderTexture.prototype.clear=function(){this.renderer.type===e.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear()},e.RenderTexture.prototype.renderWebGL=function(a,b,c){var d=this.renderer.gl;d.colorMask(!0,!0,!0,!0),d.viewport(0,0,this.width,this.height),d.bindFramebuffer(d.FRAMEBUFFER,this.textureBuffer.frameBuffer),c&&this.textureBuffer.clear();var f=a.children,g=a.worldTransform;a.worldTransform=e.RenderTexture.tempMatrix,a.worldTransform.d=-1,a.worldTransform.ty=-2*this.projection.y,b&&(a.worldTransform.tx=b.x,a.worldTransform.ty-=b.y);for(var h=0,i=f.length;i>h;h++)f[h].updateTransform();e.WebGLRenderer.updateTextures(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(a,this.projection,this.textureBuffer.frameBuffer),a.worldTransform=g,this.renderer.spriteBatch.dirty=!0},e.RenderTexture.prototype.renderCanvas=function(a,b,c){var d=a.children,f=a.worldTransform;a.worldTransform=e.RenderTexture.tempMatrix,b?(a.worldTransform.tx=b.x,a.worldTransform.ty=b.y):(a.worldTransform.tx=0,a.worldTransform.ty=0);for(var g=0,h=d.length;h>g;g++)d[g].updateTransform();c&&this.textureBuffer.clear();var i=this.textureBuffer.context;this.renderer.renderDisplayObject(a,i),i.setTransform(1,0,0,1,0,0),a.worldTransform=f},e.RenderTexture.tempMatrix=new e.Matrix,e.AssetLoader=function(a,b){e.EventTarget.call(this),this.assetURLs=a,this.crossorigin=b,this.loadersByType={jpg:e.ImageLoader,jpeg:e.ImageLoader,png:e.ImageLoader,gif:e.ImageLoader,webp:e.ImageLoader,json:e.JsonLoader,atlas:e.AtlasLoader,anim:e.SpineLoader,xml:e.BitmapFontLoader,fnt:e.BitmapFontLoader}},e.AssetLoader.prototype.constructor=e.AssetLoader,e.AssetLoader.prototype._getDataType=function(a){var b="data:",c=a.slice(0,b.length).toLowerCase();if(c===b){var d=a.slice(b.length),e=d.indexOf(",");if(-1===e)return null;var f=d.slice(0,e).split(";")[0];return f&&"text/plain"!==f.toLowerCase()?f.split("/").pop().toLowerCase():"txt"}return null},e.AssetLoader.prototype.load=function(){function a(a){b.onAssetLoaded(a.content)}var b=this;this.loadCount=this.assetURLs.length;for(var c=0;c<this.assetURLs.length;c++){var d=this.assetURLs[c],e=this._getDataType(d);e||(e=d.split("?").shift().split(".").pop().toLowerCase());var f=this.loadersByType[e];if(!f)throw new Error(e+" is an unsupported file type");var g=new f(d,this.crossorigin);g.addEventListener("loaded",a),g.load()}},e.AssetLoader.prototype.onAssetLoaded=function(a){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this,loader:a}),this.onProgress&&this.onProgress(a),this.loadCount||(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},e.JsonLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.crossorigin=b,this.baseUrl=a.replace(/[^\/]*$/,""),this.loaded=!1},e.JsonLoader.prototype.constructor=e.JsonLoader,e.JsonLoader.prototype.load=function(){var a=this;window.XDomainRequest&&a.crossorigin?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=function(){a.onError()},this.ajaxRequest.ontimeout=function(){a.onError()},this.ajaxRequest.onprogress=function(){}):window.XMLHttpRequest?this.ajaxRequest=new window.XMLHttpRequest:this.ajaxRequest=new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onload=function(){a.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.send()},e.JsonLoader.prototype.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return void this.onError();if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames){var a=this,b=this.baseUrl+this.json.meta.image,c=new e.ImageLoader(b,this.crossorigin),d=this.json.frames;this.texture=c.texture.baseTexture,c.addEventListener("loaded",function(){a.onLoaded()});for(var f in d){var g=d[f].frame;if(g&&(e.TextureCache[f]=new e.Texture(this.texture,{x:g.x,y:g.y,width:g.w,height:g.h}),e.TextureCache[f].crop=new e.Rectangle(g.x,g.y,g.w,g.h),d[f].trimmed)){var h=d[f].sourceSize,j=d[f].spriteSourceSize;e.TextureCache[f].trim=new e.Rectangle(j.x,j.y,h.w,h.h)}}c.load()}else if(this.json.bones){var k=new i.SkeletonJson,l=k.readSkeletonData(this.json);e.AnimCache[this.url]=l,this.onLoaded()}else this.onLoaded()},e.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.AtlasLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.baseUrl=a.replace(/[^\/]*$/,""),this.crossorigin=b,this.loaded=!1},e.AtlasLoader.constructor=e.AtlasLoader,e.AtlasLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},e.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};var a=this.ajaxRequest.responseText.split(/\r?\n/),b=-3,c=0,d=null,f=!1,g=0,h=0,i=this.onLoaded.bind(this);for(g=0;g<a.length;g++)if(a[g]=a[g].replace(/^\s+|\s+$/g,""),""===a[g]&&(f=g+1),a[g].length>0){if(f===g)this.atlas.meta.image.push(a[g]),c=this.atlas.meta.image.length-1,this.atlas.frames.push({}),b=-3;else if(b>0)if(b%7===1)null!=d&&(this.atlas.frames[c][d.name]=d),d={name:a[g],frame:{}};else{var j=a[g].split(" ");if(b%7===3)d.frame.x=Number(j[1].replace(",","")),d.frame.y=Number(j[2]);else if(b%7===4)d.frame.w=Number(j[1].replace(",","")),d.frame.h=Number(j[2]);else if(b%7===5){var k={x:0,y:0,w:Number(j[1].replace(",","")),h:Number(j[2])};k.w>d.frame.w||k.h>d.frame.h?(d.trimmed=!0,d.realSize=k):d.trimmed=!1}}b++}if(null!=d&&(this.atlas.frames[c][d.name]=d),this.atlas.meta.image.length>0){for(this.images=[],h=0;h<this.atlas.meta.image.length;h++){var l=this.baseUrl+this.atlas.meta.image[h],m=this.atlas.frames[h];this.images.push(new e.ImageLoader(l,this.crossorigin));for(g in m){var n=m[g].frame;n&&(e.TextureCache[g]=new e.Texture(this.images[h].texture.baseTexture,{x:n.x,y:n.y,width:n.w,height:n.h}),m[g].trimmed&&(e.TextureCache[g].realSize=m[g].realSize,e.TextureCache[g].trim.x=0,e.TextureCache[g].trim.y=0))}}for(this.currentImageId=0,h=0;h<this.images.length;h++)this.images[h].addEventListener("loaded",i);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},e.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.dispatchEvent({type:"loaded",content:this}))},e.AtlasLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},e.SpriteSheetLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.crossorigin=b,this.baseUrl=a.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},e.SpriteSheetLoader.prototype.constructor=e.SpriteSheetLoader,e.SpriteSheetLoader.prototype.load=function(){var a=this,b=new e.JsonLoader(this.url,this.crossorigin);b.addEventListener("loaded",function(b){a.json=b.content.json,a.onLoaded()}),b.load()},e.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader=function(a,b){e.EventTarget.call(this),this.texture=e.Texture.fromImage(a,b),this.frames=[]},e.ImageLoader.prototype.constructor=e.ImageLoader,e.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var a=this;this.texture.baseTexture.addEventListener("loaded",function(){a.onLoaded()})}},e.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.ImageLoader.prototype.loadFramedSpriteSheet=function(a,b,c){this.frames=[];for(var d=Math.floor(this.texture.width/a),f=Math.floor(this.texture.height/b),g=0,h=0;f>h;h++)for(var i=0;d>i;i++,g++){var j=new e.Texture(this.texture,{x:i*a,y:h*b,width:a,height:b});this.frames.push(j),c&&(e.TextureCache[c+"-"+g]=j)}if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var k=this;this.texture.baseTexture.addEventListener("loaded",function(){k.onLoaded()})}},e.BitmapFontLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.crossorigin=b,this.baseUrl=a.replace(/[^\/]*$/,""),this.texture=null},e.BitmapFontLoader.prototype.constructor=e.BitmapFontLoader,e.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new e.AjaxRequest;var a=this;this.ajaxRequest.onreadystatechange=function(){a.onXMLLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},e.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var a=this.ajaxRequest.responseXML;if(!a||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){var b=new DOMParser;a=b.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var c=document.createElement("div");c.innerHTML=this.ajaxRequest.responseText,a=c}var d=this.baseUrl+a.getElementsByTagName("page")[0].getAttribute("file"),f=new e.ImageLoader(d,this.crossorigin);this.texture=f.texture.baseTexture;var g={},h=a.getElementsByTagName("info")[0],i=a.getElementsByTagName("common")[0];g.font=h.getAttribute("face"),g.size=parseInt(h.getAttribute("size"),10),g.lineHeight=parseInt(i.getAttribute("lineHeight"),10),g.chars={};for(var j=a.getElementsByTagName("char"),k=0;k<j.length;k++){var l=parseInt(j[k].getAttribute("id"),10),m=new e.Rectangle(parseInt(j[k].getAttribute("x"),10),parseInt(j[k].getAttribute("y"),10),parseInt(j[k].getAttribute("width"),10),parseInt(j[k].getAttribute("height"),10));g.chars[l]={xOffset:parseInt(j[k].getAttribute("xoffset"),10),yOffset:parseInt(j[k].getAttribute("yoffset"),10),xAdvance:parseInt(j[k].getAttribute("xadvance"),10),kerning:{},texture:e.TextureCache[l]=new e.Texture(this.texture,m)}}var n=a.getElementsByTagName("kerning");for(k=0;k<n.length;k++){var o=parseInt(n[k].getAttribute("first"),10),p=parseInt(n[k].getAttribute("second"),10),q=parseInt(n[k].getAttribute("amount"),10);g.chars[p].kerning[o]=q}e.BitmapText.fonts[g.font]=g;var r=this;f.addEventListener("loaded",function(){r.onLoaded()}),f.load()}},e.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.SpineLoader=function(a,b){e.EventTarget.call(this),this.url=a,this.crossorigin=b,this.loaded=!1},e.SpineLoader.prototype.constructor=e.SpineLoader,e.SpineLoader.prototype.load=function(){var a=this,b=new e.JsonLoader(this.url,this.crossorigin);b.addEventListener("loaded",function(b){a.json=b.content.json,a.onLoaded()}),b.load()},e.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},e.AbstractFilter=function(a,b){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=b||{},this.fragmentSrc=a||[]},e.AlphaMaskFilter=function(a){e.AbstractFilter.call(this),this.passes=[this],a.baseTexture._powerOf2=!0,this.uniforms={mask:{type:"sampler2D",value:a},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},a.baseTexture.hasLoaded?(this.uniforms.mask.value.x=a.width,this.uniforms.mask.value.y=a.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),a.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]},e.AlphaMaskFilter.prototype=Object.create(e.AbstractFilter.prototype),e.AlphaMaskFilter.prototype.constructor=e.AlphaMaskFilter,e.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height,this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(a){this.uniforms.mask.value=a}}),e.ColorMatrixFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]},e.ColorMatrixFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorMatrixFilter.prototype.constructor=e.ColorMatrixFilter,Object.defineProperty(e.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(a){this.uniforms.matrix.value=a}}),e.GrayFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={gray:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]},e.GrayFilter.prototype=Object.create(e.AbstractFilter.prototype),e.GrayFilter.prototype.constructor=e.GrayFilter,Object.defineProperty(e.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(a){this.uniforms.gray.value=a}}),e.DisplacementFilter=function(a){e.AbstractFilter.call(this),this.passes=[this],a.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:a},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},a.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=a.width,this.uniforms.mapDimensions.value.y=a.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),a.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]},e.DisplacementFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DisplacementFilter.prototype.constructor=e.DisplacementFilter,e.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(e.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(a){this.uniforms.displacementMap.value=a}}),Object.defineProperty(e.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.uniforms.scale.value=a}}),Object.defineProperty(e.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(a){this.uniforms.offset.value=a}}),e.PixelateFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]},e.PixelateFilter.prototype=Object.create(e.AbstractFilter.prototype),e.PixelateFilter.prototype.constructor=e.PixelateFilter,Object.defineProperty(e.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(a){this.dirty=!0,this.uniforms.pixelSize.value=a}}),e.BlurXFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurXFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurXFilter.prototype.constructor=e.BlurXFilter,Object.defineProperty(e.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.dirty=!0,this.uniforms.blur.value=1/7e3*a}}),e.BlurYFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]},e.BlurYFilter.prototype=Object.create(e.AbstractFilter.prototype),e.BlurYFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.uniforms.blur.value=1/7e3*a}}),e.BlurFilter=function(){this.blurXFilter=new e.BlurXFilter,this.blurYFilter=new e.BlurYFilter,this.passes=[this.blurXFilter,this.blurYFilter]},Object.defineProperty(e.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=this.blurYFilter.blur=a}}),Object.defineProperty(e.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(a){this.blurXFilter.blur=a}}),Object.defineProperty(e.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(a){this.blurYFilter.blur=a}}),e.InvertFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]},e.InvertFilter.prototype=Object.create(e.AbstractFilter.prototype),e.InvertFilter.prototype.constructor=e.InvertFilter,Object.defineProperty(e.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(a){this.uniforms.invert.value=a}}),e.SepiaFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={sepia:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]},e.SepiaFilter.prototype=Object.create(e.AbstractFilter.prototype),e.SepiaFilter.prototype.constructor=e.SepiaFilter,Object.defineProperty(e.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(a){this.uniforms.sepia.value=a}}),e.TwistFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]},e.TwistFilter.prototype=Object.create(e.AbstractFilter.prototype),e.TwistFilter.prototype.constructor=e.TwistFilter,Object.defineProperty(e.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(a){this.dirty=!0,this.uniforms.offset.value=a}}),Object.defineProperty(e.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(a){this.dirty=!0,this.uniforms.radius.value=a}}),Object.defineProperty(e.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(a){this.dirty=!0,this.uniforms.angle.value=a}}),e.ColorStepFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={step:{type:"1f",value:5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]},e.ColorStepFilter.prototype=Object.create(e.AbstractFilter.prototype),e.ColorStepFilter.prototype.constructor=e.ColorStepFilter,Object.defineProperty(e.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(a){this.uniforms.step.value=a}}),e.DotScreenFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]},e.DotScreenFilter.prototype=Object.create(e.AbstractFilter.prototype),e.DotScreenFilter.prototype.constructor=e.DotScreenFilter,Object.defineProperty(e.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(a){this.dirty=!0,this.uniforms.scale.value=a}}),Object.defineProperty(e.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(a){this.dirty=!0,this.uniforms.angle.value=a}}),e.CrossHatchFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]},e.CrossHatchFilter.prototype=Object.create(e.AbstractFilter.prototype),e.CrossHatchFilter.prototype.constructor=e.BlurYFilter,Object.defineProperty(e.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.uniforms.blur.value=1/7e3*a}}),e.RGBSplitFilter=function(){e.AbstractFilter.call(this),this.passes=[this],this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]},e.RGBSplitFilter.prototype=Object.create(e.AbstractFilter.prototype),e.RGBSplitFilter.prototype.constructor=e.RGBSplitFilter,Object.defineProperty(e.RGBSplitFilter.prototype,"angle",{
get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(a){this.uniforms.blur.value=1/7e3*a}}),"undefined"!=typeof d?("undefined"!=typeof c&&c.exports&&(d=c.exports=e),d.PIXI=e):"undefined"!=typeof a&&a.amd?a(e):b.PIXI=e}).call(this)},{}],9:[function(a,b,c){(function(){function c(){this.listenerMap={}}function d(a){f.DisplayObjectContainer.call(this),this.contentWidth=100,this.contentHeight=100,this.screenWidth=100,this.screenHeight=100,this.theMask=null,a&&this.setContent(a),this.verticalAlign=d.MIDDLE,this.horizontalAlign=d.CENTER,this.scaleMode=d.SHOW_ALL,this.minScale=-1,this.maxScale=-1,this.maskContentEnabled=!1,this.maskColor=0}function e(a,b){f.DisplayObjectContainer.call(this),this._applicationWidth=a,this._applicationHeight=b,this._backgroundColor=16777215,setTimeout(this.onCheckReadyTimeout.bind(this),0),this.contentScaler=new d(this)}var f;f="undefined"!=typeof b?a("pixi.js"):window.PIXI,c.prototype.addEventListener=function(a,b,c){if(this.listenerMap||(this.listenerMap={}),!a)throw new Error("Event type required for event dispatcher");if(!b)throw new Error("Listener required for event dispatcher");this.removeEventListener(a,b,c),this.listenerMap.hasOwnProperty(a)||(this.listenerMap[a]=[]),this.listenerMap[a].push({listener:b,scope:c})},c.prototype.removeEventListener=function(a,b,c){if(this.listenerMap||(this.listenerMap={}),this.listenerMap.hasOwnProperty(a)){for(var d=this.listenerMap[a],e=0;e<d.length;e++){var f=d[e];b==f.listener&&c==f.scope&&(d.splice(e,1),e--)}d.length||delete this.listenerMap[a]}},c.prototype.dispatchEvent=function(a){this.listenerMap||(this.listenerMap={});var b,c;if("string"==typeof a?(b=a,c=Array.prototype.slice.call(arguments,1)):(b=a.type,a.target=this,c=[a]),this.listenerMap.hasOwnProperty(b))for(var d in this.listenerMap[b]){var e=this.listenerMap[b][d];e.listener.apply(e.scope,c)}},c.prototype.on=c.prototype.addEventListener,c.prototype.off=c.prototype.removeEventListener,c.prototype.trigger=c.prototype.dispatchEvent,c.init=function(a){a.prototype.addEventListener=c.prototype.addEventListener,a.prototype.removeEventListener=c.prototype.removeEventListener,a.prototype.dispatchEvent=c.prototype.dispatchEvent,a.prototype.on=c.prototype.on,a.prototype.off=c.prototype.off,a.prototype.trigger=c.prototype.trigger},"undefined"!=typeof b&&(b.exports=c),d.prototype=Object.create(f.DisplayObjectContainer.prototype),d.prototype.constructor=d,d.TOP="top",d.MIDDLE="middle",d.BOTTOM="bottom",d.LEFT="left",d.CENTER="center",d.RIGHT="right",d.NO_BORDER="noBorder",d.NO_SCALE="noScale",d.SHOW_ALL="showAll",d.prototype.setMaskContentEnabled=function(a){this.maskContentEnabled=a,this.updateScale()},d.prototype.setMaskColor=function(a){this.maskColor=a,this.updateScale()},d.prototype.setMinScale=function(a){this.minScale=a,this.updateScale()},d.prototype.setMaxScale=function(a){this.maxScale=a,this.updateScale()},d.prototype.setContent=function(a){if(this.content)throw new Error("Content already set.");this.content=a,this.addChild(this.content),this.theMask&&(this.removeChild(this.theMask),this.theMask=null),this.theMask=new f.Graphics,this.addChild(this.theMask),this.updateScale()},d.prototype.setContentSize=function(a,b){this.contentWidth=a,this.contentHeight=b,this.updateScale()},d.prototype.setScreenSize=function(a,b){this.screenWidth=a,this.screenHeight=b,this.updateScale()},d.prototype.setVerticalAlign=function(a){this.verticalAlign=a,this.updateScale()},d.prototype.setHorizontalAlign=function(a){this.horizontalAlign=a,this.updateScale()},d.prototype.setScaleMode=function(a){this.scaleMode=a,this.updateScale()},d.prototype.updateScale=function(){var a;a=this.scaleMode==d.NO_SCALE?1:this.scaleMode==d.NO_BORDER?this.screenWidth/this.contentWidth>this.screenHeight/this.contentHeight?this.screenWidth/this.contentWidth:this.screenHeight/this.contentHeight:this.screenWidth/this.contentWidth<this.screenHeight/this.contentHeight?this.screenWidth/this.contentWidth:this.screenHeight/this.contentHeight,this.minScale>0&&a<this.minScale&&(a=this.minScale),this.maxScale>0&&a>this.maxScale&&(a=this.maxScale),this.content.scale.x=a,this.content.scale.y=a;var b=this.contentWidth*a,c=this.contentHeight*a;this.content.position.x=(this.screenWidth-b)/2,this.verticalAlign==d.TOP?this.content.position.y=0:this.verticalAlign==d.BOTTOM?this.content.position.y=this.screenHeight-c:this.content.position.y=(this.screenHeight-c)/2,this.horizontalAlign==d.LEFT?this.content.position.x=0:this.horizontalAlign==d.RIGHT?this.content.position.x=this.screenWidth-b:this.content.position.x=(this.screenWidth-b)/2;var e=new f.Rectangle(this.content.position.x,this.content.position.y,b,c),g=e.x+e.width,h=e.y+e.height;this.theMask.clear(),this.maskContentEnabled&&(this.theMask.beginFill(this.maskColor,1),this.theMask.drawRect(0,0,this.screenWidth,e.y),this.theMask.drawRect(0,0,e.x,this.screenHeight),this.theMask.drawRect(g,0,this.screenWidth-g,this.screenHeight),this.theMask.drawRect(0,h,this.screenWidth,this.screenHeight-h),this.theMask.endFill())},d.prototype.getVisibleRect=function(){var a=-this.content.position.x/this.content.scale.x,b=-this.content.position.y/this.content.scale.y,c=this.screenWidth/this.content.scale.x,d=this.screenHeight/this.content.scale.y;return new f.Rectangle(a,b,c,d)},e.prototype=Object.create(f.DisplayObjectContainer.prototype),e.prototype.constructor=e,c.init(e),e.TOP=d.TOP,e.MIDDLE=d.MIDDLE,e.BOTTOM=d.BOTTOM,e.LEFT=d.LEFT,e.CENTER=d.CENTER,e.RIGHT=d.RIGHT,e.NO_BORDER=d.NO_BORDER,e.NO_SCALE=d.NO_SCALE,e.SHOW_ALL=d.SHOW_ALL,e.prototype.onCheckReadyTimeout=function(){return this.attachedToElement?void 0:document.body?void this.attachToElement(document.body):void setTimeout(this.onCheckReadyTimeout.bind(this),0)},e.prototype.attachToElement=function(a){if(this.attachedToElement)throw new Error("Already attached!");if("string"==typeof a&&(a=document.getElementById(a)),!a)throw new Error("That's not an element!");this.containerElement=a,this.attachedToElement=!0;var b;b=navigator.isCocoonJS?document.createElement("screencanvas"):document.createElement("canvas"),b.style.margin=0,b.style.padding=0,this.containerElement==document.body&&(b.style.position="fixed",document.body.style.margin=0,document.body.style.padding=0,document.body.style.overflow="hidden",document.body.onresize=this.onWindowResize.bind(this),window.onresize=this.onWindowResize.bind(this)),this.renderer=new f.autoDetectRenderer(this.getElementWidth(),this.getElementHeight(),b),this.containerElement.appendChild(this.renderer.view),this.stage=new f.Stage(this._backgroundColor),this.updateContentScaler(),this.stage.addChild(this.contentScaler),this.renderer.render(this.stage),this.sizeDirty=!1,window.requestAnimationFrame(this.onAnimationFrame.bind(this)),this.trigger("resize")},e.prototype.updateContentScaler=function(){this.contentScaler.setContentSize(this._applicationWidth,this._applicationHeight),this.contentScaler.setScreenSize(this.getElementWidth(),this.getElementHeight())},e.prototype.onAnimationFrame=function(a){this.sizeDirty&&(this.updateContentScaler(),this.renderer.resize(this.getElementWidth(),this.getElementHeight()),this.sizeDirty=!1),this.trigger("frame",a),this.renderer.render(this.stage),window.requestAnimationFrame(this.onAnimationFrame.bind(this))},e.prototype.onWindowResize=function(){this.sizeDirty=!0,this.trigger("resize")},e.prototype.getElementHeight=function(){return this.containerElement==document.body?window.innerHeight:this.containerElement.clientHeight},e.prototype.getElementWidth=function(){return this.containerElement==document.body?window.innerWidth:this.containerElement.clientWidth},Object.defineProperty(e.prototype,"applicationWidth",{get:function(){return this._applicationWidth},set:function(a){this._applicationWidth=a,this.sizeDirty=!0}}),Object.defineProperty(e.prototype,"applicationHeight",{get:function(){return this._applicationHeight},set:function(a){this._applicationHeight=a,this.sizeDirty=!0}}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this.contentScaler.verticalAlign},set:function(a){this.contentScaler.setVerticalAlign(a)}}),Object.defineProperty(e.prototype,"horizontalAlign",{get:function(){return this.contentScaler.horizontalAlign},set:function(a){this.contentScaler.setHorizontalAlign(a)}}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this.contentScaler.scaleMode},set:function(a){this.contentScaler.setScaleMode(a)}}),Object.defineProperty(e.prototype,"minScale",{get:function(){return this.contentScaler.minScale},set:function(a){this.contentScaler.setMinScale(a)}}),Object.defineProperty(e.prototype,"maxScale",{get:function(){return this.contentScaler.maxScale},set:function(a){this.contentScaler.setMaxScale(a)}}),Object.defineProperty(e.prototype,"matte",{get:function(){return this.contentScaler.maskContentEnabled},set:function(a){this.contentScaler.setMaskContentEnabled(a)}}),Object.defineProperty(e.prototype,"matteColor",{get:function(){return this.contentScaler.maskColor},set:function(a){this.contentScaler.setMaskColor(a)}}),Object.defineProperty(e.prototype,"visibleRect",{get:function(){return this.sizeDirty&&(this.updateContentScaler(),this.renderer.resize(this.getElementWidth(),this.getElementHeight()),this.sizeDirty=!1),this.contentScaler.getVisibleRect()}}),Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a,this.stage&&this.stage.setBackgroundColor(this._backgroundColor)}}),"undefined"!=typeof b?b.exports=e:window.PixiApp=e}).call(this)},{"pixi.js":8}],10:[function(a,b,c){var d=a("./src/PixiTextInput");b.exports=d},{"./src/PixiTextInput":11}],11:[function(a,b,c){function d(a,b){if(PIXI.DisplayObjectContainer.call(this),a||(a=""),a=a.toString(),b&&b.wordWrap)throw"wordWrap is not supported for input fields";this._text=a,this.localWidth=100,this._backgroundColor=16777215,this._caretColor=0,this._background=!0,this.style=b,this.textField=new PIXI.Text(this._text,b),this.localHeight=this.textField.determineFontHeight("font: "+this.textField.style.font+";")+this.textField.style.strokeThickness,this.backgroundGraphics=new PIXI.Graphics,this.textFieldMask=new PIXI.Graphics,this.caret=new PIXI.Graphics,this.drawElements(),this.addChild(this.backgroundGraphics),this.addChild(this.textField),this.addChild(this.caret),this.addChild(this.textFieldMask),this.scrollIndex=0,this._caretIndex=0,this.caretFlashInterval=null,this.blur(),this.updateCaretPosition(),this.backgroundGraphics.interactive=!0,this.backgroundGraphics.buttonMode=!0,this.backgroundGraphics.defaultCursor="text",this.backgroundGraphics.mousedown=this.onBackgroundMouseDown.bind(this),this.keyEventClosure=this.onKeyEvent.bind(this),this.windowBlurClosure=this.onWindowBlur.bind(this),this.documentMouseDownClosure=this.onDocumentMouseDown.bind(this),this.isFocusClick=!1,this.updateText(),this.textField.mask=this.textFieldMask,this.keypress=null,this.keydown=null,this.change=null}"undefined"!=typeof b&&(PIXI=a("pixi.js")),d.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),d.prototype.constructor=d,d.prototype.onBackgroundMouseDown=function(a){var b=a.getLocalPosition(this).x;this._caretIndex=this.getCaretIndexByCoord(b),this.updateCaretPosition(),this.focus(),this.isFocusClick=!0;var c=this;setTimeout(function(){c.isFocusClick=!1},0)},d.prototype.focus=function(){this.blur(),document.addEventListener("keydown",this.keyEventClosure),document.addEventListener("keypress",this.keyEventClosure),document.addEventListener("mousedown",this.documentMouseDownClosure),window.addEventListener("blur",this.windowBlurClosure),this.showCaret()},d.prototype.onKeyEvent=function(a){if("keypress"==a.type){if(a.charCode<32)return;this._text=this._text.substring(0,this._caretIndex)+String.fromCharCode(a.charCode)+this._text.substring(this._caretIndex),this._caretIndex++,this.ensureCaretInView(),this.showCaret(),this.updateText(),this.trigger(this.keypress,a),this.trigger(this.change)}if("keydown"==a.type){switch(a.keyCode){case 8:this._caretIndex>0&&(this._text=this._text.substring(0,this._caretIndex-1)+this._text.substring(this._caretIndex),this._caretIndex--,this.ensureCaretInView(),this.showCaret(),this.updateText()),a.preventDefault(),this.trigger(this.change);break;case 46:this._text=this._text.substring(0,this._caretIndex)+this._text.substring(this._caretIndex+1),this.ensureCaretInView(),this.updateCaretPosition(),this.showCaret(),this.updateText(),a.preventDefault(),this.trigger(this.change);break;case 39:this._caretIndex++,this._caretIndex>this._text.length&&(this._caretIndex=this._text.length),this.ensureCaretInView(),this.updateCaretPosition(),this.showCaret(),this.updateText();break;case 37:this._caretIndex--,this._caretIndex<0&&(this._caretIndex=0),this.ensureCaretInView(),this.updateCaretPosition(),this.showCaret(),this.updateText()}this.trigger(this.keydown,a)}},d.prototype.ensureCaretInView=function(){for(this.updateCaretPosition();this.caret.position.x>=this.localWidth-1;)this.scrollIndex++,this.updateCaretPosition();for(;this.caret.position.x<0;)this.scrollIndex-=2,this.scrollIndex<0&&(this.scrollIndex=0),this.updateCaretPosition()},d.prototype.blur=function(){document.removeEventListener("keydown",this.keyEventClosure),document.removeEventListener("keypress",this.keyEventClosure),document.removeEventListener("mousedown",this.documentMouseDownClosure),window.removeEventListener("blur",this.windowBlurClosure),this.hideCaret()},d.prototype.onDocumentMouseDown=function(){this.isFocusClick||this.blur()},d.prototype.onWindowBlur=function(){this.blur()},d.prototype.updateCaretPosition=function(){if(this._caretIndex<this.scrollIndex)return void(this.caret.position.x=-1);var a=this._text.substring(0,this._caretIndex).substring(this.scrollIndex);this.caret.position.x=this.textField.context.measureText(a).width},d.prototype.updateText=function(){this.textField.setText(this._text.substring(this.scrollIndex))},d.prototype.drawElements=function(){this.backgroundGraphics.clear(),this.backgroundGraphics.beginFill(this._backgroundColor),this._background&&this.backgroundGraphics.drawRect(0,0,this.localWidth,this.localHeight),this.backgroundGraphics.endFill(),this.backgroundGraphics.hitArea=new PIXI.Rectangle(0,0,this.localWidth,this.localHeight),this.textFieldMask.clear(),this.textFieldMask.beginFill(this._backgroundColor),this.textFieldMask.drawRect(0,0,this.localWidth,this.localHeight),this.textFieldMask.endFill(),this.caret.clear(),this.caret.beginFill(this._caretColor),this.caret.drawRect(1,1,1,this.localHeight-2),this.caret.endFill()},d.prototype.showCaret=function(){this.caretFlashInterval&&(clearInterval(this.caretFlashInterval),this.caretFlashInterval=null),this.caret.visible=!0,this.caretFlashInterval=setInterval(this.onCaretFlashInterval.bind(this),500)},d.prototype.hideCaret=function(){this.caretFlashInterval&&(clearInterval(this.caretFlashInterval),this.caretFlashInterval=null),this.caret.visible=!1},d.prototype.onCaretFlashInterval=function(){this.caret.visible=!this.caret.visible},d.prototype.getCaretIndexByCoord=function(a){var b=1e4,c=0,d=this._text.substring(this.scrollIndex);for(i=0;i<d.length+1;i++){var e=d.substring(0,i),f=this.textField.context.measureText(e).width;Math.abs(f-a)<b&&(b=Math.abs(f-a),c=i)}return this.scrollIndex+c},Object.defineProperty(d.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(a){this.localWidth=a,this.drawElements(),this.ensureCaretInView(),this.updateText()}}),Object.defineProperty(d.prototype,"text",{get:function(){return this._text},set:function(a){this._text=a.toString(),this.scrollIndex=0,this.caretIndex=0,this.blur(),this.updateText()}}),Object.defineProperty(d.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(a){this._backgroundColor=a,this.drawElements()}}),Object.defineProperty(d.prototype,"caretColor",{get:function(){return this._caretColor},set:function(a){this._caretColor=a,this.drawElements()}}),Object.defineProperty(d.prototype,"background",{get:function(){return this._background},set:function(a){this._background=a,this.drawElements()}}),d.prototype.setText=function(a){this.text=a},d.prototype.trigger=function(a,b){a&&a(b)},"undefined"!=typeof b&&(b.exports=d)},{"pixi.js":8}],12:[function(a,b,c){(function(a){function c(){return this instanceof c?(this.decided=!1,void(this.handlersUsed=!1)):new c}c.prototype.then=function(a,b){if(this.handlersUsed)throw new Error("Handlers already registered or called.");this.handlersUsed=!0,this.resolutionHandler=a,this.rejectionHandler=b},c.prototype.resolve=function(b){if(this.decided)throw new Error("Already decided.");this.decided=!0,a.nextTick(this.callHandler.bind(this,!0,b))},c.prototype.reject=function(b){if(this.decided)throw new Error("Already decided.");this.decided=!0,a.nextTick(this.callHandler.bind(this,!1,b))},c.prototype.callHandler=function(a,b){this.handlersUsed=!0;var c;if(c=a?this.resolutionHandler:this.rejectionHandler)try{c(b)}catch(d){throw console.error("Unhandled: "+d),console.log(d.stack),d}},c.resolved=function(a){var b=new c;return b.resolve(a),b},c.rejected=function(a){var b=new c;return b.reject(a),b},c.all=function(){function a(){h++,!g&&h>=f.length&&(g=!0,e.resolve())}function b(a){g||(g=!0,e.reject(a))}var d,e=new c,f=[],g=!1,h=0;for(d=0;d<arguments.length;d++)f=f.concat(arguments[d]);for(d=0;d<f.length;d++)f[d].then(a,b);return e},c.race=function(){function a(){h++,!g&&h>=f.length&&(g=!0,e.reject())}function b(a){g||(g=!0,e.resolve(a))}var d,e=new c,f=[],g=!1,h=0;for(d=0;d<arguments.length;d++)f=f.concat(arguments[d]);for(d=0;d<f.length;d++)f[d].then(b,a);return e},c.resolved=function(a){var b=new c;return b.resolve(a),b},c.rejected=function(a){var b=new c;return b.reject(a),b},b.exports=c}).call(this,a("_process"))},{_process:1}],13:[function(a,b,c){void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var d=d||function(){var a=[];return{REVISION:"14",getAll:function(){return a},removeAll:function(){a=[]},add:function(b){a.push(b)},remove:function(b){var c=a.indexOf(b);-1!==c&&a.splice(c,1)},update:function(b){if(0===a.length)return!1;var c=0;for(b=void 0!==b?b:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();c<a.length;)a[c].update(b)?c++:a.splice(c,1);return!0}}}();d.Tween=function(a){var b=a,c={},e={},f={},g=1e3,h=0,i=!1,j=!1,k=!1,l=0,m=null,n=d.Easing.Linear.None,o=d.Interpolation.Linear,p=[],q=null,r=!1,s=null,t=null,u=null;for(var v in a)c[v]=parseFloat(a[v],10);this.to=function(a,b){return void 0!==b&&(g=b),e=a,this},this.start=function(a){d.add(this),j=!0,r=!1,m=void 0!==a?a:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),m+=l;for(var g in e){if(e[g]instanceof Array){if(0===e[g].length)continue;e[g]=[b[g]].concat(e[g])}c[g]=b[g],c[g]instanceof Array==!1&&(c[g]*=1),f[g]=c[g]||0}return this},this.stop=function(){return j?(d.remove(this),j=!1,null!==u&&u.call(b),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var a=0,b=p.length;b>a;a++)p[a].stop()},this.delay=function(a){return l=a,this},this.repeat=function(a){return h=a,this},this.yoyo=function(a){return i=a,this},this.easing=function(a){return n=a,this},this.interpolation=function(a){return o=a,this},this.chain=function(){return p=arguments,this},this.onStart=function(a){return q=a,this},this.onUpdate=function(a){return s=a,this},this.onComplete=function(a){return t=a,this},this.onStop=function(a){return u=a,this},this.update=function(a){var d;if(m>a)return!0;r===!1&&(null!==q&&q.call(b),r=!0);var j=(a-m)/g;j=j>1?1:j;var u=n(j);for(d in e){var v=c[d]||0,w=e[d];w instanceof Array?b[d]=o(w,u):("string"==typeof w&&(w=v+parseFloat(w,10)),"number"==typeof w&&(b[d]=v+(w-v)*u))}if(null!==s&&s.call(b,u),1==j){if(h>0){isFinite(h)&&h--;for(d in f){if("string"==typeof e[d]&&(f[d]=f[d]+parseFloat(e[d],10)),i){var x=f[d];f[d]=e[d],e[d]=x}c[d]=f[d]}return i&&(k=!k),m=a+l,!0}null!==t&&t.call(b);for(var y=0,z=p.length;z>y;y++)p[y].start(a);return!1}return!0}},d.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return(a*=2)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:(a*=2)<1?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){var b,c=.1,d=.4;return 0===a?0:1===a?1:(!c||1>c?(c=1,b=d/4):b=d*Math.asin(1/c)/(2*Math.PI),-(c*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/d)))},Out:function(a){var b,c=.1,d=.4;return 0===a?0:1===a?1:(!c||1>c?(c=1,b=d/4):b=d*Math.asin(1/c)/(2*Math.PI),c*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/d)+1)},InOut:function(a){var b,c=.1,d=.4;return 0===a?0:1===a?1:(!c||1>c?(c=1,b=d/4):b=d*Math.asin(1/c)/(2*Math.PI),(a*=2)<1?-.5*c*Math.pow(2,10*(a-=1))*Math.sin(2*(a-b)*Math.PI/d):c*Math.pow(2,-10*(a-=1))*Math.sin(2*(a-b)*Math.PI/d)*.5+1)}},Back:{In:function(a){var b=1.70158;return a*a*((b+1)*a-b)},Out:function(a){var b=1.70158;return--a*a*((b+1)*a+b)+1},InOut:function(a){var b=2.5949095;return(a*=2)<1?.5*a*a*((b+1)*a-b):.5*((a-=2)*a*((b+1)*a+b)+2)}},Bounce:{In:function(a){return 1-d.Easing.Bounce.Out(1-a)},Out:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*d.Easing.Bounce.In(2*a):.5*d.Easing.Bounce.Out(2*a-1)+.5}}},d.Interpolation={Linear:function(a,b){var c=a.length-1,e=c*b,f=Math.floor(e),g=d.Interpolation.Utils.Linear;return 0>b?g(a[0],a[1],e):b>1?g(a[c],a[c-1],c-e):g(a[f],a[f+1>c?c:f+1],e-f)},Bezier:function(a,b){var c,e=0,f=a.length-1,g=Math.pow,h=d.Interpolation.Utils.Bernstein;for(c=0;f>=c;c++)e+=g(1-b,f-c)*g(b,c)*a[c]*h(f,c);return e},CatmullRom:function(a,b){var c=a.length-1,e=c*b,f=Math.floor(e),g=d.Interpolation.Utils.CatmullRom;return a[0]===a[c]?(0>b&&(f=Math.floor(e=c*(1+b))),g(a[(f-1+c)%c],a[f],a[(f+1)%c],a[(f+2)%c],e-f)):0>b?a[0]-(g(a[0],a[0],a[1],a[1],-e)-a[0]):b>1?a[c]-(g(a[c],a[c],a[c-1],a[c-1],e-c)-a[c]):g(a[f?f-1:0],a[f],a[f+1>c?c:f+1],a[f+2>c?c:f+2],e-f)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var c=d.Interpolation.Utils.Factorial;return c(a)/c(b)/c(a-b)},Factorial:function(){var a=[1];return function(b){var c,d=1;if(a[b])return a[b];for(c=b;c>1;c--)d*=c;return a[b]=d}}(),CatmullRom:function(a,b,c,d,e){var f=.5*(c-a),g=.5*(d-b),h=e*e,i=e*h;return(2*b-2*c+f+g)*i+(-3*b+3*c-2*f-g)*h+f*e+b}}},b.exports=d},{}],14:[function(a,b,c){function d(){this.listenerMap={}}d.prototype.addEventListener=function(a,b,c){if(this.listenerMap||(this.listenerMap={}),!a)throw new Error("Event type required for event dispatcher");if(!b)throw new Error("Listener required for event dispatcher");this.removeEventListener(a,b,c),this.listenerMap.hasOwnProperty(a)||(this.listenerMap[a]=[]),this.listenerMap[a].push({listener:b,scope:c})},d.prototype.removeEventListener=function(a,b,c){if(this.listenerMap||(this.listenerMap={}),this.listenerMap.hasOwnProperty(a)){for(var d=this.listenerMap[a],e=0;e<d.length;e++){var f=d[e];b==f.listener&&c==f.scope&&(d.splice(e,1),e--)}d.length||delete this.listenerMap[a]}},d.prototype.dispatchEvent=function(a){this.listenerMap||(this.listenerMap={});var b,c;if("string"==typeof a?(b=a,c=arguments.length>1?Array.prototype.slice.call(arguments,1):[{type:b,target:this}]):(b=a.type,a.target=this,c=[a]),this.listenerMap.hasOwnProperty(b))for(var d in this.listenerMap[b]){var e=this.listenerMap[b][d];e.listener.apply(e.scope,c)}},d.prototype.on=d.prototype.addEventListener,d.prototype.off=d.prototype.removeEventListener,d.prototype.trigger=d.prototype.dispatchEvent,d.init=function(a){a.prototype.addEventListener=d.prototype.addEventListener,a.prototype.removeEventListener=d.prototype.removeEventListener,a.prototype.dispatchEvent=d.prototype.dispatchEvent,a.prototype.on=d.prototype.on,a.prototype.off=d.prototype.off,a.prototype.trigger=d.prototype.trigger},"undefined"!=typeof b&&(b.exports=d)},{}],15:[function(a,b,c){function d(){e.call(this,960,720),this.verticalAlign=e.TOP,this.resources=new n,this.resources.addSkinSource(t),this.resources.addSpriteSheet("netpokerclient.spritesheet.json"),this.loadingScreen=new k,this.addChild(this.loadingScreen),this.enterAppState("LOADING",0),this.loadingScreen.show("LOADING"),this.url=null,this.tableId=null,this.tournamentId=null,this.viewConfig=new o,this.on("frame",q.update)}var e=(a("pixi.js"),a("pixiapp")),f=a("../view/NetPokerClientView"),g=a("../controller/NetPokerClientController"),h=a("../../utils/MessageWebSocketConnection"),i=a("../../utils/MessageRequestConnection"),j=a("../../proto/ProtoConnection"),k=a("../view/LoadingScreen"),l=a("../../proto/messages/StateCompleteMessage"),m=a("../../proto/messages/InitMessage"),n=a("../resources/Resources"),o=a("../resources/ViewConfig"),p=a("url"),q=a("tween.js"),r=a("inherits"),s=a("../../utils/UrlUtil"),t=a("../resources/DefaultSkin");r(d,e),d.prototype.setUrl=function(a){this.url=a},d.prototype.setTableId=function(a){this.tableId=a},d.prototype.setTournamentId=function(a){this.tournamentId=a},d.prototype.setViewCase=function(a){console.log("****** running view case: "+a),this.viewCase=a},d.prototype.setToken=function(a){this.token=a},d.prototype.addSkinSource=function(a){this.resources.addSkinSource(a)},d.prototype.addSpriteSheet=function(a){this.resources.addSpriteSheet(a)},d.prototype.setSpriteSheet=function(a){this.resources.setSpriteSheet(a)},d.prototype.run=function(){this.enterAppState("LOADING RESOURCES",50),this.resources.load().then(this.onResourcesLoaded.bind(this),this.onResourcesError.bind(this))},d.prototype.onResourcesError=function(){console.log("resource error"),this.enterAppState("ERROR LOADING RESOURCES")},d.prototype.onResourcesLoaded=function(){this.netPokerClientView=new f(this.viewConfig,this.resources),this.addChildAt(this.netPokerClientView,0),this.netPokerClientController=new g(this.netPokerClientView),this.connect()},d.prototype.connect=function(){if(!this.url)return void this.enterAppState("NEED URL");var a=p.parse(this.url);console.log(a),a.protocol&&"http:"!=a.protocol&&"https:"!=a.protocol?this.connection=new h:(this.url=s.makeAbsolute(this.url),this.connection=new i),this.connection.on(h.CONNECT,this.onConnectionConnect,this),this.connection.on(h.CLOSE,this.onConnectionClose,this),console.log("Connecting to: "+this.url),this.enterAppState("CONNECTING",65),this.connection.connect(this.url)},d.prototype.onConnectionConnect=function(){console.log("**** connected"),this.protoConnection=new j(this.connection),this.protoConnection.addMessageHandler(l,this.onStateCompleteMessage,this),this.netPokerClientController.setProtoConnection(this.protoConnection),this.enterAppState("INITIALIZING",80);var a=new m(this.token);this.tableId&&a.setTableId(this.tableId),this.tournamentId&&a.setTournamentId(this.tournamentId),this.viewCase&&a.setViewCase(this.viewCase),this.protoConnection.send(a)},d.prototype.onStateCompleteMessage=function(){this.enterAppState(null)},d.prototype.onConnectionClose=function(){console.log("**** connection closed"),this.protoConnection&&this.protoConnection.removeMessageHandler(l,this.onStateCompleteMessage,this),this.protoConnection=null,this.netPokerClientController.setProtoConnection(null),this.enterAppState("CONNECTION ERROR"),setTimeout(this.connect.bind(this),3e3)},d.prototype.enterAppState=function(a,b){a?this.loadingScreen.show(a):this.loadingScreen.hide(),this.trigger({type:"appStateChange",message:a,progress:b})},d.getQueryStringParams=function(){var a={};return function(){for(var b,c=/\+/g,d=/([^&=]+)=?([^&]*)/g,e=function(a){return decodeURIComponent(a.replace(c," "))},f=window.location.search.substring(1).replace(/amp;/g,"");b=d.exec(f);)a[e(b[1])]=e(b[2])}(),a},b.exports=d},{"../../proto/ProtoConnection":44,"../../proto/messages/InitMessage":61,"../../proto/messages/StateCompleteMessage":72,"../../utils/MessageRequestConnection":83,"../../utils/MessageWebSocketConnection":84,"../../utils/UrlUtil":90,"../controller/NetPokerClientController":19,"../resources/DefaultSkin":21,"../resources/Resources":22,"../resources/ViewConfig":23,"../view/LoadingScreen":33,"../view/NetPokerClientView":34,inherits:7,"pixi.js":8,pixiapp:9,"tween.js":13,url:6}],16:[function(a,b,c){function d(a,b){this.messageSequencer=a,this.view=b,this.messageSequencer.addMessageHandler(f.TYPE,this.onButtonsMessage,this),this.messageSequencer.addMessageHandler(e.TYPE,this.onShowDialogMessage,this),this.messageSequencer.addMessageHandler(g.TYPE,this.onChat,this),this.messageSequencer.addMessageHandler(h.TYPE,this.onTableInfoMessage,this),this.messageSequencer.addMessageHandler(i.TYPE,this.onHandInfoMessage,this),this.messageSequencer.addMessageHandler(k.TYPE,this.onInterfaceStateMessage,this),this.messageSequencer.addMessageHandler(l.TYPE,this.onCheckboxMessage,this),this.messageSequencer.addMessageHandler(m.TYPE,this.onPreTournamentInfoMessage,this),this.messageSequencer.addMessageHandler(j.TYPE,this.onPresetButtons,this)}var e=a("../../proto/messages/ShowDialogMessage"),f=a("../../proto/messages/ButtonsMessage"),g=a("../../proto/messages/ChatMessage"),h=a("../../proto/messages/TableInfoMessage"),i=a("../../proto/messages/HandInfoMessage"),j=a("../../proto/messages/PresetButtonsMessage"),k=a("../../proto/messages/InterfaceStateMessage"),l=a("../../proto/messages/CheckboxMessage"),m=a("../../proto/messages/PreTournamentInfoMessage");d.prototype.onButtonsMessage=function(a){var b=this.view.getButtonsView();b.setButtons(a.getButtons(),a.sliderButtonIndex,parseInt(a.min,10),parseInt(a.max,10))},d.prototype.onPresetButtons=function(a){for(var b=this.view.getPresetButtonsView(),c=b.getButtons(),d=0;d<c.length;d++)if(d>a.buttons.length)c[d].hide();else{var e=a.buttons[d];null==e?c[d].hide():c[d].show(e.button,e.value)}b.setCurrent(a.current)},d.prototype.onShowDialogMessage=function(a){var b=this.view.getDialogView();b.show(a.getText(),a.getButtons(),a.getDefaultValue())},d.prototype.onChat=function(a){this.view.chatView.addText(a.user,a.text)},d.prototype.onTableInfoMessage=function(a){var b=this.view.getTableInfoView();b.setTableInfoText(a.getText()),b.setJoinButtonVisible(a.getShowJoinButton()),b.setLeaveButtonVisible(a.getShowLeaveButton())},d.prototype.onHandInfoMessage=function(a){var b=this.view.getTableInfoView();b.setHandInfoText(a.getText())},d.prototype.onInterfaceStateMessage=function(a){var b=this.view.getSettingsView();b.setVisibleButtons(a.getVisibleButtons())},d.prototype.onCheckboxMessage=function(a){console.log(a);var b=this.view.getSettingsView();b.setCheckboxChecked(a.getId(),a.getChecked())},d.prototype.onPreTournamentInfoMessage=function(a){var b=this.view.getTableInfoView();b.setPreTournamentInfoText(a.getText())},b.exports=d},{"../../proto/messages/ButtonsMessage":51,"../../proto/messages/ChatMessage":52,"../../proto/messages/CheckboxMessage":53,"../../proto/messages/HandInfoMessage":60,"../../proto/messages/InterfaceStateMessage":62,
"../../proto/messages/PreTournamentInfoMessage":66,"../../proto/messages/PresetButtonsMessage":68,"../../proto/messages/ShowDialogMessage":71,"../../proto/messages/TableInfoMessage":75}],17:[function(a,b,c){function d(a){e.call(this),this.message=a,this.waitTarget=null,this.waitEvent=null,this.waitClosure=null}var e=a("yaed"),f=a("../../utils/Sequencer"),g=a("inherits");g(d,e),d.prototype.getMessage=function(){return this.message},d.prototype.isWaiting=function(){return null!=this.waitEvent},d.prototype.notifyComplete=function(){this.trigger(f.COMPLETE)},d.prototype.waitFor=function(a,b){this.waitTarget=a,this.waitEvent=b,this.waitClosure=this.onTargetComplete.bind(this),this.waitTarget.addEventListener(this.waitEvent,this.waitClosure)},d.prototype.onTargetComplete=function(){this.waitTarget.removeEventListener(this.waitEvent,this.waitClosure),this.notifyComplete()},b.exports=d},{"../../utils/Sequencer":88,inherits:7,yaed:14}],18:[function(a,b,c){function d(){this.sequencer=new e,this.messageDispatcher=new f,this.currentItem=null}var e=a("../../utils/Sequencer"),f=a("yaed"),g=a("./MessageSequenceItem");d.prototype.enqueue=function(a){if(!a.type)throw"Message doesn't have a type";var b=new g(a);b.on(e.START,this.onSequenceItemStart,this),this.sequencer.enqueue(b)},d.prototype.onSequenceItemStart=function(a){var b=a.target;b.off(e.START,this.onSequenceItemStart,this),this.currentItem=b,this.messageDispatcher.trigger(b.getMessage()),this.currentItem=null,b.isWaiting()||b.notifyComplete()},d.prototype.addMessageHandler=function(a,b,c){this.messageDispatcher.on(a,b,c)},d.prototype.waitFor=function(a,b){if(!this.currentItem)throw"Not waiting for event";this.currentItem.waitFor(a,b)},b.exports=d},{"../../utils/Sequencer":88,"./MessageSequenceItem":17,yaed:14}],19:[function(a,b,c){function d(a){this.netPokerClientView=a,this.protoConnection=null,this.messageSequencer=new e,this.tableController=new o(this.messageSequencer,this.netPokerClientView),this.interfaceController=new p(this.messageSequencer,this.netPokerClientView),this.netPokerClientView.getButtonsView().on(g.BUTTON_CLICK,this.onButtonClick,this),this.netPokerClientView.getTableInfoView().on(m.BUTTON_CLICK,this.onButtonClick,this),this.netPokerClientView.getDialogView().on(l.BUTTON_CLICK,this.onButtonClick,this),this.netPokerClientView.on(k.SEAT_CLICK,this.onSeatClick,this),this.netPokerClientView.chatView.addEventListener("chat",this.onViewChat,this),this.netPokerClientView.settingsView.addEventListener(n.BUY_CHIPS_CLICK,this.onBuyChipsButtonClick,this),this.netPokerClientView.settingsView.addEventListener(n.CHECKBOX_CHANGE,this.onCheckboxChange,this),this.netPokerClientView.getPresetButtonsView().addEventListener(t.CHANGE,this.onPresetButtonsChange,this)}var e=a("./MessageSequencer"),f=a("../../proto/ProtoConnection"),g=a("../view/ButtonsView"),h=a("../../proto/messages/ButtonClickMessage"),i=a("../../proto/messages/SeatClickMessage"),j=a("../../proto/messages/PresetButtonClickMessage"),k=a("../view/NetPokerClientView"),l=a("../view/DialogView"),m=a("../view/TableInfoView"),n=a("../view/SettingsView"),o=a("./TableController"),p=a("./InterfaceController"),q=a("../../proto/messages/ChatMessage"),r=a("../../proto/messages/CheckboxMessage"),s=a("../../proto/data/ButtonData"),t=a("../view/PresetButtonsView");d.prototype.setProtoConnection=function(a){this.protoConnection&&this.protoConnection.off(f.MESSAGE,this.onProtoConnectionMessage,this),this.protoConnection=a,this.netPokerClientView.clear(),this.protoConnection&&this.protoConnection.on(f.MESSAGE,this.onProtoConnectionMessage,this)},d.prototype.onProtoConnectionMessage=function(a){this.messageSequencer.enqueue(a.message)},d.prototype.onButtonClick=function(a){if(this.protoConnection){console.log("button click, v="+a.value);var b=new h(a.button,a.value);this.protoConnection.send(b)}},d.prototype.onSeatClick=function(a){var b=new i(a.seatIndex);this.protoConnection.send(b)},d.prototype.onViewChat=function(a){var b=new q;b.user="",b.text=a.text,this.protoConnection.send(b)},d.prototype.onBuyChipsButtonClick=function(){console.log("buy chips click"),this.protoConnection.send(new h(s.BUY_CHIPS))},d.prototype.onPresetButtonsChange=function(){var a=this.netPokerClientView.getPresetButtonsView(),b=new j,c=a.getCurrent();null!=c&&(b.button=c.id,b.value=c.value),this.protoConnection.send(b)},d.prototype.onCheckboxChange=function(a){this.protoConnection.send(new r(a.checkboxId,a.checked))},b.exports=d},{"../../proto/ProtoConnection":44,"../../proto/data/ButtonData":45,"../../proto/messages/ButtonClickMessage":50,"../../proto/messages/ChatMessage":52,"../../proto/messages/CheckboxMessage":53,"../../proto/messages/PresetButtonClickMessage":67,"../../proto/messages/SeatClickMessage":69,"../view/ButtonsView":25,"../view/DialogView":32,"../view/NetPokerClientView":34,"../view/PresetButtonsView":37,"../view/SettingsView":41,"../view/TableInfoView":42,"./InterfaceController":16,"./MessageSequencer":18,"./TableController":20}],20:[function(a,b,c){function d(a,b){this.messageSequencer=a,this.view=b,this.messageSequencer.addMessageHandler(e.TYPE,this.onSeatInfoMessage,this),this.messageSequencer.addMessageHandler(f.TYPE,this.onCommunityCardsMessage,this),this.messageSequencer.addMessageHandler(g.TYPE,this.onPocketCardsMessage,this),this.messageSequencer.addMessageHandler(h.TYPE,this.onDealerButtonMessage,this),this.messageSequencer.addMessageHandler(i.TYPE,this.onBetMessage,this),this.messageSequencer.addMessageHandler(j.TYPE,this.onBetsToPot,this),this.messageSequencer.addMessageHandler(k.TYPE,this.onPot,this),this.messageSequencer.addMessageHandler(l.TYPE,this.onTimer,this),this.messageSequencer.addMessageHandler(m.TYPE,this.onAction,this),this.messageSequencer.addMessageHandler(n.TYPE,this.onFoldCards,this),this.messageSequencer.addMessageHandler(o.TYPE,this.onDelay,this),this.messageSequencer.addMessageHandler(q.TYPE,this.onClear,this),this.messageSequencer.addMessageHandler(r.TYPE,this.onPayOut,this)}var e=a("../../proto/messages/SeatInfoMessage"),f=a("../../proto/messages/CommunityCardsMessage"),g=a("../../proto/messages/PocketCardsMessage"),h=a("../../proto/messages/DealerButtonMessage"),i=a("../../proto/messages/BetMessage"),j=a("../../proto/messages/BetsToPotMessage"),k=a("../../proto/messages/PotMessage"),l=a("../../proto/messages/TimerMessage"),m=a("../../proto/messages/ActionMessage"),n=a("../../proto/messages/FoldCardsMessage"),o=a("../../proto/messages/DelayMessage"),p=a("yaed"),q=a("../../proto/messages/ClearMessage"),r=a("../../proto/messages/PayOutMessage");p.init(d),d.prototype.onSeatInfoMessage=function(a){var b=this.view.getSeatViewByIndex(a.getSeatIndex());b.setName(a.getName()),b.setChips(a.getChips()),b.setActive(a.isActive()),b.setSitout(a.isSitout())},d.prototype.onCommunityCardsMessage=function(a){var b;for(console.log("got community cards!"),console.log(a),b=0;b<a.getCards().length;b++){var c=a.getCards()[b],d=this.view.getCommunityCards()[a.getFirstIndex()+b];d.setCardData(c),d.show(a.animate,500*b)}if(a.getCards().length>0){var c=a.getCards()[a.getCards().length-1],d=this.view.getCommunityCards()[a.getFirstIndex()+a.getCards().length-1];a.animate&&this.messageSequencer.waitFor(d,"animationDone")}},d.prototype.onPocketCardsMessage=function(a){var b,c=this.view.getSeatViewByIndex(a.getSeatIndex());for(b=0;b<a.getCards().length;b++){var d=a.getCards()[b],e=c.getPocketCards()[a.getFirstIndex()+b];a.animate&&this.messageSequencer.waitFor(e,"animationDone"),e.setCardData(d),e.show(a.animate,10)}},d.prototype.onDealerButtonMessage=function(a){var b=this.view.getDealerButtonView();a.seatIndex<0?b.hide():(this.messageSequencer.waitFor(b,"animationDone"),b.show(a.getSeatIndex(),a.getAnimate()))},d.prototype.onBetMessage=function(a){this.view.seatViews[a.seatIndex].betChips.setValue(a.value)},d.prototype.onBetsToPot=function(a){for(var b=!1,c=0;c<this.view.seatViews.length;c++)this.view.seatViews[c].betChips.value>0&&(b=!0);if(b){for(var c=0;c<this.view.seatViews.length;c++)this.view.seatViews[c].betChips.animateIn();this.messageSequencer.waitFor(this.view.seatViews[0].betChips,"animationDone")}},d.prototype.onPot=function(a){this.view.potView.setValues(a.values)},d.prototype.onTimer=function(a){a.seatIndex<0?this.view.timerView.hide():(this.view.timerView.show(a.seatIndex),this.view.timerView.countdown(a.totalTime,a.timeLeft))},d.prototype.onAction=function(a){null==a.seatIndex&&(a.seatIndex=0),this.view.seatViews[a.seatIndex].action(a.action)},d.prototype.onFoldCards=function(a){this.view.seatViews[a.seatIndex].foldCards(),this.messageSequencer.waitFor(this.view.seatViews[a.seatIndex],"animationDone")},d.prototype.onDelay=function(a){console.log("delay for  = "+a.delay),this.messageSequencer.waitFor(this,"timerDone"),setTimeout(this.dispatchEvent.bind(this,"timerDone"),a.delay)},d.prototype.onClear=function(a){for(var b=a.getComponents(),c=0;c<b.length;c++)switch(b[c]){case q.POT:this.view.potView.setValues([]);break;case q.BETS:for(var d=0;d<this.view.seatViews.length;d++)this.view.seatViews[d].betChips.setValue(0);break;case q.CARDS:for(var d=0;d<this.view.seatViews.length;d++)for(var e=0;e<this.view.seatViews[d].pocketCards.length;e++)this.view.seatViews[d].pocketCards[e].hide();for(var e=0;e<this.view.communityCards.length;e++)this.view.communityCards[e].hide();break;case q.CHAT:this.view.chatView.clear()}},d.prototype.onPayOut=function(a){for(var b=0;b<a.values.length;b++)this.view.seatViews[b].betChips.setValue(a.values[b]);for(var b=0;b<this.view.seatViews.length;b++)this.view.seatViews[b].betChips.animateOut();this.messageSequencer.waitFor(this.view.seatViews[0].betChips,"animationDone")},b.exports=d},{"../../proto/messages/ActionMessage":47,"../../proto/messages/BetMessage":48,"../../proto/messages/BetsToPotMessage":49,"../../proto/messages/ClearMessage":54,"../../proto/messages/CommunityCardsMessage":55,"../../proto/messages/DealerButtonMessage":56,"../../proto/messages/DelayMessage":57,"../../proto/messages/FoldCardsMessage":59,"../../proto/messages/PayOutMessage":63,"../../proto/messages/PocketCardsMessage":64,"../../proto/messages/PotMessage":65,"../../proto/messages/SeatInfoMessage":70,"../../proto/messages/TimerMessage":77,yaed:14}],21:[function(a,b,c){b.exports={tableBackground:"__table.png",seatPlate:"__seatPlate.png",timerBackground:"__timerBackground.png",dealerButton:"__dealerButton.png",cardFrame:"__cardFrame.png",cardBack:"__cardBack.png",suitSymbol0:"__suitSymbol0.png",suitSymbol1:"__suitSymbol1.png",suitSymbol2:"__suitSymbol2.png",suitSymbol3:"__suitSymbol3.png",chip0:"__chip0.png",chip1:"__chip1.png",chip2:"__chip2.png",chip3:"__chip3.png",chip4:"__chip4.png",dividerLine:"__dividerLine.png",framePlate:"__framePlate.png",bigButton:"__bigButton.png",dialogButton:"__dialogButton.png",textScrollbarTrack:"__textScrollbarTrack.png",textScrollbarThumb:"__textScrollbarThumb.png",wrenchIcon:"__wrenchIcon.png",chatBackground:"__chatBackground.png",checkboxBackground:"__checkboxBackground.png",checkboxTick:"__checkboxTick.png",buttonBackground:"__buttonBackground.png",sliderBackground:"__sliderBackground.png",sliderKnob:"__sliderKnob.png",upArrow:"__upArrow.png",chipsColor0:4210752,chipsColor1:32768,chipsColor2:8421376,chipsColor3:128,chipsColor4:16711680,communityCardMargin:1,betAlign:"LCRRRRCLLL",tablePosition:[101,94],potPosition:[485,315],timerOffset:[55,-30],communityCardsPosition:[255,190],seatPosition0:[287,118],seatPosition1:[483,112],seatPosition2:[676,118],seatPosition3:[844,247],seatPosition4:[817,413],seatPosition5:[676,490],seatPosition6:[483,495],seatPosition7:[287,490],seatPosition8:[140,413],seatPosition9:[123,247],dealerButtonPosition0:[347,133],dealerButtonPosition1:[395,133],dealerButtonPosition2:[574,133],dealerButtonPosition3:[762,267],dealerButtonPosition4:[715,358],dealerButtonPosition5:[574,434],dealerButtonPosition6:[536,432],dealerButtonPosition7:[351,432],dealerButtonPosition8:[193,362],dealerButtonPosition9:[168,266],betPosition0:[225,150],betPosition1:[478,150],betPosition2:[730,150],betPosition3:[778,196],betPosition4:[748,322],betPosition5:[719,360],betPosition6:[481,360],betPosition7:[232,360],betPosition8:[199,322],betPosition9:[181,200],bigButtonPosition:[366,575]}},{}],22:[function(a,b,c){function d(){this.spriteSheets=[],this.skinSources=[],this.data=[],this.loadThenable=null,this.skinSourceIndex=0}var e=a("tinp"),f=a("pixi.js"),g=a("../../utils/UrlUtil"),h=a("../../utils/HttpRequest");d.prototype.setSpriteSheet=function(a){this.spriteSheets=[a]},d.prototype.addSpriteSheet=function(a){this.spriteSheets.push(a)},d.prototype.addSkinSource=function(a){this.skinSources.push(a)},d.prototype.getPoint=function(a){return this.assertKeyExists(a),new f.Point(this.data[a][0],this.data[a][1])},d.prototype.getString=function(a){return this.assertKeyExists(a),this.data[a].toString()},d.prototype.getValue=d.prototype.getString,d.prototype.getColor=d.prototype.getString,d.prototype.getTexture=function(a){var b=f.Texture.fromFrame(this.getString(a));return b},d.prototype.assertKeyExists=function(a){if(!this.data.hasOwnProperty(a))throw new Error("No such resource: "+a)},d.prototype.keyExists=function(a){return this.data.hasOwnProperty(a)},d.prototype.load=function(){if(this.loadThenable)throw new Error("Already loading");return this.loadThenable=new e,this.skinSourceIndex=0,this.spriteSheets.length?(this.assetLoader=new f.AssetLoader(this.spriteSheets),this.assetLoader.on("onComplete",this.onAssetLoaderComplete.bind(this)),this.assetLoader.on("onProgress",this.onAssetLoaderProgress.bind(this)),this.assetLoader.load()):this.loadNextSkinSource(),this.loadThenable},d.prototype.onAssetLoaderProgress=function(a){console.log("asset loader progress")},d.prototype.onAssetLoaderComplete=function(){this.loadNextSkinSource()},d.prototype.loadNextSkinSource=function(){if(this.skinSourceIndex>=this.skinSources.length)return void this.loadThenable.resolve();var a=this.skinSources[this.skinSourceIndex];if("object"==typeof a)return void this.processSkinData(a);var b=new h(g.makeAbsolute(a));b.setResultType("json"),b.send().then(this.onSkinSourceLoaded.bind(this),this.onSkinSourceLoadError.bind(this))},d.prototype.onSkinSourceLoaded=function(a){this.processSkinData(a)},d.prototype.onSkinSourceLoadError=function(a){this.loadThenable.reject(a)},d.prototype.processSkinData=function(a){for(i in a)this.data[i]=a[i];this.skinSourceIndex++,this.loadNextSkinSource()},b.exports=d},{"../../utils/HttpRequest":82,"../../utils/UrlUtil":90,"pixi.js":8,tinp:12}],23:[function(a,b,c){function d(){this.playAnimations=!0}d.prototype.setPlayAnimations=function(a){this.playAnimations=a},d.prototype.getPlayAnimations=function(){return this.playAnimations},d.prototype.scaleAnimationTime=function(a){return this.playAnimations?a:1},b.exports=d},{}],24:[function(a,b,c){function d(a){f.call(this),this.resources=a,this.bigButtonTexture=this.resources.getTexture("bigButton"),this.addChild(new e.Sprite(this.bigButtonTexture));var b={font:"bold 18px Arial"};this.labelField=new e.Text("[button]",b),this.labelField.position.y=30,this.addChild(this.labelField);var b={font:"bold 14px Arial"};this.valueField=new e.Text("[value]",b),this.valueField.position.y=50,this.addChild(this.valueField),this.setLabel("TEST"),this.setValue(123)}var e=a("pixi.js"),f=a("../../utils/Button"),g=a("inherits");g(d,f),d.prototype.setLabel=function(a){this.labelField.setText(a),this.labelField.updateTransform(),this.labelField.x=this.bigButtonTexture.width/2-this.labelField.width/2},d.prototype.setValue=function(a){a?this.valueField.visible=!0:(this.valueField.visible=!1,a=""),this.valueField.setText(a),this.valueField.updateTransform(),this.valueField.x=this.bigButtonTexture.width/2-this.valueField.width/2},b.exports=d},{"../../utils/Button":79,inherits:7,"pixi.js":8}],25:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.resources=b,this.buttonHolder=new e.DisplayObjectContainer,this.addChild(this.buttonHolder);var c=new i(this.resources.getTexture("sliderBackground"),20,0,20,0);c.setLocalSize(300,c.height);var d=new e.Sprite(this.resources.getTexture("sliderKnob"));this.slider=new h(c,d);var f=this.resources.getPoint("bigButtonPosition");this.slider.position.x=f.x,this.slider.position.y=f.y-35,this.slider.addEventListener("change",this.onSliderChange,this),this.addChild(this.slider),this.buttonHolder.position.x=366,this.buttonHolder.position.y=575,this.buttons=[];for(var k=0;3>k;k++){var l=new j(this.resources);l.on(g.CLICK,this.onButtonClick,this),l.position.x=105*k,this.buttonHolder.addChild(l),this.buttons.push(l)}var m=new e.Sprite(this.resources.getTexture("sliderKnob")),n=new e.Sprite(this.resources.getTexture("upArrow"));n.position.x=.5*(m.width-n.width)-.5,n.position.y=.5*(m.height-n.height)-2,m.addChild(n),this.raiseMenuButton=new g(m),this.raiseMenuButton.addEventListener(g.CLICK,this.onRaiseMenuButtonClick,this),this.raiseMenuButton.position.x=280,this.raiseMenuButton.position.y=-5,this.buttonHolder.addChild(this.raiseMenuButton),this.raiseMenuButton.visible=!1,this.createRaiseAmountMenu(),this.setButtons([],0,-1,-1),this.buttonsDatas=[]}var e=a("pixi.js"),f=a("yaed"),g=a("../../utils/Button"),h=a("../../utils/Slider"),i=a("../../utils/NineSlice"),j=a("./BigButton"),k=a("./RaiseShortcutButton"),l=a("inherits");l(d,e.DisplayObjectContainer),f.init(d),d.BUTTON_CLICK="buttonClick",d.prototype.createRaiseAmountMenu=function(){this.raiseAmountMenu=new e.DisplayObjectContainer,this.raiseMenuBackground=new i(this.resources.getTexture("chatBackground"),10,10,10,10),this.raiseMenuBackground.position.x=0,this.raiseMenuBackground.position.y=0,this.raiseMenuBackground.width=125,this.raiseMenuBackground.height=220,this.raiseAmountMenu.addChild(this.raiseMenuBackground),this.raiseAmountMenu.x=645,this.raiseAmountMenu.y=570-this.raiseAmountMenu.height,this.addChild(this.raiseAmountMenu);var a={font:"bold 18px Arial"},b=new e.Text("RAISE TO",a);b.position.x=.5*(125-b.width),b.position.y=10,this.raiseAmountMenu.addChild(b),this.raiseShortcutButtons=new Array;for(var c=0;6>c;c++){var d=new k(this.resources);d.addEventListener(g.CLICK,this.onRaiseShortcutClick,this),d.position.x=10,d.position.y=35+30*c,this.raiseAmountMenu.addChild(d),this.raiseShortcutButtons.push(d)}this.raiseAmountMenu.visible=!1},d.prototype.onRaiseShortcutClick=function(){},d.prototype.onRaiseMenuButtonClick=function(){this.raiseAmountMenu.visible=!this.raiseAmountMenu.visible},d.prototype.onSliderChange=function(){var a=Math.round(this.sliderMin+this.slider.getValue()*(this.sliderMax-this.sliderMin));this.buttons[this.sliderIndex].setValue(a),this.buttonDatas[this.sliderIndex].value=a,console.log("newValue = "+a)},d.prototype.showSlider=function(a,b,c){console.log("showSlider"),this.sliderIndex=a,this.sliderMin=b,this.sliderMax=c,console.log("this.buttonDatas["+a+"] = "+this.buttonDatas[a].getValue()+", min = "+b+", max = "+c),this.slider.setValue((this.buttonDatas[a].getValue()-b)/(c-b)),console.log("this.slider.getValue() = "+this.slider.getValue()),this.slider.visible=!0,this.slider.show()},d.prototype.clear=function(a){this.setButtons([],0,-1,-1),this.slider.visible=!1},d.prototype.setButtons=function(a,b,c,d){this.buttonDatas=a;for(var e=0;e<this.buttons.length;e++){var f=this.buttons[e];if(e>=a.length)f.visible=!1;else{var g=a[e];f.visible=!0,f.setLabel(g.getButtonString()),f.setValue(g.getValue())}}c>=0&&d>=0&&this.showSlider(b,c,d),this.buttonHolder.position.x=366,a.length<3&&(this.buttonHolder.position.x+=45)},d.prototype.onButtonClick=function(a){for(var b=-1,c=0;c<this.buttons.length;c++)this.buttons[c].visible=!1,a.target==this.buttons[c]&&(b=c);this.slider.visible=!1;var e=this.buttonDatas[b];this.trigger({type:d.BUTTON_CLICK,button:e.getButton(),value:e.getValue()})},b.exports=d},{"../../utils/Button":79,"../../utils/NineSlice":86,"../../utils/Slider":89,"./BigButton":24,"./RaiseShortcutButton":38,inherits:7,"pixi.js":8,yaed:14}],26:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.resources=b}var e=a("pixi.js"),f=a("inherits");f(d,e.DisplayObjectContainer),d.prototype.setCardData=function(a){this.cardData=a;var b,c="card"+this.cardData.getLongSuitString()+this.cardData.getCardValueString();if(this.resources.keyExists(c)&&(b=this.resources.getTexture(c)),b)this.frame=new e.Sprite(b),this.addChild(this.frame);else{this.frame=new e.Sprite(this.resources.getTexture("cardFrame")),this.addChild(this.frame),this.suit=new e.Sprite(this.resources.getTexture("suitSymbol"+this.cardData.getSuitIndex())),this.suit.position.x=8,this.suit.position.y=25,this.addChild(this.suit);var d={font:"bold 16px Arial"};this.valueField=new e.Text("[val]",d),this.addChild(this.valueField),this.valueField.style.fill=this.cardData.getColor(),this.valueField.setText(this.cardData.getCardValueString()),this.valueField.updateTransform(),this.valueField.position.x=17-this.valueField.canvas.width/2,this.valueField.position.y=5,this.suit.setTexture(this.resources.getTexture("suitSymbol"+this.cardData.getSuitIndex()))}},b.exports=d},{inherits:7,"pixi.js":8}],27:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.targetPosition=null,this.viewConfig=a,this.resources=b,this.front=new g(this.viewConfig,this.resources),this.addChild(this.front),this.back=new e.Sprite(this.resources.getTexture("cardBack")),this.addChild(this.back),this.maskGraphics=new e.Graphics,this.maskGraphics.beginFill(0),this.maskGraphics.drawRect(0,0,this.back.width,this.back.height),this.maskGraphics.endFill(),this.addChild(this.maskGraphics),this.mask=this.maskGraphics}var e=a("pixi.js"),f=a("tween.js"),g=a("./CardFrontView"),h=a("yaed"),i=a("inherits");i(d,e.DisplayObjectContainer),h.init(d),d.prototype.setCardData=function(a){this.cardData=a,this.cardData.isShown()&&(this.front.setCardData(this.cardData),this.maskGraphics.beginFill(0),this.maskGraphics.drawRect(0,0,this.front.width,this.front.height),this.maskGraphics.endFill()),this.back.visible=!0,this.front.visible=!1},d.prototype.setTargetPosition=function(a){this.targetPosition=a,this.position.x=a.x,this.position.y=a.y},d.prototype.hide=function(){this.visible=!1},d.prototype.show=function(a,b){if(this.maskGraphics.scale.y=1,this.position.x=this.targetPosition.x,this.position.y=this.targetPosition.y,!a)return this.visible=!0,void this.onShowComplete();this.mask.height=this.height;var c={x:this.position.x,y:this.position.y};this.position.x=.5*(this.parent.width-this.width),this.position.y=-this.height;var d=this.position.x-c.x,e=this.position.y-c.y;Math.sqrt(d*d+e*e),new f.Tween(this.position).to({x:c.x,y:c.y},this.viewConfig.scaleAnimationTime(500)).easing(f.Easing.Quadratic.Out).onStart(this.onShowStart.bind(this)).onComplete(this.onShowComplete.bind(this)).start()},d.prototype.onShowStart=function(){this.visible=!0},d.prototype.onShowComplete=function(){this.cardData.isShown()&&(this.back.visible=!1,this.front.visible=!0),this.dispatchEvent("animationDone",this)},d.prototype.fold=function(){var a={x:this.targetPosition.x,y:this.targetPosition.y+80},b=this.viewConfig.scaleAnimationTime(500);this.t0=new f.Tween(this.position).to(a,b).easing(f.Easing.Quadratic.Out).onUpdate(this.onFoldUpdate.bind(this)).onComplete(this.onFoldComplete.bind(this)).start()},d.prototype.onFoldUpdate=function(a){this.maskGraphics.scale.y=1-a},d.prototype.onFoldComplete=function(){this.dispatchEvent("animationDone")},b.exports=d},{"./CardFrontView":26,inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],28:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.resources=b,this.margin=5;var c=new f(this.resources.getTexture("framePlate"),10);c.position.x=10,c.position.y=540,c.setLocalSize(330,130),this.addChild(c);var d=new f(this.resources.getTexture("framePlate"),10);d.position.x=10,d.position.y=675,d.setLocalSize(330,35),this.addChild(d);var j={font:"12px Arial",wordWrapWidth:310,height:114,border:!0,color:16777215,borderColor:4210752,wordWrap:!0,multiline:!0};this.container=new e.DisplayObjectContainer,this.addChild(this.container),this.container.position.x=20,this.container.position.y=548,this.chatMask=new e.Graphics,this.chatMask.beginFill(123),this.chatMask.drawRect(0,0,310,114),this.chatMask.endFill(),this.container.addChild(this.chatMask),this.chatText=new e.Text("",j),this.container.addChild(this.chatText),this.chatText.mask=this.chatMask;var j={font:"14px Arial",width:310,height:19,border:!0,borderColor:4210752,background:!0,multiline:!0};this.inputField=new h("",j),this.inputField.position.x=this.container.position.x,this.inputField.position.y=683,this.inputField.width=310,this.inputField.keydown=this.onKeyDown.bind(this);var k=new e.Graphics;k.beginFill(0),k.drawRect(-1,-1,311,20),k.position.x=this.inputField.position.x,k.position.y=this.inputField.position.y,this.addChild(k);var l=new e.Graphics;l.beginFill(16777215),l.drawRect(0,0,310,19),l.position.x=this.inputField.position.x,l.position.y=this.inputField.position.y,this.addChild(l),this.addChild(this.inputField);var m=new f(this.resources.getTexture("textScrollbarTrack"),10,0,10,0);m.width=107;var n=new f(this.resources.getTexture("textScrollbarThumb"),10,0,10,0);n.width=30,this.slider=new g(m,n),this.slider.rotation=.5*Math.PI,this.slider.position.x=326,this.slider.position.y=552,this.slider.setValue(1),this.slider.visible=!1,this.slider.addEventListener("change",this.onSliderChange.bind(this)),this.addChild(this.slider),this.mouseOverGroup=new i,this.mouseOverGroup.addDisplayObject(this.chatText),this.mouseOverGroup.addDisplayObject(this.slider),this.mouseOverGroup.addDisplayObject(this.chatMask),this.mouseOverGroup.addDisplayObject(c),this.mouseOverGroup.addEventListener("mouseover",this.onChatFieldMouseOver,this),this.mouseOverGroup.addEventListener("mouseout",this.onChatFieldMouseOut,this),this.mouseOverGroup.addEventListener("mousedown",this.onChatFieldMouseDown,this),this.mouseOverGroup.addEventListener("mouseup",this.onChatFieldMouseUp,this),c.touchstart=this.onChatFieldMouseDown.bind(this),this.clear()}var e=a("pixi.js"),f=a("../../utils/NineSlice"),g=a("../../utils/Slider"),h=a("pixitextinput"),i=a("../../utils/MouseOverGroup"),j=a("yaed"),k=a("inherits");k(d,e.DisplayObjectContainer),j.init(d),d.prototype.clear=function(){this.chatText.setText(""),this.chatText.y=-Math.round(this.slider.getValue()*(this.chatText.height+this.margin-this.chatMask.height)),this.slider.setValue(1)},d.prototype.addText=function(a,b){this.chatText.setText(this.chatText.text+a+": "+b+"\n"),this.chatText.y=-Math.round(this.slider.getValue()*(this.chatText.height+this.margin-this.chatMask.height)),this.slider.setValue(1)},d.prototype.onSliderChange=function(){this.chatText.y=-Math.round(this.slider.getValue()*(this.chatText.height+this.margin-this.chatMask.height))},d.prototype.onChatFieldMouseOver=function(){this.slider.show()},d.prototype.onChatFieldMouseOut=function(){this.slider.hide()},d.prototype.onChatFieldMouseDown=function(a){a.target.touchend=a.target.touchendoutside=this.onChatFieldMouseUp.bind(this),a.target.touchmove=this.onChatFieldMouseMove.bind(this),this.startMousePos=a.global.y,this.startPos=this.chatText.y,this.slider.show()},d.prototype.onChatFieldMouseUp=function(a){a.target.touchend=a.target.touchendoutside=null,a.target.touchmove=null,this.slider.hide()},d.prototype.onChatFieldMouseMove=function(a){var b=a.global.y,c=b-this.startMousePos;this.slider.setValue(-(this.startPos+c)/(this.chatText.height+this.margin-this.chatMask.height)),this.onSliderChange()},d.prototype.onKeyDown=function(a){13==a.keyCode&&(this.dispatchEvent("chat",{text:this.inputField.text}),this.inputField.setText(""))},b.exports=d},{"../../utils/MouseOverGroup":85,"../../utils/NineSlice":86,"../../utils/Slider":89,inherits:7,"pixi.js":8,pixitextinput:10,yaed:14}],29:[function(a,b,c){function d(a,b,c){e.DisplayObjectContainer.call(this),this.targetPosition=null,this.viewConfig=a,this.resources=b,this.align="left",this.value=0,this.denominations=[5e5,1e5,25e3,5e3,1e3,500,100,25,5,1],this.stackClips=new Array,this.holder=new e.DisplayObjectContainer,this.addChild(this.holder),this.toolTip=null,c&&(this.toolTip=new ToolTip,this.addChild(this.toolTip))}var e=a("pixi.js"),f=a("tween.js"),g=a("yaed"),h=a("inherits");h(d,e.DisplayObjectContainer),g.init(d),d.prototype.setAlignment=function(a){if(!a)throw new Error("unknown alignment: "+a);this.align=a},d.prototype.setTargetPosition=function(a){this.targetPosition=a,this.position.x=a.x,this.position.y=a.y},d.prototype.setValue=function(a){this.value=a;for(var b=0;b<this.stackClips.length;b++)this.holder.removeChild(this.stackClips[b]);this.stackClips=new Array,null!=this.toolTip&&(this.toolTip.text="Bet: "+this.value.toString());var b,c=null,d=0,f=0;for(b=0;b<this.denominations.length;b++){var g=this.denominations[b];for(f=0,c=null;a>=g;){null==c&&(c=new e.DisplayObjectContainer,c.x=d,d+=40,this.holder.addChild(c),this.stackClips.push(c));var h=this.resources.getTexture("chip"+b%5),i=new e.Sprite(h);i.position.y=f,f-=5,c.addChild(i),a-=g;var j;if(j=g>=1e3?Math.round(g/1e3)+"K":g,null!=c&&g>a){var k=new e.Text(j,{font:"bold 12px Arial",align:"center",fill:this.resources.getColor("chipsColor"+b%5)});k.position.x=.5*(c.width-k.width),k.position.y=f+11,k.alpha=.5,c.addChild(k)}}}switch(this.align){case"left":case"L":this.holder.x=0;break;case"center":case"C":this.holder.x=-this.holder.width/2;break;case"right":case"R":this.holder.x=-this.holder.width;break;default:throw new Error("unknown align: "+this.align)}},d.prototype.hide=function(){this.visible=!1},d.prototype.show=function(){this.visible=!0;var a={x:this.targetPosition.x,y:this.targetPosition.y};this.position.x=.5*(this.parent.width-this.width),this.position.y=-this.height;var b=this.position.x-a.x,c=this.position.y-a.y,d=Math.sqrt(b*b+c*c);new f.Tween(this.position).to({x:a.x,y:a.y},3*d).easing(f.Easing.Quadratic.Out).onComplete(this.onShowComplete.bind(this)).start()},d.prototype.onShowComplete=function(){this.dispatchEvent("animationDone",this)},d.prototype.animateIn=function(){var a={y:this.resources.getPoint("potPosition").y};switch(this.align){case"left":case"L":a.x=this.resources.getPoint("potPosition").x-this.width/2;break;case"center":case"C":a.x=this.resources.getPoint("potPosition").x;break;case"right":case"R":a.x=this.resources.getPoint("potPosition").x+this.width/2;break;default:throw new Error("unknown align: "+this.align)}var b=this.viewConfig.scaleAnimationTime(500);new f.Tween(this).to({y:this.resources.getPoint("potPosition").y,x:a.x},b).onComplete(this.onInAnimationComplete.bind(this)).start()},d.prototype.onInAnimationComplete=function(){this.setValue(0),this.position.x=this.targetPosition.x,this.position.y=this.targetPosition.y,this.dispatchEvent("animationDone",this)},d.prototype.animateOut=function(){switch(this.position.y=this.resources.getPoint("potPosition").y,this.align){case"left":case"L":this.position.x=this.resources.getPoint("potPosition").x-this.width/2;break;case"center":case"C":this.position.x=this.resources.getPoint("potPosition").x;break;case"right":case"R":this.position.x=this.resources.getPoint("potPosition").x+this.width/2;break;default:throw new Error("unknown align: "+this.align)}var a={x:this.targetPosition.x,y:this.targetPosition.y},b=this.viewConfig.scaleAnimationTime(500);new f.Tween(this).to(a,b).onComplete(this.onOutAnimationComplete.bind(this)).start()},d.prototype.onOutAnimationComplete=function(){var a=500;new f.Tween({x:0}).to({x:10},a).onComplete(this.onOutWaitAnimationComplete.bind(this)).start();this.position.x=this.targetPosition.x,this.position.y=this.targetPosition.y},d.prototype.onOutWaitAnimationComplete=function(){this.setValue(0),this.dispatchEvent("animationDone",this)},b.exports=d},{inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],30:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.viewConfig=a,this.resources=b;var c=this.resources.getTexture("dealerButton");this.sprite=new e.Sprite(c),
this.addChild(this.sprite),this.hide()}var e=a("pixi.js"),f=a("tween.js"),g=a("yaed"),h=a("inherits");h(d,e.DisplayObjectContainer),g.init(d),d.prototype.setSeatIndex=function(a){this.position.x=this.resources.getPoint("dealerButtonPosition"+a).x,this.position.y=this.resources.getPoint("dealerButtonPosition"+a).y,this.dispatchEvent("animationDone",this)},d.prototype.animateToSeatIndex=function(a){if(!this.visible)return this.setSeatIndex(a),void this.dispatchEvent("animationDone",this);var b=this.resources.getPoint("dealerButtonPosition"+a),c=this.position.x-b.x,d=this.position.y-b.y,e=Math.sqrt(c*c+d*d);new f.Tween(this.position).to({x:b.x,y:b.y},this.viewConfig.scaleAnimationTime(5*e)).easing(f.Easing.Quadratic.Out).onComplete(this.onShowComplete.bind(this)).start()},d.prototype.onShowComplete=function(){this.dispatchEvent("animationDone",this)},d.prototype.hide=function(){this.visible=!1},d.prototype.show=function(a,b){this.visible&&b?this.animateToSeatIndex(a):(this.visible=!0,this.setSeatIndex(a))},b.exports=d},{inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],31:[function(a,b,c){function d(a){f.call(this),this.buttonTexture=a.getTexture("dialogButton"),this.addChild(new e.Sprite(this.buttonTexture));var b={font:"normal 14px Arial",fill:"#ffffff"};this.textField=new e.Text("[test]",b),this.textField.position.y=15,this.addChild(this.textField),this.setText("BTN")}var e=a("pixi.js"),f=a("../../utils/Button"),g=a("inherits");g(d,f),d.prototype.setText=function(a){this.textField.setText(a),this.textField.updateTransform(),this.textField.x=this.buttonTexture.width/2-this.textField.width/2},b.exports=d},{"../../utils/Button":79,inherits:7,"pixi.js":8}],32:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.resources=b;var c=new e.Graphics;c.beginFill(0,.5),c.drawRect(-1e3,-1e3,2960,2720),c.endFill(),c.interactive=!0,c.hitArea=new e.Rectangle(0,0,960,720),this.addChild(c);var d=new f(this.resources.getTexture("framePlate"),10);d.setLocalSize(480,270),d.position.x=240,d.position.y=225,this.addChild(d),style={font:"normal 14px Arial"},this.textField=new e.Text("[text]",style),this.textField.position.x=d.position.x+20,this.textField.position.y=d.position.y+20,this.addChild(this.textField),this.buttonsHolder=new e.DisplayObjectContainer,this.buttonsHolder.position.y=430,this.addChild(this.buttonsHolder),this.buttons=[];for(var h=0;2>h;h++){var d=new g(this.resources);d.position.x=90*h,d.on("click",this.onButtonClick,this),this.buttonsHolder.addChild(d),this.buttons.push(d)}style={font:"normal 18px Arial"},this.inputField=new j("",style),this.inputField.position.x=this.textField.position.x,this.inputFrame=new e.Graphics,this.inputFrame.beginFill(0),this.inputFrame.drawRect(-1,-1,102,23),this.inputFrame.position.x=this.inputField.position.x,this.addChild(this.inputFrame),this.addChild(this.inputField),this.hide()}var e=a("pixi.js"),f=a("../../utils/NineSlice"),g=a("./DialogButton"),h=a("../../proto/data/ButtonData"),j=a("pixitextinput"),k=a("yaed"),l=a("inherits");l(d,e.DisplayObjectContainer),k.init(d),d.BUTTON_CLICK="buttonClick",d.prototype.hide=function(){this.visible=!1},d.prototype.show=function(a,b,c){for(this.visible=!0,this.buttonIds=b,i=0;i<this.buttons.length;i++)if(i<b.length){var d=this.buttons[i];d.setText(h.getButtonStringForId(b[i])),d.visible=!0}else this.buttons[i].visible=!1;this.buttonsHolder.x=480-90*b.length/2,this.textField.setText(a),c?(this.inputField.position.y=this.textField.position.y+this.textField.height+20,this.inputFrame.position.y=this.inputField.position.y,this.inputField.visible=!0,this.inputFrame.visible=!0,this.inputField.text=c,this.inputField.focus()):(this.inputField.visible=!1,this.inputFrame.visible=!1)},d.prototype.onButtonClick=function(a){for(var b=-1,c=0;c<this.buttons.length;c++)a.target==this.buttons[c]&&(b=c);var e=null;this.inputField.visible&&(e=this.inputField.text);var f={type:d.BUTTON_CLICK,button:this.buttonIds[b],value:e};this.trigger(f),this.hide()},b.exports=d},{"../../proto/data/ButtonData":45,"../../utils/NineSlice":86,"./DialogButton":31,inherits:7,"pixi.js":8,pixitextinput:10,yaed:14}],33:[function(a,b,c){function d(){e.DisplayObjectContainer.call(this);var a=new f;a.setSize(100,100),a.addColorStop(0,"#ffffff"),a.addColorStop(1,"#c0c0c0");var b=a.createSprite();b.position.x=-1e3,b.position.y=-1e3,b.width=2960,b.height=2720,this.addChild(b);var c={font:"bold 20px Arial",fill:"#808080"};this.textField=new e.Text("[text]",c),this.textField.position.x=480,this.textField.position.y=360-this.textField.height/2,this.addChild(this.textField)}var e=a("pixi.js"),f=a("../../utils/Gradient"),g=a("inherits");g(d,e.DisplayObjectContainer),d.prototype.show=function(a){this.textField.setText(a),this.textField.updateTransform(),this.textField.x=480-this.textField.width/2,this.visible=!0},d.prototype.hide=function(){this.visible=!1},b.exports=d},{"../../utils/Gradient":81,inherits:7,"pixi.js":8}],34:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.viewConfig=a,this.resources=b,this.setupBackground(),this.tableContainer=new e.DisplayObjectContainer,this.addChild(this.tableContainer),this.tableBackground=new e.Sprite(this.resources.getTexture("tableBackground")),this.tableContainer.addChild(this.tableBackground),this.tableBackground.position.x=this.resources.getPoint("tablePosition").x,this.tableBackground.position.y=this.resources.getPoint("tablePosition").y,this.setupSeats(),this.setupCommunityCards(),this.timerView=new r(this.viewConfig,this.resources),this.tableContainer.addChild(this.timerView),this.chatView=new j(this.viewConfig,this.resources),this.addChild(this.chatView),this.buttonsView=new m(this.viewConfig,this.resources),this.addChild(this.buttonsView),this.dealerButtonView=new o(this.viewConfig,this.resources),this.addChild(this.dealerButtonView),this.tableInfoView=new t(this.viewConfig,this.resources),this.addChild(this.tableInfoView),this.potView=new q(this.viewConfig,this.resources),this.addChild(this.potView),this.potView.position.x=this.resources.getPoint("potPosition").x,this.potView.position.y=this.resources.getPoint("potPosition").y,this.settingsView=new s(this.viewConfig,this.resources),this.addChild(this.settingsView),this.dialogView=new n(this.viewConfig,this.resources),this.addChild(this.dialogView),this.presetButtonsView=new u(this.viewConfig,this.resources),this.addChild(this.presetButtonsView),this.setupChips()}var e=a("pixi.js"),f=a("yaed"),g=a("./SeatView"),h=a("./CardView"),j=a("./ChatView"),k=a("../../utils/Point"),l=a("../../utils/Gradient"),m=a("./ButtonsView"),n=a("./DialogView"),o=a("./DealerButtonView"),p=a("./ChipsView"),q=a("./PotView"),r=a("./TimerView"),s=a("../view/SettingsView"),t=a("../view/TableInfoView"),u=a("../view/PresetButtonsView"),v=a("inherits");v(d,e.DisplayObjectContainer),f.init(d),d.SEAT_CLICK="seatClick",d.prototype.setupBackground=function(){var a=new e.Graphics;a.beginFill(342301,1),a.drawRect(-1e3,0,2960,720),a.endFill(),this.addChild(a);var a=new e.Graphics;a.beginFill(9474192,1),a.drawRect(-1e3,720,2960,1e3),a.endFill(),this.addChild(a);var b=new l;b.setSize(100,100),b.addColorStop(0,"#606060"),b.addColorStop(.05,"#a0a0a0"),b.addColorStop(1,"#909090");var c=b.createSprite();c.position.y=530,c.position.x=-1e3,c.width=2960,c.height=190,this.addChild(c);var c=new e.Sprite(this.resources.getTexture("dividerLine"));c.x=345,c.y=540,this.addChild(c);var c=new e.Sprite(this.resources.getTexture("dividerLine"));c.x=693,c.y=540,this.addChild(c)},d.prototype.setupSeats=function(){var a,b;for(this.seatViews=[],a=0;10>a;a++){var c=new g(this.resources,a),d=c.position;for(b=0;2>b;b++){var e=new h(this.viewConfig,this.resources);e.hide(),e.setTargetPosition(k(d.x+30*b-60,d.y-100)),this.tableContainer.addChild(e),c.addPocketCard(e),c.on("click",this.onSeatClick,this)}this.tableContainer.addChild(c),this.seatViews.push(c)}},d.prototype.setupChips=function(){var a;for(a=0;10>a;a++){var b=new p(this.viewConfig,this.resources);this.seatViews[a].setBetChipsView(b),b.setAlignment(this.resources.getValue("betAlign").charAt(a)),b.setTargetPosition(this.resources.getPoint("betPosition"+a)),this.tableContainer.addChild(b)}},d.prototype.onSeatClick=function(a){for(var b=-1,c=0;c<this.seatViews.length;c++)a.target==this.seatViews[c]&&(b=c);console.log("seat click: "+b),this.trigger({type:d.SEAT_CLICK,seatIndex:b})},d.prototype.setupCommunityCards=function(){this.communityCards=[];var a=this.resources.getPoint("communityCardsPosition"),b=parseInt(this.resources.getValue("communityCardMargin"));for(i=0;i<5;i++){var c=new h(this.viewConfig,this.resources);c.hide(),c.setTargetPosition(k(a.x+i*(c.back.width+b),a.y)),this.communityCards.push(c),this.tableContainer.addChild(c)}},d.prototype.getSeatViewByIndex=function(a){return this.seatViews[a]},d.prototype.getCommunityCards=function(){return this.communityCards},d.prototype.getButtonsView=function(){return this.buttonsView},d.prototype.getPresetButtonsView=function(){return this.presetButtonsView},d.prototype.getDialogView=function(){return this.dialogView},d.prototype.getDealerButtonView=function(){return this.dealerButtonView},d.prototype.getTableInfoView=function(){return this.tableInfoView},d.prototype.getSettingsView=function(){return this.settingsView},d.prototype.clear=function(){var a;for(a=0;a<this.communityCards.length;a++)this.communityCards[a].hide();for(a=0;a<this.seatViews.length;a++)this.seatViews[a].clear();this.timerView.hide(),this.potView.setValues(new Array),this.dealerButtonView.hide(),this.chatView.clear(),this.presetButtonsView.hide(),this.dialogView.hide(),this.buttonsView.clear(),this.tableInfoView.clear(),this.settingsView.clear()},b.exports=d},{"../../utils/Gradient":81,"../../utils/Point":87,"../view/PresetButtonsView":37,"../view/SettingsView":41,"../view/TableInfoView":42,"./ButtonsView":25,"./CardView":27,"./ChatView":28,"./ChipsView":29,"./DealerButtonView":30,"./DialogView":32,"./PotView":35,"./SeatView":39,"./TimerView":43,inherits:7,"pixi.js":8,yaed:14}],35:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.viewConfig=a,this.resources=b,this.value=0,this.holder=new e.DisplayObjectContainer,this.addChild(this.holder),this.stacks=new Array}var e=a("pixi.js"),f=(a("tween.js"),a("yaed")),g=a("./ChipsView"),h=a("inherits");h(d,e.DisplayObjectContainer),f.init(d),d.prototype.setValues=function(a){for(var b=0;b<this.stacks.length;b++)this.holder.removeChild(this.stacks[b]);this.stacks=new Array;for(var c=0,b=0;b<a.length;b++){var d=new g(this.viewConfig,this.resources,!1);this.stacks.push(d),this.holder.addChild(d),d.setValue(a[b]),d.x=c,c+=Math.floor(d.width+20);var f=new e.Text(a[b],{font:"bold 12px Arial",align:"center",fill:"#ffffff"});f.position.x=.5*(d.width-f.width),f.position.y=30,d.addChild(f)}this.holder.x=.5*-this.holder.width},d.prototype.hide=function(){this.visible=!1},d.prototype.show=function(){this.visible=!0},b.exports=d},{"./ChipsView":29,inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],36:[function(a,b,c){function d(a){e.DisplayObjectContainer.call(this),this.resources=a,this.id=null,this.visible=!1,this.value=0;var b=new e.Sprite(this.resources.getTexture("checkboxBackground")),c=new e.Sprite(this.resources.getTexture("checkboxTick"));c.x=1,this.checkbox=new g(b,c),this.checkbox.addEventListener("change",this.onCheckboxChange,this),this.addChild(this.checkbox);var d={font:"bold 12px Arial",wordWrap:!0,wordWrapWidth:250,fill:"white"};this.labelField=new e.Text("",d),this.labelField.position.x=25,this.addChild(this.labelField)}var e=a("pixi.js"),f=(a("tween.js"),a("yaed")),g=a("../../utils/Checkbox"),h=a("../../proto/data/ButtonData"),i=a("inherits");i(d,e.DisplayObjectContainer),f.init(d),d.CHANGE="change",d.prototype.onCheckboxChange=function(){this.dispatchEvent(d.CHANGE)},d.prototype.setLabel=function(a){return this.labelField.setText(a),a},d.prototype.show=function(a,b){this.id=a,this.value=b,this.value>0?this.setLabel(h.getButtonStringForId(a)+" ("+this.value+")"):this.setLabel(h.getButtonStringForId(a)),this.visible=!0},d.prototype.hide=function(){this.id=null,this.visible=!1,this.value=0,this.setChecked(!1)},d.prototype.getChecked=function(){return this.checkbox.getChecked()},d.prototype.setChecked=function(a){return this.checkbox.setChecked(a),this.checkbox.getChecked()},d.prototype.getValue=function(){return this.value},b.exports=d},{"../../proto/data/ButtonData":45,"../../utils/Checkbox":80,inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],37:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.resources=b,this.buttons=new Array;for(var c=this.resources.getPoint("bigButtonPosition"),d=0;6>d;d++){var f=new g(this.resources);f.addEventListener(g.CHANGE,this.onPresetButtonChange,this),f.x=c.x+30+140*(d%2),f.y=c.y+35*Math.floor(d/2),this.addChild(f),this.buttons.push(f)}this.hide()}var e=a("pixi.js"),f=(a("tween.js"),a("yaed")),g=a("./PresetButton"),h=a("inherits");h(d,e.DisplayObjectContainer),f.init(d),d.CHANGE="change",d.prototype.onPresetButtonChange=function(a){for(var b=0;b<this.buttons.length;b++){var c=this.buttons[b];c!=a.target&&c.setChecked(!1)}this.dispatchEvent(d.CHANGE)},d.prototype.hide=function(){for(var a=0;a<this.buttons.length;a++)this.buttons[a].hide()},d.prototype.show=function(){this.visible=!0},d.prototype.getButtons=function(){return this.buttons},d.prototype.getCurrent=function(){for(var a=0;a<this.buttons.length;a++)if(1==this.buttons[a].getChecked())return this.buttons[a];return null},d.prototype.setCurrent=function(a){for(var b=0;b<this.buttons.length;b++){var c=this.buttons[b];null!=a&&c.id==a?c.setChecked(!0):c.setChecked(!1)}},b.exports=d},{"./PresetButton":36,inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],38:[function(a,b,c){function d(a){var b=new g(a.getTexture("buttonBackground"),10,5,10,5);b.setLocalSize(105,25),f.call(this,b);var c={width:105,height:20,font:"bold 14px Arial",color:"white"};this.label=new e.Text("",c),this.label.position.x=8,this.label.position.y=4,this.addChild(this.label)}var e=a("pixi.js"),f=(a("tween.js"),a("../../utils/Button")),g=a("../../utils/NineSlice"),h=a("yaed"),i=(a("../../utils/Checkbox"),a("inherits"));i(d,f),h.init(d),d.prototype.setText=function(a){return this.label.setText(a),a},d.prototype.setEnabled=function(a){return a?(this.alpha=1,this.interactive=!0,this.buttonMode=!0):(this.alpha=.5,this.interactive=!1,this.buttonMode=!1),a},b.exports=d},{"../../utils/Button":79,"../../utils/Checkbox":80,"../../utils/NineSlice":86,inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],39:[function(a,b,c){function d(a,b){g.call(this),this.pocketCards=[],this.resources=a,this.seatIndex=b;var c=this.resources.getTexture("seatPlate"),d=new e.Sprite(c);d.position.x=-c.width/2,d.position.y=-c.height/2,this.addChild(d);var f=this.resources.getPoint("seatPosition"+this.seatIndex);this.position.x=f.x,this.position.y=f.y;var h;h={font:"bold 20px Arial"},this.nameField=new e.Text("[name]",h),this.nameField.position.y=-20,this.addChild(this.nameField),h={font:"normal 12px Arial"},this.chipsField=new e.Text("[name]",h),this.chipsField.position.y=5,this.addChild(this.chipsField),h={font:"bold 20px Arial"},this.actionField=new e.Text("action",h),this.actionField.position.y=-13,this.addChild(this.actionField),this.actionField.alpha=0,this.setName(""),this.setChips(""),this.betChips=null}var e=a("pixi.js"),f=a("tween.js"),g=a("../../utils/Button"),h=a("inherits");h(d,g),d.prototype.setBetChipsView=function(a){this.betChips=a},d.prototype.setName=function(a){this.nameField.setText(a),this.nameField.updateTransform(),this.nameField.position.x=-this.nameField.canvas.width/2},d.prototype.setChips=function(a){this.chipsField.setText(a),this.chipsField.updateTransform(),this.chipsField.position.x=-this.chipsField.canvas.width/2},d.prototype.setSitout=function(a){a?this.alpha=.5:this.alpha=1},d.prototype.setActive=function(a){this.visible=a},d.prototype.addPocketCard=function(a){this.pocketCards.push(a)},d.prototype.getPocketCards=function(){return this.pocketCards},d.prototype.foldCards=function(){this.pocketCards[0].addEventListener("animationDone",this.onFoldComplete,this);for(var a=0;a<this.pocketCards.length;a++)this.pocketCards[a].fold()},d.prototype.onFoldComplete=function(){this.pocketCards[0].removeEventListener("animationDone",this.onFoldComplete,this),this.dispatchEvent("animationDone")},d.prototype.action=function(a){this.actionField.setText(a),this.actionField.position.x=-this.actionField.canvas.width/2,this.actionField.alpha=1,this.nameField.alpha=0,this.chipsField.alpha=0,setTimeout(this.onTimer.bind(this),1e3)},d.prototype.onTimer=function(a){new f.Tween(this.actionField).to({alpha:0},1e3).start(),new f.Tween(this.nameField).to({alpha:1},1e3).start(),new f.Tween(this.chipsField).to({alpha:1},1e3).start()},d.prototype.clear=function(){var a;for(this.visible=!0,this.sitout=!1,this.betChips.setValue(0),this.setName(""),this.setChips(""),a=0;a<this.pocketCards.length;a++)this.pocketCards[a].hide()},b.exports=d},{"../../utils/Button":79,inherits:7,"pixi.js":8,"tween.js":13}],40:[function(a,b,c){function d(a,b,c){e.DisplayObjectContainer.call(this),this.resources=a,this.id=b;var d=0,f={width:200,height:25,font:"bold 13px Arial",color:"white"};this.label=new e.Text(c,f),this.label.position.x=25,this.label.position.y=d+1,this.addChild(this.label);var h=new e.Sprite(this.resources.getTexture("checkboxBackground")),i=new e.Sprite(this.resources.getTexture("checkboxTick"));i.x=1,this.checkbox=new g(h,i),this.checkbox.position.y=d,this.addChild(this.checkbox),this.checkbox.addEventListener("change",this.onCheckboxChange,this)}var e=a("pixi.js"),f=(a("tween.js"),a("../../utils/Button"),a("../../utils/NineSlice"),a("yaed")),g=a("../../utils/Checkbox"),h=a("inherits");h(d,e.DisplayObjectContainer),f.init(d),d.prototype.onCheckboxChange=function(a){this.dispatchEvent("change",this)},d.prototype.getChecked=function(){return this.checkbox.getChecked()},d.prototype.setChecked=function(a){return this.checkbox.setChecked(a),a},b.exports=d},{"../../utils/Button":79,"../../utils/Checkbox":80,"../../utils/NineSlice":86,inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],41:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.viewConfig=a,this.resources=b;var c=new e.DisplayObjectContainer,d=new g(this.resources.getTexture("chatBackground"),10,10,10,10);d.setLocalSize(30,30),c.addChild(d);var h=new e.Sprite(this.resources.getTexture("wrenchIcon"));h.x=5,h.y=5,c.addChild(h),this.settingsButton=new f(c),this.settingsButton.position.x=950-this.settingsButton.width,this.settingsButton.position.y=543,this.settingsButton.addEventListener(f.CLICK,this.onSettingsButtonClick,this),this.addChild(this.settingsButton),this.settingsMenu=new e.DisplayObjectContainer;var i=new g(this.resources.getTexture("chatBackground"),10,10,10,10);i.setLocalSize(250,100),this.settingsMenu.addChild(i);var l={font:"bold 14px Arial",color:"#FFFFFF",width:200,height:20},m=new e.Text("Settings",l);m.position.x=16,m.position.y=10,this.settingsMenu.addChild(m),this.settingsMenu.position.x=950-this.settingsMenu.width,this.settingsMenu.position.y=538-this.settingsMenu.height,this.addChild(this.settingsMenu),this.settings={},this.createMenuSetting("playAnimations","Play animations",40,this.viewConfig.getPlayAnimations()),this.createMenuSetting(k.AUTO_MUCK_LOSING,"Muck losing hands",65),this.createSetting(k.AUTO_POST_BLINDS,"Post blinds",0),this.createSetting(k.SITOUT_NEXT,"Sit out",25),this.settingsMenu.visible=!1,this.buyChipsButton=new j(this.resources),this.buyChipsButton.addEventListener("click",this.onBuyChipsClick,this),this.buyChipsButton.x=700,this.buyChipsButton.y=635,this.buyChipsButton.setText("Buy chips"),this.addChild(this.buyChipsButton),this.buyChipsButton.visible=!1}var e=a("pixi.js"),f=(a("tween.js"),a("../../utils/Button")),g=a("../../utils/NineSlice"),h=a("yaed"),i=a("./SettingsCheckbox"),j=a("./RaiseShortcutButton"),k=a("../../proto/messages/CheckboxMessage"),l=a("../../proto/data/ButtonData"),m=a("inherits");m(d,e.DisplayObjectContainer),h.init(d),d.BUY_CHIPS_CLICK="buyChipsClick",d.CHECKBOX_CHANGE="checkboxChange",d.prototype.onBuyChipsClick=function(a){console.log("buy chips click"),this.dispatchEvent(d.BUY_CHIPS_CLICK)},d.prototype.createMenuSetting=function(a,b,c,d){var e=new i(this.resources,a,b);e.y=c,e.x=16,this.settingsMenu.addChild(e),e.addEventListener("change",this.onCheckboxChange,this),this.settings[a]=e,e.setChecked(d)},d.prototype.createSetting=function(a,b,c){var d=new i(this.resources,a,b);d.y=545+c,d.x=700,this.addChild(d),d.addEventListener("change",this.onCheckboxChange,this),this.settings[a]=d},d.prototype.onCheckboxChange=function(a){"playAnimations"==a.id&&(this.viewConfig.setPlayAnimations(a.getChecked()),console.log("anims changed..")),this.dispatchEvent(d.CHECKBOX_CHANGE,{checkboxId:a.id,checked:a.getChecked()})},d.prototype.onSettingsButtonClick=function(a){console.log("SettingsView.prototype.onSettingsButtonClick"),this.settingsMenu.visible=!this.settingsMenu.visible,this.settingsMenu.visible?this.stage.mousedown=this.stage.touchstart=this.onStageMouseDown.bind(this):this.stage.mousedown=null},d.prototype.onStageMouseDown=function(a){console.log("SettingsView.prototype.onStageMouseDown"),this.hitTest(this.settingsMenu,a)||this.hitTest(this.settingsButton,a)||(this.stage.mousedown=null,this.settingsMenu.visible=!1)},d.prototype.hitTest=function(a,b){return b.global.x>a.getBounds().x&&b.global.x<a.getBounds().x+a.getBounds().width&&b.global.y>a.getBounds().y&&b.global.y<a.getBounds().y+a.getBounds().height?!0:!1},d.prototype.clear=function(){this.buyChipsButton.enabled=!0,this.setVisibleButtons([]),this.setCheckboxChecked(k.AUTO_POST_BLINDS,!1),this.setCheckboxChecked(k.AUTO_MUCK_LOSING,!1),this.setCheckboxChecked(k.SITOUT_NEXT,!1),this.settingsMenu.visible=!1,this.settingsMenu.visible&&(this.stage.mousedown=null)},d.prototype.setVisibleButtons=function(a){this.buyChipsButton.visible=-1!=a.indexOf(l.BUY_CHIPS),this.settings[k.AUTO_POST_BLINDS].visible=a.indexOf(k.AUTO_POST_BLINDS)>=0,this.settings[k.SITOUT_NEXT].visible=a.indexOf(k.SITOUT_NEXT)>=0;var b=543;this.buyChipsButton.visible?(this.buyChipsButton.y=b,b+=35):b+=2,this.settings[k.AUTO_POST_BLINDS].visible&&(this.settings[k.AUTO_POST_BLINDS].y=b,b+=25),this.settings[k.SITOUT_NEXT].visible&&(this.settings[k.SITOUT_NEXT].y=b,b+=25)},d.prototype.setCheckboxChecked=function(a,b){this.settings[a].setChecked(b)},b.exports=d},{"../../proto/data/ButtonData":45,"../../proto/messages/CheckboxMessage":53,"../../utils/Button":79,"../../utils/NineSlice":86,"./RaiseShortcutButton":38,"./SettingsCheckbox":40,inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],42:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.viewConfig=a,this.resources=b;var c={font:"bold 24px Times New Roman",fill:"#ffffff",dropShadow:!0,dropShadowColor:"#000000",dropShadowDistance:2,stroke:"#000000",strokeThickness:2,wordWrap:!0,wordWrapWidth:300};this.tableInfoText=new e.Text("<TableInfoText>",c),this.tableInfoText.position.x=355,this.tableInfoText.position.y=540,this.addChild(this.tableInfoText);var c={font:"bold 24px Times New Roman",fill:"#ffffff",align:"center"};this.preTournamentInfoText=new e.Text("<PreTournamentInfoText>",c),this.preTournamentInfoText.position.y=360,this.preTournamentInfoText.position.x=Math.round(660)/2,this.preTournamentInfoText.alpha=.25,this.addChild(this.preTournamentInfoText);var c={font:"bold 12px Arial",fill:"#ffffff",dropShadow:!0,dropShadowColor:"#000000",dropShadowDistance:1,stroke:"#000000",strokeThickness:1};this.handInfoText=new e.Text("<HandInfoText>",c),this.handInfoText.position.y=10,this.handInfoText.position.x=960-this.handInfoText.width,this.addChild(this.handInfoText),this.joinButton=new g(this.resources),this.joinButton.position.x=355,this.joinButton.setText("JOIN"),this.joinButton.visible=!1,this.joinButton.on("click",this.onButtonClick,this),this.addChild(this.joinButton),this.leaveButton=new g(this.resources),this.leaveButton.position.x=355,this.leaveButton.setText("LEAVE"),this.leaveButton.visible=!1,this.leaveButton.on("click",this.onButtonClick,this),this.addChild(this.leaveButton)}var e=a("pixi.js"),f=a("yaed"),g=a("./DialogButton"),h=a("inherits"),i=a("../../proto/data/ButtonData");h(d,e.DisplayObjectContainer),f.init(d),d.BUTTON_CLICK="buttonClick",d.prototype.setTableInfoText=function(a){a||(a=""),this.tableInfoText.setText(a),this.joinButton.position.y=this.tableInfoText.position.y+this.tableInfoText.height+5,this.leaveButton.position.y=this.tableInfoText.position.y+this.tableInfoText.height+5},d.prototype.setPreTournamentInfoText=function(a){a||(a=""),this.preTournamentInfoText.setText(a),this.preTournamentInfoText.position.x=480-this.preTournamentInfoText.width/2},d.prototype.setJoinButtonVisible=function(a){this.joinButton.visible=a},d.prototype.setLeaveButtonVisible=function(a){this.leaveButton.visible=a},d.prototype.setHandInfoText=function(a){a||(a=""),this.handInfoText.setText(a),this.handInfoText.updateTransform(),this.handInfoText.position.x=960-this.handInfoText.width-10},d.prototype.clear=function(){this.tableInfoText.setText(""),this.handInfoText.setText(""),this.preTournamentInfoText.setText(""),this.joinButton.visible=!1,this.leaveButton.visible=!1},d.prototype.onButtonClick=function(a){this.joinButton.visible=!1,this.leaveButton.visible=!1;var b={type:d.BUTTON_CLICK};a.target==this.joinButton&&(b.button=i.JOIN_TOURNAMENT),a.target==this.leaveButton&&(b.button=i.LEAVE_TOURNAMENT),console.log("button click"),this.trigger(b)},b.exports=d},{"../../proto/data/ButtonData":45,"./DialogButton":31,inherits:7,"pixi.js":8,yaed:14}],43:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.resources=b,this.timerClip=new e.Sprite(this.resources.getTexture("timerBackground")),this.addChild(this.timerClip),this.canvas=new e.Graphics,this.canvas.x=.5*this.timerClip.width,this.canvas.y=.5*this.timerClip.height,this.timerClip.addChild(this.canvas),this.timerClip.visible=!1,this.tween=null}var e=a("pixi.js"),f=a("tween.js"),g=a("yaed"),h=a("inherits");h(d,e.DisplayObjectContainer),g.init(d),d.prototype.hide=function(){this.timerClip.visible=!1,this.stop()},d.prototype.show=function(a){this.timerClip.visible=!0;var b=this.resources.getPoint("seatPosition"+a),c=this.resources.getPoint("timerOffset");this.timerClip.x=b.x+c.x,this.timerClip.y=b.y+c.y,this.stop()},d.prototype.stop=function(a){null!=this.tween&&this.tween.stop()},d.prototype.countdown=function(a,b){this.stop(),a*=1e3,b*=1e3;var c=Date.now();this.startAt=c+b-a,this.stopAt=c+b,this.tween=new f.Tween({time:c}).to({time:this.stopAt},b).onUpdate(this.onUpdate.bind(this)).onComplete(this.onComplete.bind(this)).start()},d.prototype.onUpdate=function(){var a=Date.now(),b=100*(a-this.startAt)/(this.stopAt-this.startAt);this.showPercent(b)},d.prototype.onComplete=function(){var a=(Date.now(),100);this.showPercent(a),this.tween=null},d.prototype.showPercent=function(a){0>a&&(a=0),a>100&&(a=100),this.canvas.clear(),this.canvas.beginFill(12582912),this.canvas.drawCircle(0,0,10),this.canvas.endFill(),this.canvas.beginFill(16777215),this.canvas.moveTo(0,0);for(var b=0;33>b;b++)this.canvas.lineTo(10*Math.cos(b*a*2*Math.PI/3200-Math.PI/2),10*Math.sin(b*a*2*Math.PI/3200-Math.PI/2));this.canvas.lineTo(0,0),this.canvas.endFill()},b.exports=d},{inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],44:[function(a,b,c){function d(a){e.call(this),this.logMessages=!1,this.messageDispatcher=new e,this.connection=a,this.connection.addEventListener("message",this.onConnectionMessage,this),this.connection.addEventListener("close",this.onConnectionClose,this)}var e=a("yaed"),f=a("inherits"),g=a("./messages/InitMessage"),h=a("./messages/StateCompleteMessage"),i=a("./messages/SeatInfoMessage"),j=a("./messages/CommunityCardsMessage"),k=a("./messages/PocketCardsMessage"),l=a("./messages/SeatClickMessage"),m=a("./messages/ShowDialogMessage"),n=a("./messages/ButtonClickMessage"),o=a("./messages/ButtonsMessage"),p=a("./messages/DelayMessage"),q=a("./messages/ClearMessage"),r=a("./messages/DealerButtonMessage"),s=a("./messages/BetMessage"),t=a("./messages/BetsToPotMessage"),u=a("./messages/ActionMessage"),v=a("./messages/ChatMessage"),w=a("./messages/CheckboxMessage"),x=a("./messages/FadeTableMessage"),y=a("./messages/HandInfoMessage"),z=a("./messages/InterfaceStateMessage"),A=a("./messages/PayOutMessage"),B=a("./messages/PotMessage"),C=a("./messages/PresetButtonClickMessage"),D=a("./messages/PresetButtonsMessage"),E=a("./messages/PreTournamentInfoMessage"),F=a("./messages/TableButtonClickMessage"),G=a("./messages/TableButtonsMessage"),H=a("./messages/TableInfoMessage"),I=a("./messages/TestCaseRequestMessage"),J=a("./messages/TimerMessage"),K=a("./messages/TournamentResultMessage"),L=a("./messages/FoldCardsMessage");f(d,e),d.CLOSE="close",d.MESSAGE="message",d.MESSAGE_TYPES={},d.MESSAGE_TYPES[g.TYPE]=g,d.MESSAGE_TYPES[h.TYPE]=h,d.MESSAGE_TYPES[i.TYPE]=i,d.MESSAGE_TYPES[j.TYPE]=j,d.MESSAGE_TYPES[k.TYPE]=k,d.MESSAGE_TYPES[l.TYPE]=l,d.MESSAGE_TYPES[m.TYPE]=m,d.MESSAGE_TYPES[n.TYPE]=n,d.MESSAGE_TYPES[o.TYPE]=o,d.MESSAGE_TYPES[p.TYPE]=p,d.MESSAGE_TYPES[q.TYPE]=q,d.MESSAGE_TYPES[r.TYPE]=r,d.MESSAGE_TYPES[s.TYPE]=s,d.MESSAGE_TYPES[t.TYPE]=t,d.MESSAGE_TYPES[u.TYPE]=u,d.MESSAGE_TYPES[v.TYPE]=v,d.MESSAGE_TYPES[w.TYPE]=w,d.MESSAGE_TYPES[x.TYPE]=x,d.MESSAGE_TYPES[y.TYPE]=y,d.MESSAGE_TYPES[z.TYPE]=z,d.MESSAGE_TYPES[A.TYPE]=A,d.MESSAGE_TYPES[B.TYPE]=B,d.MESSAGE_TYPES[C.TYPE]=C,d.MESSAGE_TYPES[D.TYPE]=D,d.MESSAGE_TYPES[E.TYPE]=E,d.MESSAGE_TYPES[F.TYPE]=F,d.MESSAGE_TYPES[G.TYPE]=G,d.MESSAGE_TYPES[H.TYPE]=H,d.MESSAGE_TYPES[I.TYPE]=I,d.MESSAGE_TYPES[J.TYPE]=J,d.MESSAGE_TYPES[K.TYPE]=K,d.MESSAGE_TYPES[L.TYPE]=L,d.prototype.addMessageHandler=function(a,b,c){a.hasOwnProperty("TYPE")&&(a=a.TYPE),this.messageDispatcher.on(a,b,c)},d.prototype.removeMessageHandler=function(a,b,c){a.hasOwnProperty("TYPE")&&(a=a.TYPE),this.messageDispatcher.off(a,b,c)},d.prototype.onConnectionMessage=function(a){var b,c=a.message;this.logMessages&&console.log("==> "+JSON.stringify(c));for(type in d.MESSAGE_TYPES)c.type==type&&(b=d.MESSAGE_TYPES[type]);if(!b)return void console.warn("unknown message: "+c.type);var e=new b;e.unserialize(c),e.type=c.type,this.messageDispatcher.trigger(e),this.trigger({type:d.MESSAGE,message:e})},d.prototype.onConnectionClose=function(a){this.connection.off("message",this.onConnectionMessage,this),this.connection.off("close",this.onConnectionClose,this),this.close(),this.connection=null,this.trigger(d.CLOSE)},d.prototype.send=function(a){var b=a.serialize();for(type in d.MESSAGE_TYPES)a instanceof d.MESSAGE_TYPES[type]&&(b.type=type);if(!b.type)throw new Error("Unknown message type for send, message="+a.constructor.name);this.connection.send(b)},d.prototype.setLogMessages=function(a){this.logMessages=a},d.prototype.close=function(){this.connection&&(void 0===this.connection.readyState||1==this.connection.readyState)&&this.connection.close()},d.prototype.toString=function(){return"<ProtoConnection>"},b.exports=d},{"./messages/ActionMessage":47,"./messages/BetMessage":48,"./messages/BetsToPotMessage":49,"./messages/ButtonClickMessage":50,"./messages/ButtonsMessage":51,"./messages/ChatMessage":52,"./messages/CheckboxMessage":53,"./messages/ClearMessage":54,"./messages/CommunityCardsMessage":55,"./messages/DealerButtonMessage":56,"./messages/DelayMessage":57,"./messages/FadeTableMessage":58,"./messages/FoldCardsMessage":59,"./messages/HandInfoMessage":60,"./messages/InitMessage":61,"./messages/InterfaceStateMessage":62,"./messages/PayOutMessage":63,"./messages/PocketCardsMessage":64,"./messages/PotMessage":65,"./messages/PreTournamentInfoMessage":66,"./messages/PresetButtonClickMessage":67,"./messages/PresetButtonsMessage":68,"./messages/SeatClickMessage":69,"./messages/SeatInfoMessage":70,"./messages/ShowDialogMessage":71,"./messages/StateCompleteMessage":72,"./messages/TableButtonClickMessage":73,
"./messages/TableButtonsMessage":74,"./messages/TableInfoMessage":75,"./messages/TestCaseRequestMessage":76,"./messages/TimerMessage":77,"./messages/TournamentResultMessage":78,inherits:7,yaed:14}],45:[function(a,b,c){function d(a,b){this.button=a,this.value=b}d.RAISE="raise",d.FOLD="fold",d.BET="bet",d.SIT_OUT="sitOut",d.SIT_IN="sitIn",d.CALL="call",d.POST_BB="postBB",d.POST_SB="postSB",d.CANCEL="cancel",d.CHECK="check",d.SHOW="show",d.MUCK="muck",d.OK="ok",d.IM_BACK="imBack",d.LEAVE="leave",d.CHECK_FOLD="checkFold",d.CALL_ANY="callAny",d.RAISE_ANY="raiseAny",d.BUY_IN="buyIn",d.RE_BUY="reBuy",d.JOIN_TOURNAMENT="joinTournament",d.LEAVE_TOURNAMENT="leaveTournament",d.prototype.getButton=function(){return this.button},d.prototype.getButtonString=function(){return d.getButtonStringForId(this.button)},d.prototype.getValue=function(){return this.value},d.getButtonStringForId=function(a){switch(a){case d.FOLD:return"FOLD";case d.CALL:return"CALL";case d.RAISE:return"RAISE TO";case d.BET:return"BET";case d.SIT_OUT:return"SIT OUT";case d.POST_BB:return"POST BB";case d.POST_SB:return"POST SB";case d.SIT_IN:return"SIT IN";case d.CANCEL:return"CANCEL";case d.CHECK:return"CHECK";case d.SHOW:return"SHOW";case d.MUCK:return"MUCK";case d.OK:return"OK";case d.IM_BACK:return"I'M BACK";case d.LEAVE:return"LEAVE";case d.CHECK_FOLD:return"CHECK / FOLD";case d.CALL_ANY:return"CALL ANY";case d.RAISE_ANY:return"RAISE ANY";case d.RE_BUY:return"RE-BUY";case d.BUY_IN:return"BUY IN"}return""},d.prototype.toString=function(){return"<ButtonData button="+this.button+", value="+this.value+">"},b.exports=d},{}],46:[function(a,b,c){function d(a){this.value=a}d.CARD_VALUE_STRINGS=["2","3","4","5","6","7","8","9","10","J","Q","K","A"],d.SUIT_STRINGS=["D","C","H","S"],d.LONG_SUIT_STRINGS=["Diamonds","Clubs","Hearts","Spades"],d.HIDDEN=-1,d.prototype.isShown=function(){return this.value>=0},d.prototype.getCardValue=function(){return this.value%13},d.prototype.getCardValueString=function(){return d.CARD_VALUE_STRINGS[this.value%13]},d.prototype.getSuitIndex=function(){return Math.floor(this.value/13)},d.prototype.getSuitString=function(){return d.SUIT_STRINGS[this.getSuitIndex()]},d.prototype.getLongSuitString=function(){return d.LONG_SUIT_STRINGS[this.getSuitIndex()]},d.prototype.getColor=function(){return this.getSuitIndex()%2!=0?"#000000":"#ff0000"},d.prototype.toString=function(){return this.value<0?"XX":this.getCardValueString()+this.getSuitString()},d.prototype.getValue=function(){return this.value},d.compareValue=function(a,b){if(!(a instanceof d&&b instanceof d))throw new Error("Not comparing card data");return a.getValue()>b.getValue()?1:a.getValue()<b.getValue()?-1:0},d.compareCardValue=function(a,b){if(!(a instanceof d&&b instanceof d))throw new Error("Not comparing card data");return a.getCardValue()>b.getCardValue()?1:a.getCardValue()<b.getCardValue()?-1:0},d.compareSuitIndex=function(a,b){if(!(a instanceof d&&b instanceof d))throw new Error("Not comparing card data");return a.getSuitIndex()>b.getSuitIndex()?1:a.getSuitIndex()<b.getSuitIndex()?-1:0},d.fromString=function(a){var b,c=-1;for(b=0;b<d.CARD_VALUE_STRINGS.length;b++){var e=d.CARD_VALUE_STRINGS[b];a.substring(0,e.length).toUpperCase()==e&&(c=b)}if(0>c)throw new Error("Not a valid card string: "+a);var f=a.substring(d.CARD_VALUE_STRINGS[c].length),g=-1;for(b=0;b<d.SUIT_STRINGS.length;b++){var e=d.SUIT_STRINGS[b];f.toUpperCase()==e&&(g=b)}if(0>g)throw new Error("Not a valid card string: "+a);return new d(13*g+c)},b.exports=d},{}],47:[function(a,b,c){function d(a,b){this.seatIndex=a,this.action=b}d.TYPE="action",d.FOLD="fold",d.CALL="call",d.RAISE="raise",d.CHECK="check",d.BET="bet",d.MUCK="muck",d.ANTE="ante",d.prototype.getSeatIndex=function(){return this.seatIndex},d.prototype.getAction=function(){return this.action},d.prototype.unserialize=function(a){this.seatIndex=a.seatIndex,this.action=a.action},d.prototype.serialize=function(){return{seatIndex:this.seatIndex,action:this.action}},b.exports=d},{}],48:[function(a,b,c){function d(a,b){this.seatIndex=a,this.value=b}d.TYPE="bet",d.prototype.getSeatIndex=function(){return this.seatIndex},d.prototype.getValue=function(){return this.value},d.prototype.unserialize=function(a){this.seatIndex=a.seatIndex,this.value=a.value},d.prototype.serialize=function(){return{seatIndex:this.seatIndex,value:this.value}},b.exports=d},{}],49:[function(a,b,c){function d(){}d.TYPE="betsToPot",d.prototype.unserialize=function(a){},d.prototype.serialize=function(){return{}},b.exports=d},{}],50:[function(a,b,c){function d(a,b){this.button=a,this.value=b}d.TYPE="buttonClick",d.prototype.getButton=function(){return this.button},d.prototype.getValue=function(){return this.value},d.prototype.unserialize=function(a){this.button=a.button,this.value=a.value},d.prototype.serialize=function(){return{button:this.button,value:this.value}},b.exports=d},{}],51:[function(a,b,c){function d(){this.buttons=[],this.sliderButtonIndex=0,this.min=-1,this.max=-1}var e=a("../data/ButtonData");d.TYPE="buttons",d.prototype.getButtons=function(){return this.buttons},d.prototype.addButton=function(a){this.buttons.push(a)},d.prototype.unserialize=function(a){this.buttons=[];for(var b=0;b<a.buttons.length;b++){var c=a.buttons[b],d=new e(c.button,c.value);this.addButton(d)}this.sliderButtonIndex=a.sliderButtonIndex,this.min=a.min,this.max=a.max},d.prototype.serialize=function(){for(var a=[],b=0;b<this.buttons.length;b++){var c={};c.button=this.buttons[b].getButton(),c.value=this.buttons[b].getValue(),a.push(c)}return{buttons:a,sliderButtonIndex:this.sliderButtonIndex,min:this.min,max:this.max}},b.exports=d},{"../data/ButtonData":45}],52:[function(a,b,c){function d(a,b){this.user=a,this.text=b}d.TYPE="chat",d.prototype.getText=function(){return this.text},d.prototype.getUser=function(){return this.user},d.prototype.unserialize=function(a){this.text=a.text,this.user=a.user},d.prototype.serialize=function(){return{text:this.text,user:this.user}},b.exports=d},{}],53:[function(a,b,c){function d(a,b){this.id=a,this.checked=b}d.TYPE="checkbox",d.AUTO_POST_BLINDS="autoPostBlinds",d.AUTO_MUCK_LOSING="autoMuckLosing",d.SITOUT_NEXT="sitoutNext",d.prototype.getId=function(){return this.id},d.prototype.getChecked=function(){return this.checked},d.prototype.unserialize=function(a){this.id=a.id,this.checked=a.checked},d.prototype.serialize=function(){return{id:this.id,checked:this.checked}},b.exports=d},{}],54:[function(a,b,c){function d(a){a||(a=[]),this.components=a}d.TYPE="clear",d.CARDS="cards",d.BETS="bets",d.POT="pot",d.CHAT="chat",d.prototype.getComponents=function(){return this.components},d.prototype.unserialize=function(a){this.components=a.components},d.prototype.serialize=function(){return{components:this.components}},b.exports=d},{}],55:[function(a,b,c){function d(a){a||(a=[]),this.animate=!1,this.cards=a,this.firstIndex=0}var e=a("../data/CardData");d.TYPE="communityCards",d.prototype.setAnimate=function(a){return this.animate=a},d.prototype.setFirstIndex=function(a){return this.firstIndex=a},d.prototype.addCard=function(a){this.cards.push(a)},d.prototype.getCards=function(){return this.cards},d.prototype.getFirstIndex=function(){return this.firstIndex},d.prototype.unserialize=function(a){var b;for(this.animate=a.animate,this.firstIndex=parseInt(a.firstIndex),this.cards=[],b=0;b<a.cards.length;b++)this.cards.push(new e(a.cards[b]))},d.prototype.serialize=function(){var a=[];for(i=0;i<this.cards.length;i++)a.push(this.cards[i].getValue());return{animate:this.animate,firstIndex:this.firstIndex,cards:a}},b.exports=d},{"../data/CardData":46}],56:[function(a,b,c){function d(a,b){this.seatIndex=a,this.animate=b}d.TYPE="dealerButton",d.prototype.getSeatIndex=function(){return this.seatIndex},d.prototype.getAnimate=function(){return this.animate},d.prototype.unserialize=function(a){this.seatIndex=a.seatIndex,this.animate=a.animate},d.prototype.serialize=function(){return{seatIndex:this.seatIndex,animate:this.animate}},b.exports=d},{}],57:[function(a,b,c){function d(a){this.delay=a}d.TYPE="delay",d.prototype.getDelay=function(){return this.delay},d.prototype.unserialize=function(a){this.delay=a.delay},d.prototype.serialize=function(){return{delay:this.delay}},b.exports=d},{}],58:[function(a,b,c){function d(a,b){this.visible=a,this.direction=b}d.TYPE="fadeTable",d.prototype.getVisible=function(){return this.visible},d.prototype.getDirection=function(){return this.direction},d.prototype.unserialize=function(a){this.visible=a.visible,this.direction=a.direction},d.prototype.serialize=function(){return{visible:this.visible,direction:this.direction}},b.exports=d},{}],59:[function(a,b,c){function d(a){this.seatIndex=a}d.TYPE="foldCards",d.prototype.getSeatIndex=function(){return this.seatIndex},d.prototype.unserialize=function(a){this.seatIndex=a.seatIndex},d.prototype.serialize=function(){return{seatIndex:this.seatIndex}},b.exports=d},{}],60:[function(a,b,c){function d(a,b){this.text=a,this.countdown=b}d.TYPE="handInfo",d.prototype.getText=function(){return this.text},d.prototype.getCountdown=function(){return this.countdown},d.prototype.unserialize=function(a){this.text=a.text,this.countdown=a.countdown},d.prototype.serialize=function(){return{text:this.text,countdown:this.countdown}},b.exports=d},{}],61:[function(a,b,c){function d(a){this.token=a,this.tableId=null,this.viewCase=null,this.tournamentId=null}d.TYPE="init",d.prototype.getToken=function(){return this.token},d.prototype.setTableId=function(a){this.tableId=a},d.prototype.getTableId=function(){return this.tableId},d.prototype.setTournamentId=function(a){this.tournamentId=a},d.prototype.getTournamentId=function(){return this.tournamentId},d.prototype.setViewCase=function(a){this.viewCase=a},d.prototype.getViewCase=function(){return this.viewCase},d.prototype.unserialize=function(a){this.token=a.token,this.tableId=a.tableId,this.viewCase=a.viewCase,this.tournamentId=a.tournamentId},d.prototype.serialize=function(){return{token:this.token,tableId:this.tableId,viewCase:this.viewCase,tournamentId:this.tournamentId}},b.exports=d},{}],62:[function(a,b,c){function d(a){a||(a=[]),this.visibleButtons=a}d.TYPE="interfaceState",d.prototype.getVisibleButtons=function(){return this.visibleButtons},d.prototype.addVisibleButton=function(a){this.visibleButtons.push(a)},d.prototype.unserialize=function(a){this.visibleButtons=a.visibleButtons},d.prototype.serialize=function(){return{visibleButtons:this.visibleButtons}},b.exports=d},{}],63:[function(a,b,c){function d(){this.values=[0,0,0,0,0,0,0,0,0,0]}d.TYPE="payOut",d.prototype.getValues=function(){return this.values},d.prototype.setValueAt=function(a,b){this.values[a]=b},d.prototype.unserialize=function(a){for(var b=0;b<a.values.length;b++)this.values[b]=a.values[b]},d.prototype.serialize=function(){return{values:this.values}},b.exports=d},{}],64:[function(a,b,c){function d(a){this.animate=!1,this.cards=[],this.firstIndex=0,this.seatIndex=a}var e=a("../data/CardData");d.TYPE="pocketCards",d.prototype.setAnimate=function(a){this.animate=a},d.prototype.setFirstIndex=function(a){this.firstIndex=a},d.prototype.getCards=function(){return this.cards},d.prototype.addCard=function(a){this.cards.push(a)},d.prototype.getFirstIndex=function(){return this.firstIndex},d.prototype.getSeatIndex=function(){return this.seatIndex},d.prototype.unserialize=function(a){var b;for(this.animate=a.animate,this.firstIndex=parseInt(a.firstIndex),this.cards=[],this.seatIndex=a.seatIndex,b=0;b<a.cards.length;b++)this.cards.push(new e(a.cards[b]))},d.prototype.serialize=function(){var a=[];for(i=0;i<this.cards.length;i++)a.push(this.cards[i].getValue());return{animate:this.animate,firstIndex:this.firstIndex,cards:a,seatIndex:this.seatIndex}},b.exports=d},{"../data/CardData":46}],65:[function(a,b,c){function d(a){this.values=null==a?new Array:a}d.TYPE="pot",d.prototype.getValues=function(){return this.values},d.prototype.unserialize=function(a){this.values=a.values},d.prototype.serialize=function(){return{values:this.values}},b.exports=d},{}],66:[function(a,b,c){function d(a,b){this.text=a,this.countdown=b}d.TYPE="preTournamentInfo",d.prototype.getText=function(){return this.text},d.prototype.getCountdown=function(){return this.countdown},d.prototype.unserialize=function(a){this.text=a.text,this.countdown=a.countdown},d.prototype.serialize=function(){return this.countdown<0&&(this.countdown=0),{text:this.text,countdown:this.countdown}},b.exports=d},{}],67:[function(a,b,c){function d(a,b){b||(b=null),this.button=a,this.value=b}d.TYPE="presetButtonClick",d.prototype.getButton=function(){return this.button},d.prototype.getValue=function(){return this.value},d.prototype.unserialize=function(a){this.button=a.button,this.value=a.value},d.prototype.serialize=function(){return{button:this.button,value:this.value}},b.exports=d},{}],68:[function(a,b,c){function d(){this.buttons=new Array(7),this.current=null}var e=a("../data/ButtonData");d.TYPE="presetButtons",d.prototype.getButtons=function(){return this.buttons},d.prototype.getCurrent=function(){return this.current},d.prototype.setButtonDataAt=function(a,b){this.buttons[a]=b},d.prototype.unserialize=function(a){this.current=a.current,this.buttons=new Array;for(var b=0;b<a.buttons.length;b++){var c=a.buttons[b],d=null;null!=c&&(d=new e(c.button,c.value)),this.buttons.push(d)}},d.prototype.serialize=function(){for(var a={buttons:[],current:this.current},b=0;b<this.buttons.length;b++){var c=this.buttons[b];null!=c?a.buttons.push({button:c.button,value:c.value}):a.buttons.push(null)}return a},b.exports=d},{"../data/ButtonData":45}],69:[function(a,b,c){function d(a){this.seatIndex=a}d.TYPE="seatClick",d.prototype.getSeatIndex=function(){return this.seatIndex},d.prototype.unserialize=function(a){this.seatIndex=a.seatIndex},d.prototype.serialize=function(){return{seatIndex:this.seatIndex}},b.exports=d},{}],70:[function(a,b,c){function d(a){this.seatIndex=a,this.active=!0,this.sitout=!1,this.name="",this.chips=""}d.TYPE="seatInfo",d.prototype.getSeatIndex=function(){return this.seatIndex},d.prototype.getName=function(){return this.name},d.prototype.getChips=function(){return this.chips},d.prototype.isSitout=function(){return this.sitout},d.prototype.isActive=function(){return this.active},d.prototype.setActive=function(a){this.active=a},d.prototype.setSitout=function(a){this.sitout=a},d.prototype.setName=function(a){this.name=a},d.prototype.setChips=function(a){this.chips=a},d.prototype.unserialize=function(a){this.seatIndex=a.seatIndex,this.name=a.name,this.chips=a.chips,this.sitout=a.sitout,this.active=a.active},d.prototype.serialize=function(){return{seatIndex:this.seatIndex,name:this.name,chips:this.chips,sitout:this.sitout,active:this.active}},b.exports=d},{}],71:[function(a,b,c){function d(){this.text="",this.buttons=[],this.defaultValue=null}d.TYPE="showDialog",d.prototype.addButton=function(a){this.buttons.push(a)},d.prototype.getText=function(){return this.text},d.prototype.getButtons=function(){return this.buttons},d.prototype.getDefaultValue=function(){return this.defaultValue},d.prototype.setDefaultValue=function(a){this.defaultValue=a},d.prototype.setText=function(a){this.text=a},d.prototype.unserialize=function(a){this.text=a.text,this.buttons=a.buttons,this.defaultValue=a.defaultValue},d.prototype.serialize=function(){return{text:this.text,buttons:this.buttons,defaultValue:this.defaultValue}},b.exports=d},{}],72:[function(a,b,c){function d(){}d.TYPE="stateComplete",d.prototype.unserialize=function(a){},d.prototype.serialize=function(){return{}},b.exports=d},{}],73:[function(a,b,c){function d(a){this.tableIndex=a}d.TYPE="tableButtonClick",d.prototype.getTableIndex=function(){return this.tableIndex},d.prototype.unserialize=function(a){this.tableIndex=a.tableIndex},d.prototype.serialize=function(){return{tableIndex:this.tableIndex}},b.exports=d},{}],74:[function(a,b,c){function d(){this.enabled=new Array,this.currentIndex=-1,this.playerIndex=-1,this.infoLink=""}d.TYPE="tableButtons",d.prototype.getEnabled=function(){return this.enabled},d.prototype.getCurrentIndex=function(){return this.currentIndex},d.prototype.getPlayerIndex=function(){return this.playerIndex},d.prototype.getInfoLink=function(){return this.infoLink},d.prototype.unserialize=function(a){this.playerIndex=a.playerIndex,this.currentIndex=a.currentIndex,this.infoLink=a.infoLink,this.enabled=new Array;for(var b=0;b<a.enabled.length;b++)this.enabled.push(a.enabled[b])},d.prototype.serialize=function(){for(var a={currentIndex:this.currentIndex,playerIndex:this.playerIndex,enabled:[],infoLink:this.infoLink},b=0;b<this.enabled.length;b++)a.enabled.push(this.enabled[b]);return a},b.exports=d},{}],75:[function(a,b,c){function d(a,b){this.countdown=b,this.text=a,this.showJoinButton=!1,this.showLeaveButton=!1,this.infoLink=null,this.infoLinkText=null}d.TYPE="tableInfo",d.prototype.getCountdown=function(){return this.countdown},d.prototype.getText=function(){return this.text},d.prototype.getShowJoinButton=function(){return this.showJoinButton},d.prototype.getShowLeaveButton=function(){return this.showLeaveButton},d.prototype.setShowJoinButton=function(a){this.showJoinButton=a},d.prototype.setShowLeaveButton=function(a){this.showLeaveButton=a},d.prototype.getInfoLink=function(){return this.infoLink},d.prototype.getInfoLinkText=function(){return this.infoLinkText},d.prototype.unserialize=function(a){null!=a.text&&(this.text=a.text),null!=a.countdown&&(this.countdown=a.countdown),null!=a.showJoinButton&&(this.showJoinButton=a.showJoinButton),null!=a.showLeaveButton&&(this.showLeaveButton=a.showLeaveButton),null!=a.infoLink&&(this.infoLink=a.infoLink),null!=a.infoLinkText&&(this.infoLinkText=a.infoLinkText)},d.prototype.serialize=function(){return{text:this.text,countdown:this.countdown,showJoinButton:this.showJoinButton,showLeaveButton:this.showLeaveButton,infoLink:this.infoLink,infoLinkText:this.infoLinkText}},b.exports=d},{}],76:[function(a,b,c){function d(a){this.testCase=a}d.TYPE="testCaseRequest",d.prototype.getTestCase=function(){return this.testCase},d.prototype.unserialize=function(a){this.testCase=a.testCase},d.prototype.serialize=function(){return{testCase:this.testCase}},b.exports=d},{}],77:[function(a,b,c){function d(){this.seatIndex=-1,this.totalTime=-1,this.timeLeft=-1}d.TYPE="timer",d.prototype.getSeatIndex=function(){return this.seatIndex},d.prototype.getTotalTime=function(){return this.totalTime},d.prototype.getTimeLeft=function(){return this.timeLeft},d.prototype.setSeatIndex=function(a){this.seatIndex=a},d.prototype.setTotalTime=function(a){this.totalTime=a},d.prototype.setTimeLeft=function(a){this.timeLeft=a},d.prototype.unserialize=function(a){this.seatIndex=a.seatIndex,this.totalTime=a.totalTime,this.timeLeft=a.timeLeft},d.prototype.serialize=function(){return{seatIndex:this.seatIndex,totalTime:this.totalTime,timeLeft:this.timeLeft}},b.exports=d},{}],78:[function(a,b,c){function d(a,b){this.text=a,this.rightColumnText=b}d.TYPE="tournamentResult",d.prototype.getText=function(){return this.text},d.prototype.getRightColumnText=function(){return this.rightColumnText},d.prototype.unserialize=function(a){this.text=a.text,this.rightColumnText=a.rightColumnText},d.prototype.serialize=function(){return{text:this.text,rightColumnText:this.rightColumnText}},b.exports=d},{}],79:[function(a,b,c){function d(a){e.DisplayObjectContainer.call(this),a&&this.addChild(a),this.interactive=!0,this.buttonMode=!0,this.mouseover=this.onMouseover.bind(this),this.mouseout=this.touchend=this.touchendoutside=this.onMouseout.bind(this),this.mousedown=this.touchstart=this.onMousedown.bind(this),this.mouseup=this.onMouseup.bind(this),this.click=this.tap=this.onClick.bind(this),this.colorMatrixFilter=new e.ColorMatrixFilter,this.colorMatrixFilter.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.filters=[this.colorMatrixFilter]}var e=a("pixi.js"),f=a("yaed"),g=a("inherits");g(d,e.DisplayObjectContainer),f.init(d),d.LIGHT_MATRIX=[1.5,0,0,0,0,1.5,0,0,0,0,1.5,0,0,0,0,1],d.DARK_MATRIX=[.75,0,0,0,0,.75,0,0,0,0,.75,0,0,0,0,1],d.DEFAULT_MATRIX=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],d.CLICK="click",d.prototype.onMouseover=function(){this.colorMatrixFilter.matrix=d.LIGHT_MATRIX},d.prototype.onMouseout=function(){this.colorMatrixFilter.matrix=d.DEFAULT_MATRIX},d.prototype.onMousedown=function(){this.colorMatrixFilter.matrix=d.DARK_MATRIX},d.prototype.onMouseup=function(){this.colorMatrixFilter.matrix=d.LIGHT_MATRIX},d.prototype.onClick=function(){this.trigger(d.CLICK)},b.exports=d},{inherits:7,"pixi.js":8,yaed:14}],80:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.button=new g(a),this.addChild(this.button),this.check=b,this.addChild(this.check),this.button.addEventListener("click",this.onButtonClick,this),this.setChecked(!1)}var e=a("pixi.js"),f=a("yaed"),g=a("./Button"),h=a("inherits");h(d,e.DisplayObjectContainer),f.init(d),d.prototype.onButtonClick=function(){this.check.visible=!this.check.visible,this.dispatchEvent("change")},d.prototype.setChecked=function(a){return this.check.visible=a,a},d.prototype.getChecked=function(){return this.check.visible},b.exports=d},{"./Button":79,inherits:7,"pixi.js":8,yaed:14}],81:[function(a,b,c){function d(){this.width=100,this.height=100,this.stops=[]}var e=a("pixi.js");d.prototype.setSize=function(a,b){this.width=a,this.height=b},d.prototype.addColorStop=function(a,b){this.stops.push({weight:a,color:b})},d.prototype.createSprite=function(){var a=document.createElement("canvas");a.width=this.width,a.height=this.height;var b,c=a.getContext("2d"),d=c.createLinearGradient(0,0,0,this.height);for(b=0;b<this.stops.length;b++)d.addColorStop(this.stops[b].weight,this.stops[b].color);return c.fillStyle=d,c.fillRect(0,0,this.width,this.height),new e.Sprite(e.Texture.fromCanvas(a))},b.exports=d},{"pixi.js":8}],82:[function(a,b,c){function d(a){this.url=a,this.thenable=null,this.resultType=null}var e=a("tinp");d.prototype.setResultType=function(a){this.resultType=a},d.prototype.setUrl=function(a){this.url=a},d.prototype.send=function(a){if(this.thenable)throw new Error("Request already sent");return a&&(this.url=a),this.thenable=new e,this.request=new XMLHttpRequest,this.request.open("GET",this.url,!0),this.request.onload=this.onRequestLoad.bind(this),this.request.onerror=this.onRequestError.bind(this),this.request.send(),this.thenable},d.prototype.onRequestLoad=function(){if(200!=this.request.status)return this.thenable.reject(this.request.status),void(this.thenable=null);var a=this.request.responseText;switch(this.resultType){case"json":try{a=JSON.parse(this.request.responseText)}catch(b){return void this.thenable.reject("JSON.parse: "+b)}}this.thenable.resolve(a)},d.prototype.onRequestError=function(a){this.request=null,this.thenable.reject(a)},b.exports=d},{tinp:12}],83:[function(a,b,c){function d(){f.call(this),this.test=1}var e=(a("tinp"),a("inherits")),f=a("yaed"),g=a("../utils/HttpRequest");e(d,f),d.CONNECT="connect",d.MESSAGE="message",d.CLOSE="close",d.prototype.connect=function(a){var b=new g(a);b.send().then(this.onRequestComplete.bind(this),this.onRequestError.bind(this))},d.prototype.onRequestComplete=function(a){this.trigger(d.CONNECT);for(var b=a.toString().split("\n"),c=0;c<b.length;c++){var e=b[c];e.length&&"/"!=e[0]&&(console.log("trigger message: "+e),this.trigger({type:d.MESSAGE,message:JSON.parse(e)}))}},d.prototype.onRequestError=function(a){console.log("error in request connection"),console.log(a),this.trigger(d.CLOSE)},d.prototype.send=function(a){console.log('ignoring "send" for MessageRequestConnection')},b.exports=d},{"../utils/HttpRequest":82,inherits:7,tinp:12,yaed:14}],84:[function(a,b,c){function d(){e.call(this),this.test=1}var e=a("yaed"),f=(a("tinp"),a("inherits"));f(d,e),d.CONNECT="connect",d.MESSAGE="message",d.CLOSE="close",d.prototype.connect=function(a){this.webSocket=new WebSocket(a),this.webSocket.onopen=this.onWebSocketOpen.bind(this),this.webSocket.onmessage=this.onWebSocketMessage.bind(this),this.webSocket.onclose=this.onWebSocketClose.bind(this),this.webSocket.onerror=this.onWebSocketError.bind(this)},d.prototype.send=function(a){this.webSocket.send(JSON.stringify(a))},d.prototype.onWebSocketOpen=function(){this.trigger(d.CONNECT)},d.prototype.onWebSocketMessage=function(a){var b=JSON.parse(a.data);this.trigger({type:d.MESSAGE,message:b})},d.prototype.onWebSocketClose=function(){console.log("web socket close, ws="+this.webSocket+" this="+this.test),this.webSocket.close(),this.clearWebSocket(),this.trigger(d.CLOSE)},d.prototype.onWebSocketError=function(){console.log("web socket error, ws="+this.webSocket+" this="+this.test),this.webSocket.close(),this.clearWebSocket(),this.trigger(d.CLOSE)},d.prototype.clearWebSocket=function(){this.webSocket.onopen=null,this.webSocket.onmessage=null,this.webSocket.onclose=null,this.webSocket.onerror=null,this.webSocket=null},b.exports=d},{inherits:7,tinp:12,yaed:14}],85:[function(a,b,c){function d(){this.objects=new Array,this.currentlyOver=!1,this.mouseDown=!1}var e=a("pixi.js"),f=a("yaed"),g=a("inherits");g(d,e.DisplayObjectContainer),f.init(d),d.prototype.addDisplayObject=function(a){a.interactive=!0,a.mouseoverEnabled=!0,a.mouseover=this.onObjectMouseOver.bind(this),a.mouseout=this.onObjectMouseOut.bind(this),a.mousedown=this.onObjectMouseDown.bind(this),this.objects.push(a)},d.prototype.onObjectMouseOver=function(a){this.currentlyOver||(this.currentlyOver=!0,this.dispatchEvent("mouseover"))},d.prototype.onObjectMouseOut=function(a){if(this.currentlyOver&&!this.mouseDown){for(var b=0;b<this.objects.length;b++)if(this.hitTest(this.objects[b],a))return;this.currentlyOver=!1,this.dispatchEvent("mouseout")}},d.prototype.hitTest=function(a,b){return b.global.x>a.getBounds().x&&b.global.x<a.getBounds().x+a.getBounds().width&&b.global.y>a.getBounds().y&&b.global.y<a.getBounds().y+a.getBounds().height?!0:!1},d.prototype.onObjectMouseDown=function(a){this.mouseDown=!0,a.target.mouseup=a.target.mouseupoutside=this.onStageMouseUp.bind(this)},d.prototype.onStageMouseUp=function(a){if(a.target.mouseup=a.target.mouseupoutside=null,this.mouseDown=!1,this.currentlyOver){for(var b=!1,c=0;c<this.objects.length;c++)this.hitTest(this.objects[c],a)&&(b=!0);b||(this.currentlyOver=!1,this.dispatchEvent("mouseout"))}},b.exports=d},{inherits:7,"pixi.js":8,yaed:14}],86:[function(a,b,c){function d(a,b,c,d,f){e.DisplayObjectContainer.call(this),this.texture=a,c||(c=b),d||(d=b),f||(f=c),this.left=b,this.top=c,this.right=d,this.bottom=f,this.localWidth=a.width,this.localHeight=a.height,this.buildParts(),this.updateSizes()}var e=a("pixi.js"),f=a("inherits");f(d,e.DisplayObjectContainer),d.prototype.buildParts=function(){var a,b,c=[0,this.left,this.texture.width-this.right,this.texture.width],d=[0,this.top,this.texture.height-this.bottom,this.texture.height];for(this.parts=[],b=0;3>b;b++)for(a=0;3>a;a++){var f=c[a+1]-c[a],g=d[b+1]-d[b];if(0!=f&&0!=g){var h=this.createTexturePart(c[a],d[b],f,g),i=new e.Sprite(h);this.addChild(i),this.parts.push(i)}else this.parts.push(null)}},d.prototype.updateSizes=function(){var a,b,c=[0,this.left,this.localWidth-this.right,this.localWidth],d=[0,this.top,this.localHeight-this.bottom,this.localHeight],e=0;for(b=0;3>b;b++)for(a=0;3>a;a++){if(this.parts[e]){var f=this.parts[e];f.position.x=c[a],f.position.y=d[b],f.width=c[a+1]-c[a],f.height=d[b+1]-d[b]}e++}},d.prototype.setLocalSize=function(a,b){this.localWidth=a,this.localHeight=b,this.updateSizes()},d.prototype.createTexturePart=function(a,b,c,d){var f={x:this.texture.frame.x+a,y:this.texture.frame.y+b,width:c,height:d};return new e.Texture(this.texture,f)},b.exports=d},{inherits:7,"pixi.js":8}],87:[function(a,b,c){function d(a,b){return this instanceof d?(this.x=a,void(this.y=b)):new d(a,b)}b.exports=d},{}],88:[function(a,b,c){function d(){e.call(this),this.queue=[],this.currentTask=null,this.onTaskCompleteClosure=this.onTaskComplete.bind(this)}var e=a("yaed"),f=a("inherits");f(d,e),d.START="start",d.COMPLETE="complete",d.prototype.enqueue=function(a){this.currentTask?this.queue.push(a):this.startTask(a)},d.prototype.startTask=function(a){this.currentTask=a,this.currentTask.addEventListener(d.COMPLETE,this.onTaskCompleteClosure),this.currentTask.dispatchEvent({type:d.START})},d.prototype.onTaskComplete=function(){this.currentTask.removeEventListener(d.COMPLETE,this.onTaskCompleteClosure),this.currentTask=null,this.queue.length>0?this.startTask(this.queue.shift()):this.trigger(d.COMPLETE)},d.prototype.abort=function(){this.currentTask&&(this.currentTask.removeEventListener(d.COMPLETE,this.onTaskCompleteClosure),this.currentTask=null),this.queue=[]},b.exports=d},{inherits:7,yaed:14}],89:[function(a,b,c){function d(a,b){e.DisplayObjectContainer.call(this),this.background=a,this.knob=b,this.addChild(this.background),this.addChild(this.knob),this.knob.buttonMode=!0,this.knob.interactive=!0,this.knob.mousedown=this.onKnobMouseDown.bind(this),this.background.buttonMode=!0,this.background.interactive=!0,this.background.mousedown=this.onBackgroundMouseDown.bind(this),this.fadeTween=null,this.alpha=0}var e=a("pixi.js"),f=a("tween.js"),g=a("yaed"),h=a("inherits");h(d,e.DisplayObjectContainer),g.init(d),d.prototype.onKnobMouseDown=function(a){this.downPos=this.knob.position.x,this.downX=a.getLocalPosition(this).x,this.stage.mouseup=this.onStageMouseUp.bind(this),this.stage.mousemove=this.onStageMouseMove.bind(this)},d.prototype.onBackgroundMouseDown=function(a){this.downX=a.getLocalPosition(this).x,this.knob.x=a.getLocalPosition(this).x-.5*this.knob.width,this.validateValue(),this.downPos=this.knob.position.x,this.stage.mouseup=this.onStageMouseUp.bind(this),this.stage.mousemove=this.onStageMouseMove.bind(this),this.dispatchEvent("change")},d.prototype.onStageMouseUp=function(a){this.stage.mouseup=null,this.stage.mousemove=null},d.prototype.onStageMouseMove=function(a){this.knob.x=this.downPos+(a.getLocalPosition(this).x-this.downX),this.validateValue(),this.dispatchEvent("change")},d.prototype.validateValue=function(){this.knob.x<0&&(this.knob.x=0),this.knob.x>this.background.width-this.knob.width&&(this.knob.x=this.background.width-this.knob.width)},d.prototype.getValue=function(){var a=this.knob.position.x/(this.background.width-this.knob.width);return a},d.prototype.setValue=function(a){return this.knob.x=this.background.position.x+a*(this.background.width-this.knob.width),this.validateValue(),this.getValue()},d.prototype.show=function(){this.visible=!0,null!=this.fadeTween&&this.fadeTween.stop(),this.fadeTween=new f.Tween(this).to({alpha:1},250).start()},d.prototype.hide=function(){null!=this.fadeTween&&this.fadeTween.stop(),this.fadeTween=new f.Tween(this).to({alpha:0},250).onComplete(this.onHidden.bind(this)).start()},d.prototype.onHidden=function(){this.visible=!1},b.exports=d},{inherits:7,"pixi.js":8,"tween.js":13,yaed:14}],90:[function(a,b,c){function d(){throw new Error("static")}var e=a("url");d.makeAbsolute=function(a){var b=e.parse(a);if(b.protocol)return a;if("/"==a.charAt(0)){var c=e.parse(window.location.href);return c.pathname=a,e.format(c)}var d;return d=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1),d+a},b.exports=d},{url:6}]},{},[15])(15)});